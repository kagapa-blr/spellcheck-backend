import{r as he}from"./underscore-b--1-EUR.js";import{c as qe,d as Ia,l as Aa}from"./@xmldom-DBEIMRBk.js";import{b as Na}from"./base64-js-D0UyVEDn.js";import{j as qa}from"./jszip-BmYNtbIh.js";import{l as Ba}from"./xmlbuilder-MWHHUJUD.js";import{d as Ma}from"./dingbat-to-unicode-Cm9PDbSb.js";import{l as Nn}from"./lop-DvYkyT-y.js";var Fe={},lr={},de={},qn={exports:{}},tt={exports:{}},Fr;function Ue(){if(Fr)return tt.exports;Fr=1;var e=function(){return this===void 0}();if(e)tt.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:e,propertyIsWritable:function(i,s){var y=Object.getOwnPropertyDescriptor(i,s);return!!(!y||y.writable||y.set)}};else{var t={}.hasOwnProperty,r={}.toString,n={}.constructor.prototype,o=function(i){var s=[];for(var y in i)t.call(i,y)&&s.push(y);return s},p=function(i,s){return{value:i[s]}},f=function(i,s,y){return i[s]=y.value,i},u=function(i){return i},a=function(i){try{return Object(i).constructor.prototype}catch{return n}},l=function(i){try{return r.call(i)==="[object Array]"}catch{return!1}};tt.exports={isArray:l,keys:o,names:o,defineProperty:f,getDescriptor:p,freeze:u,getPrototypeOf:a,isES5:e,propertyIsWritable:function(){return!0}}}return tt.exports}var kt,xr;function oe(){if(xr)return kt;xr=1;var e={},t=Ue(),r=typeof navigator>"u",n={e:{}},o,p=typeof self<"u"?self:typeof window<"u"?window:typeof qe<"u"?qe:qe!==void 0?qe:null;function f(){try{var _=o;return o=null,_.apply(this,arguments)}catch($){return n.e=$,n}}function u(_){return o=_,f}var a=function(_,$){var K={}.hasOwnProperty;function V(){this.constructor=_,this.constructor$=$;for(var U in $.prototype)K.call($.prototype,U)&&U.charAt(U.length-1)!=="$"&&(this[U+"$"]=$.prototype[U])}return V.prototype=$.prototype,_.prototype=new V,_.prototype};function l(_){return _==null||_===!0||_===!1||typeof _=="string"||typeof _=="number"}function i(_){return typeof _=="function"||typeof _=="object"&&_!==null}function s(_){return l(_)?new Error(W(_)):_}function y(_,$){var K=_.length,V=new Array(K+1),U;for(U=0;U<K;++U)V[U]=_[U];return V[U]=$,V}function g(_,$,K){if(t.isES5){var V=Object.getOwnPropertyDescriptor(_,$);if(V!=null)return V.get==null&&V.set==null?V.value:K}else return{}.hasOwnProperty.call(_,$)?_[$]:void 0}function c(_,$,K){if(l(_))return _;var V={value:K,configurable:!0,enumerable:!1,writable:!0};return t.defineProperty(_,$,V),_}function v(_){throw _}var m=function(){var _=[Array.prototype,Object.prototype,Function.prototype],$=function(U){for(var ne=0;ne<_.length;++ne)if(_[ne]===U)return!0;return!1};if(t.isES5){var K=Object.getOwnPropertyNames;return function(U){for(var ne=[],ye=Object.create(null);U!=null&&!$(U);){var T;try{T=K(U)}catch{return ne}for(var I=0;I<T.length;++I){var P=T[I];if(!ye[P]){ye[P]=!0;var Z=Object.getOwnPropertyDescriptor(U,P);Z!=null&&Z.get==null&&Z.set==null&&ne.push(P)}}U=t.getPrototypeOf(U)}return ne}}else{var V={}.hasOwnProperty;return function(U){if($(U))return[];var ne=[];e:for(var ye in U)if(V.call(U,ye))ne.push(ye);else{for(var T=0;T<_.length;++T)if(V.call(_[T],ye))continue e;ne.push(ye)}return ne}}}(),E=/this\s*\.\s*\S+\s*=/;function x(_){try{if(typeof _=="function"){var $=t.names(_.prototype),K=t.isES5&&$.length>1,V=$.length>0&&!($.length===1&&$[0]==="constructor"),U=E.test(_+"")&&t.names(_).length>0;if(K||V||U)return!0}return!1}catch{return!1}}function F(_){return _}var H=/^[a-z$_][a-z$_0-9]*$/i;function M(_){return H.test(_)}function L(_,$,K){for(var V=new Array(_),U=0;U<_;++U)V[U]=$+U+K;return V}function W(_){try{return _+""}catch{return"[no string representation]"}}function X(_){return _!==null&&typeof _=="object"&&typeof _.message=="string"&&typeof _.name=="string"}function G(_){try{c(_,"isOperational",!0)}catch{}}function te(_){return _==null?!1:_ instanceof Error.__BluebirdErrorTypes__.OperationalError||_.isOperational===!0}function se(_){return X(_)&&t.propertyIsWritable(_,"stack")}var k=function(){return"stack"in new Error?function(_){return se(_)?_:new Error(W(_))}:function(_){if(se(_))return _;try{throw new Error(W(_))}catch($){return $}}}();function N(_){return{}.toString.call(_)}function q(_,$,K){for(var V=t.names(_),U=0;U<V.length;++U){var ne=V[U];if(K(ne))try{t.defineProperty($,ne,t.getDescriptor(_,ne))}catch{}}}var Q=function(_){return t.isArray(_)?_:null};if(typeof Symbol<"u"&&Symbol.iterator){var h=typeof Array.from=="function"?function(_){return Array.from(_)}:function(_){for(var $=[],K=_[Symbol.iterator](),V;!(V=K.next()).done;)$.push(V.value);return $};Q=function(_){return t.isArray(_)?_:_!=null&&typeof _[Symbol.iterator]=="function"?h(_):null}}var R=typeof process<"u"&&N(process).toLowerCase()==="[object process]",d=typeof process<"u"&&typeof e<"u";function w(_){return d?e[_]:void 0}function S(){if(typeof Promise=="function")try{var _=new Promise(function(){});if({}.toString.call(_)==="[object Promise]")return Promise}catch{}}function O(_,$){return _.bind($)}var D={isClass:x,isIdentifier:M,inheritedDataKeys:m,getDataPropertyOrDefault:g,thrower:v,isArray:t.isArray,asArray:Q,notEnumerableProp:c,isPrimitive:l,isObject:i,isError:X,canEvaluate:r,errorObj:n,tryCatch:u,inherits:a,withAppended:y,maybeWrapAsError:s,toFastProperties:F,filledRange:L,toString:W,canAttachTrace:se,ensureErrorObject:k,originatesFromRejection:te,markAsOriginatingFromRejection:G,classString:N,copyDescriptors:q,hasDevTools:typeof chrome<"u"&&chrome&&typeof chrome.loadTimes=="function",isNode:R,hasEnvVariables:d,env:w,global:p,getNativePromise:S,domainBind:O};D.isRecentNode=D.isNode&&function(){var _=process.versions.node.split(".").map(Number);return _[0]===0&&_[1]>10||_[0]>0}(),D.isNode&&D.toFastProperties(process);try{throw new Error}catch(_){D.lastLineError=_}return kt=D,kt}var rt={exports:{}},Rt,Or;function Da(){if(Or)return Rt;Or=1;var e=oe(),t,r=function(){throw new Error(`No async scheduler available

    See http://goo.gl/MqrFmX
`)},n=e.getNativePromise();if(e.isNode&&typeof MutationObserver>"u"){var o=qe.setImmediate,p=process.nextTick;t=e.isRecentNode?function(u){o.call(qe,u)}:function(u){p.call(process,u)}}else if(typeof n=="function"&&typeof n.resolve=="function"){var f=n.resolve();t=function(u){f.then(u)}}else typeof MutationObserver<"u"&&!(typeof window<"u"&&window.navigator&&(window.navigator.standalone||window.cordova))?t=function(){var u=document.createElement("div"),a={attributes:!0},l=!1,i=document.createElement("div"),s=new MutationObserver(function(){u.classList.toggle("foo"),l=!1});s.observe(i,a);var y=function(){l||(l=!0,i.classList.toggle("foo"))};return function(c){var v=new MutationObserver(function(){v.disconnect(),c()});v.observe(u,a),y()}}():typeof setImmediate<"u"?t=function(u){setImmediate(u)}:typeof setTimeout<"u"?t=function(u){setTimeout(u,0)}:t=r;return Rt=t,Rt}var St,jr;function Ha(){if(jr)return St;jr=1;function e(r,n,o,p,f){for(var u=0;u<f;++u)o[u+p]=r[u+n],r[u+n]=void 0}function t(r){this._capacity=r,this._length=0,this._front=0}return t.prototype._willBeOverCapacity=function(r){return this._capacity<r},t.prototype._pushOne=function(r){var n=this.length();this._checkCapacity(n+1);var o=this._front+n&this._capacity-1;this[o]=r,this._length=n+1},t.prototype.push=function(r,n,o){var p=this.length()+3;if(this._willBeOverCapacity(p)){this._pushOne(r),this._pushOne(n),this._pushOne(o);return}var f=this._front+p-3;this._checkCapacity(p);var u=this._capacity-1;this[f+0&u]=r,this[f+1&u]=n,this[f+2&u]=o,this._length=p},t.prototype.shift=function(){var r=this._front,n=this[r];return this[r]=void 0,this._front=r+1&this._capacity-1,this._length--,n},t.prototype.length=function(){return this._length},t.prototype._checkCapacity=function(r){this._capacity<r&&this._resizeTo(this._capacity<<1)},t.prototype._resizeTo=function(r){var n=this._capacity;this._capacity=r;var o=this._front,p=this._length,f=o+p&n-1;e(this,0,this,n,f)},St=t,St}var Ir;function $a(){if(Ir)return rt.exports;Ir=1;var e;try{throw new Error}catch(a){e=a}var t=Da(),r=Ha(),n=oe();function o(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new r(16),this._normalQueue=new r(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var a=this;this.drainQueues=function(){a._drainQueues()},this._schedule=t}o.prototype.setScheduler=function(a){var l=this._schedule;return this._schedule=a,this._customScheduler=!0,l},o.prototype.hasCustomScheduler=function(){return this._customScheduler},o.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},o.prototype.disableTrampolineIfNecessary=function(){n.hasDevTools&&(this._trampolineEnabled=!1)},o.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},o.prototype.fatalError=function(a,l){l?(process.stderr.write("Fatal "+(a instanceof Error?a.stack:a)+`
`),process.exit(2)):this.throwLater(a)},o.prototype.throwLater=function(a,l){if(arguments.length===1&&(l=a,a=function(){throw l}),typeof setTimeout<"u")setTimeout(function(){a(l)},0);else try{this._schedule(function(){a(l)})}catch{throw new Error(`No async scheduler available

    See http://goo.gl/MqrFmX
`)}};function p(a,l,i){this._lateQueue.push(a,l,i),this._queueTick()}function f(a,l,i){this._normalQueue.push(a,l,i),this._queueTick()}function u(a){this._normalQueue._pushOne(a),this._queueTick()}return n.hasDevTools?(o.prototype.invokeLater=function(a,l,i){this._trampolineEnabled?p.call(this,a,l,i):this._schedule(function(){setTimeout(function(){a.call(l,i)},100)})},o.prototype.invoke=function(a,l,i){this._trampolineEnabled?f.call(this,a,l,i):this._schedule(function(){a.call(l,i)})},o.prototype.settlePromises=function(a){this._trampolineEnabled?u.call(this,a):this._schedule(function(){a._settlePromises()})}):(o.prototype.invokeLater=p,o.prototype.invoke=f,o.prototype.settlePromises=u),o.prototype._drainQueue=function(a){for(;a.length()>0;){var l=a.shift();if(typeof l!="function"){l._settlePromises();continue}var i=a.shift(),s=a.shift();l.call(i,s)}},o.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},o.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},o.prototype._reset=function(){this._isTickUsed=!1},rt.exports=o,rt.exports.firstLineError=e,rt.exports}var Ft,Ar;function Be(){if(Ar)return Ft;Ar=1;var e=Ue(),t=e.freeze,r=oe(),n=r.inherits,o=r.notEnumerableProp;function p(E,x){function F(H){if(!(this instanceof F))return new F(H);o(this,"message",typeof H=="string"?H:x),o(this,"name",E),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return n(F,Error),F}var f,u,a=p("Warning","warning"),l=p("CancellationError","cancellation error"),i=p("TimeoutError","timeout error"),s=p("AggregateError","aggregate error");try{f=TypeError,u=RangeError}catch{f=p("TypeError","type error"),u=p("RangeError","range error")}for(var y="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),g=0;g<y.length;++g)typeof Array.prototype[y[g]]=="function"&&(s.prototype[y[g]]=Array.prototype[y[g]]);e.defineProperty(s.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),s.prototype.isOperational=!0;var c=0;s.prototype.toString=function(){var E=Array(c*4+1).join(" "),x=`
`+E+`AggregateError of:
`;c++,E=Array(c*4+1).join(" ");for(var F=0;F<this.length;++F){for(var H=this[F]===this?"[Circular AggregateError]":this[F]+"",M=H.split(`
`),L=0;L<M.length;++L)M[L]=E+M[L];H=M.join(`
`),x+=H+`
`}return c--,x};function v(E){if(!(this instanceof v))return new v(E);o(this,"name","OperationalError"),o(this,"message",E),this.cause=E,this.isOperational=!0,E instanceof Error?(o(this,"message",E.message),o(this,"stack",E.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}n(v,Error);var m=Error.__BluebirdErrorTypes__;return m||(m=t({CancellationError:l,TimeoutError:i,OperationalError:v,RejectionError:v,AggregateError:s}),e.defineProperty(Error,"__BluebirdErrorTypes__",{value:m,writable:!1,enumerable:!1,configurable:!1})),Ft={Error,TypeError:f,RangeError:u,CancellationError:m.CancellationError,OperationalError:m.OperationalError,TimeoutError:m.TimeoutError,AggregateError:m.AggregateError,Warning:a},Ft}var xt,Nr;function Pa(){return Nr||(Nr=1,xt=function(e,t){var r=oe(),n=r.errorObj,o=r.isObject;function p(s,y){if(o(s)){if(s instanceof e)return s;var g=u(s);if(g===n){y&&y._pushContext();var c=e.reject(g.e);return y&&y._popContext(),c}else if(typeof g=="function"){if(l(s)){var c=new e(t);return s._then(c._fulfill,c._reject,void 0,c,null),c}return i(s,g,y)}}return s}function f(s){return s.then}function u(s){try{return f(s)}catch(y){return n.e=y,n}}var a={}.hasOwnProperty;function l(s){try{return a.call(s,"_promise0")}catch{return!1}}function i(s,y,g){var c=new e(t),v=c;g&&g._pushContext(),c._captureStackTrace(),g&&g._popContext();var m=!0,E=r.tryCatch(y).call(s,x,F);m=!1,c&&E===n&&(c._rejectCallback(E.e,!0,!0),c=null);function x(H){c&&(c._resolveCallback(H),c=null)}function F(H){c&&(c._rejectCallback(H,m,!0),c=null)}return v}return p}),xt}var Ot,qr;function La(){return qr||(qr=1,Ot=function(e,t,r,n,o){var p=oe();p.isArray;function f(a){switch(a){case-2:return[];case-3:return{}}}function u(a){var l=this._promise=new e(t);a instanceof e&&l._propagateFrom(a,3),l._setOnCancel(this),this._values=a,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return p.inherits(u,o),u.prototype.length=function(){return this._length},u.prototype.promise=function(){return this._promise},u.prototype._init=function a(l,i){var s=r(this._values,this._promise);if(s instanceof e){s=s._target();var y=s._bitField;if(this._values=s,y&50397184)if(y&33554432)s=s._value();else return y&16777216?this._reject(s._reason()):this._cancel();else return this._promise._setAsyncGuaranteed(),s._then(a,this._reject,void 0,this,i)}if(s=p.asArray(s),s===null){var g=n("expecting an array or an iterable object but got "+p.classString(s)).reason();this._promise._rejectCallback(g,!1);return}if(s.length===0){i===-5?this._resolveEmptyArray():this._resolve(f(i));return}this._iterate(s)},u.prototype._iterate=function(a){var l=this.getActualLength(a.length);this._length=l,this._values=this.shouldCopyValues()?new Array(l):this._values;for(var i=this._promise,s=!1,y=null,g=0;g<l;++g){var c=r(a[g],i);c instanceof e?(c=c._target(),y=c._bitField):y=null,s?y!==null&&c.suppressUnhandledRejections():y!==null?y&50397184?y&33554432?s=this._promiseFulfilled(c._value(),g):y&16777216?s=this._promiseRejected(c._reason(),g):s=this._promiseCancelled(g):(c._proxy(this,g),this._values[g]=c):s=this._promiseFulfilled(c,g)}s||i._setAsyncGuaranteed()},u.prototype._isResolved=function(){return this._values===null},u.prototype._resolve=function(a){this._values=null,this._promise._fulfill(a)},u.prototype._cancel=function(){this._isResolved()||!this._promise._isCancellable()||(this._values=null,this._promise._cancel())},u.prototype._reject=function(a){this._values=null,this._promise._rejectCallback(a,!1)},u.prototype._promiseFulfilled=function(a,l){this._values[l]=a;var i=++this._totalResolved;return i>=this._length?(this._resolve(this._values),!0):!1},u.prototype._promiseCancelled=function(){return this._cancel(),!0},u.prototype._promiseRejected=function(a){return this._totalResolved++,this._reject(a),!0},u.prototype._resultCancelled=function(){if(!this._isResolved()){var a=this._values;if(this._cancel(),a instanceof e)a.cancel();else for(var l=0;l<a.length;++l)a[l]instanceof e&&a[l].cancel()}},u.prototype.shouldCopyValues=function(){return!0},u.prototype.getActualLength=function(a){return a},u}),Ot}var jt,Br;function Va(){return Br||(Br=1,jt=function(e){var t=!1,r=[];e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){};function n(){this._trace=new n.CapturedTrace(p())}n.prototype._pushContext=function(){this._trace!==void 0&&(this._trace._promiseCreated=null,r.push(this._trace))},n.prototype._popContext=function(){if(this._trace!==void 0){var f=r.pop(),u=f._promiseCreated;return f._promiseCreated=null,u}return null};function o(){if(t)return new n}function p(){var f=r.length-1;if(f>=0)return r[f]}return n.CapturedTrace=null,n.create=o,n.deactivateLongStackTraces=function(){},n.activateLongStackTraces=function(){var f=e.prototype._pushContext,u=e.prototype._popContext,a=e._peekContext,l=e.prototype._peekContext,i=e.prototype._promiseCreated;n.deactivateLongStackTraces=function(){e.prototype._pushContext=f,e.prototype._popContext=u,e._peekContext=a,e.prototype._peekContext=l,e.prototype._promiseCreated=i,t=!1},t=!0,e.prototype._pushContext=n.prototype._pushContext,e.prototype._popContext=n.prototype._popContext,e._peekContext=e.prototype._peekContext=p,e.prototype._promiseCreated=function(){var s=this._peekContext();s&&s._promiseCreated==null&&(s._promiseCreated=this)}},n}),jt}var It,Mr;function Ua(){return Mr||(Mr=1,It=function(e,t){var r=e._getDomain,n=e._async,o=Be().Warning,p=oe(),f=p.canAttachTrace,u,a,l=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,i=/\((?:timers\.js):\d+:\d+\)/,s=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,y=null,g=null,c=!1,v,m=!!(p.env("BLUEBIRD_DEBUG")!=0&&(p.env("BLUEBIRD_DEBUG")||p.env("NODE_ENV")==="development")),E=!!(p.env("BLUEBIRD_WARNINGS")!=0&&(m||p.env("BLUEBIRD_WARNINGS"))),x=!!(p.env("BLUEBIRD_LONG_STACK_TRACES")!=0&&(m||p.env("BLUEBIRD_LONG_STACK_TRACES"))),F=p.env("BLUEBIRD_W_FORGOTTEN_RETURN")!=0&&(E||!!p.env("BLUEBIRD_W_FORGOTTEN_RETURN"));e.prototype.suppressUnhandledRejections=function(){var b=this._target();b._bitField=b._bitField&-1048577|524288},e.prototype._ensurePossibleRejectionHandled=function(){this._bitField&524288||(this._setRejectionIsUnhandled(),n.invokeLater(this._notifyUnhandledRejection,this,void 0))},e.prototype._notifyUnhandledRejectionIsHandled=function(){P("rejectionHandled",u,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=this._bitField|268435456},e.prototype._returnedNonUndefined=function(){return(this._bitField&268435456)!==0},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var b=this._settledValue();this._setUnhandledRejectionIsNotified(),P("unhandledRejection",a,b,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=this._bitField|262144},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&-262145},e.prototype._isUnhandledRejectionNotified=function(){return(this._bitField&262144)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=this._bitField|1048576},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=this._bitField&-1048577,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(this._bitField&1048576)>0},e.prototype._warn=function(b,C,A){return $(b,C,A||this)},e.onPossiblyUnhandledRejection=function(b){var C=r();a=typeof b=="function"?C===null?b:p.domainBind(C,b):void 0},e.onUnhandledRejectionHandled=function(b){var C=r();u=typeof b=="function"?C===null?b:p.domainBind(C,b):void 0};var H=function(){};e.longStackTraces=function(){if(n.haveItemsQueued()&&!fe.longStackTraces)throw new Error(`cannot enable long stack traces after promises have been created

    See http://goo.gl/MqrFmX
`);if(!fe.longStackTraces&&ae()){var b=e.prototype._captureStackTrace,C=e.prototype._attachExtraTrace;fe.longStackTraces=!0,H=function(){if(n.haveItemsQueued()&&!fe.longStackTraces)throw new Error(`cannot enable long stack traces after promises have been created

    See http://goo.gl/MqrFmX
`);e.prototype._captureStackTrace=b,e.prototype._attachExtraTrace=C,t.deactivateLongStackTraces(),n.enableTrampoline(),fe.longStackTraces=!1},e.prototype._captureStackTrace=S,e.prototype._attachExtraTrace=O,t.activateLongStackTraces(),n.disableTrampolineIfNecessary()}},e.hasLongStackTraces=function(){return fe.longStackTraces&&ae()};var M=function(){try{if(typeof CustomEvent=="function"){var b=new CustomEvent("CustomEvent");return p.global.dispatchEvent(b),function(C,A){var B=new CustomEvent(C.toLowerCase(),{detail:A,cancelable:!0});return!p.global.dispatchEvent(B)}}else if(typeof Event=="function"){var b=new Event("CustomEvent");return p.global.dispatchEvent(b),function(A,B){var z=new Event(A.toLowerCase(),{cancelable:!0});return z.detail=B,!p.global.dispatchEvent(z)}}else{var b=document.createEvent("CustomEvent");return b.initCustomEvent("testingtheevent",!1,!0,{}),p.global.dispatchEvent(b),function(A,B){var z=document.createEvent("CustomEvent");return z.initCustomEvent(A.toLowerCase(),!1,!0,B),!p.global.dispatchEvent(z)}}}catch{}return function(){return!1}}(),L=function(){return p.isNode?function(){return process.emit.apply(process,arguments)}:p.global?function(b){var C="on"+b.toLowerCase(),A=p.global[C];return A?(A.apply(p.global,[].slice.call(arguments,1)),!0):!1}:function(){return!1}}();function W(b,C){return{promise:C}}var X={promiseCreated:W,promiseFulfilled:W,promiseRejected:W,promiseResolved:W,promiseCancelled:W,promiseChained:function(b,C,A){return{promise:C,child:A}},warning:function(b,C){return{warning:C}},unhandledRejection:function(b,C,A){return{reason:C,promise:A}},rejectionHandled:W},G=function(b){var C=!1;try{C=L.apply(null,arguments)}catch(B){n.throwLater(B),C=!0}var A=!1;try{A=M(b,X[b].apply(null,arguments))}catch(B){n.throwLater(B),A=!0}return A||C};e.config=function(b){if(b=Object(b),"longStackTraces"in b&&(b.longStackTraces?e.longStackTraces():!b.longStackTraces&&e.hasLongStackTraces()&&H()),"warnings"in b){var C=b.warnings;fe.warnings=!!C,F=fe.warnings,p.isObject(C)&&"wForgottenReturn"in C&&(F=!!C.wForgottenReturn)}if("cancellation"in b&&b.cancellation&&!fe.cancellation){if(n.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");e.prototype._clearCancellationData=Q,e.prototype._propagateFrom=h,e.prototype._onCancel=N,e.prototype._setOnCancel=q,e.prototype._attachCancellationCallback=k,e.prototype._execute=se,d=h,fe.cancellation=!0}return"monitoring"in b&&(b.monitoring&&!fe.monitoring?(fe.monitoring=!0,e.prototype._fireEvent=G):!b.monitoring&&fe.monitoring&&(fe.monitoring=!1,e.prototype._fireEvent=te)),e};function te(){return!1}e.prototype._fireEvent=te,e.prototype._execute=function(b,C,A){try{b(C,A)}catch(B){return B}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(b){},e.prototype._attachCancellationCallback=function(b){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(b,C){};function se(b,C,A){var B=this;try{b(C,A,function(z){if(typeof z!="function")throw new TypeError("onCancel must be a function, got: "+p.toString(z));B._attachCancellationCallback(z)})}catch(z){return z}}function k(b){if(!this._isCancellable())return this;var C=this._onCancel();C!==void 0?p.isArray(C)?C.push(b):this._setOnCancel([C,b]):this._setOnCancel(b)}function N(){return this._onCancelField}function q(b){this._onCancelField=b}function Q(){this._cancellationParent=void 0,this._onCancelField=void 0}function h(b,C){if(C&1){this._cancellationParent=b;var A=b._branchesRemainingToCancel;A===void 0&&(A=0),b._branchesRemainingToCancel=A+1}C&2&&b._isBound()&&this._setBoundTo(b._boundTo)}function R(b,C){C&2&&b._isBound()&&this._setBoundTo(b._boundTo)}var d=R;function w(){var b=this._boundTo;return b!==void 0&&b instanceof e?b.isFulfilled()?b.value():void 0:b}function S(){this._trace=new Me(this._peekContext())}function O(b,C){if(f(b)){var A=this._trace;if(A!==void 0&&C&&(A=A._parent),A!==void 0)A.attachExtraTrace(b);else if(!b.__stackCleaned__){var B=T(b);p.notEnumerableProp(b,"stack",B.message+`
`+B.stack.join(`
`)),p.notEnumerableProp(b,"__stackCleaned__",!0)}}}function D(b,C,A,B,z){if(b===void 0&&C!==null&&F){if(z!==void 0&&z._returnedNonUndefined()||!(B._bitField&65535))return;A&&(A=A+" ");var le="",ie="";if(C._trace){for(var J=C._trace.stack.split(`
`),ue=ne(J),pe=ue.length-1;pe>=0;--pe){var xe=ue[pe];if(!i.test(xe)){var Oe=xe.match(s);Oe&&(le="at "+Oe[1]+":"+Oe[2]+":"+Oe[3]+" ");break}}if(ue.length>0){for(var Oa=ue[0],pe=0;pe<J.length;++pe)if(J[pe]===Oa){pe>0&&(ie=`
`+J[pe-1]);break}}}var ja="a promise was created in a "+A+"handler "+le+"but was not returned from it, see http://goo.gl/rRqMUw"+ie;B._warn(ja,!0,C)}}function _(b,C){var A=b+" is deprecated and will be removed in a future version.";return C&&(A+=" Use "+C+" instead."),$(A)}function $(b,C,A){if(fe.warnings){var B=new o(b),z;if(C)A._attachExtraTrace(B);else if(fe.longStackTraces&&(z=e._peekContext()))z.attachExtraTrace(B);else{var le=T(B);B.stack=le.message+`
`+le.stack.join(`
`)}G("warning",B)||I(B,"",!0)}}function K(b,C){for(var A=0;A<C.length-1;++A)C[A].push("From previous event:"),C[A]=C[A].join(`
`);return A<C.length&&(C[A]=C[A].join(`
`)),b+`
`+C.join(`
`)}function V(b){for(var C=0;C<b.length;++C)(b[C].length===0||C+1<b.length&&b[C][0]===b[C+1][0])&&(b.splice(C,1),C--)}function U(b){for(var C=b[0],A=1;A<b.length;++A){for(var B=b[A],z=C.length-1,le=C[z],ie=-1,J=B.length-1;J>=0;--J)if(B[J]===le){ie=J;break}for(var J=ie;J>=0;--J){var ue=B[J];if(C[z]===ue)C.pop(),z--;else break}C=B}}function ne(b){for(var C=[],A=0;A<b.length;++A){var B=b[A],z=B==="    (No stack trace)"||y.test(B),le=z&&_e(B);z&&!le&&(c&&B.charAt(0)!==" "&&(B="    "+B),C.push(B))}return C}function ye(b){for(var C=b.stack.replace(/\s+$/g,"").split(`
`),A=0;A<C.length;++A){var B=C[A];if(B==="    (No stack trace)"||y.test(B))break}return A>0&&b.name!="SyntaxError"&&(C=C.slice(A)),C}function T(b){var C=b.stack,A=b.toString();return C=typeof C=="string"&&C.length>0?ye(b):["    (No stack trace)"],{message:A,stack:b.name=="SyntaxError"?C:ne(C)}}function I(b,C,A){if(typeof console<"u"){var B;if(p.isObject(b)){var z=b.stack;B=C+g(z,b)}else B=C+String(b);typeof v=="function"?v(B,A):(typeof console.log=="function"||typeof console.log=="object")&&console.log(B)}}function P(b,C,A,B){var z=!1;try{typeof C=="function"&&(z=!0,b==="rejectionHandled"?C(B):C(A,B))}catch(le){n.throwLater(le)}b==="unhandledRejection"?!G(b,A,B)&&!z&&I(A,"Unhandled rejection "):G(b,B)}function Z(b){var C;if(typeof b=="function")C="[function "+(b.name||"anonymous")+"]";else{C=b&&typeof b.toString=="function"?b.toString():p.toString(b);var A=/\[object [a-zA-Z0-9$_]+\]/;if(A.test(C))try{var B=JSON.stringify(b);C=B}catch{}C.length===0&&(C="(empty array)")}return"(<"+re(C)+">, no stack trace)"}function re(b){var C=41;return b.length<C?b:b.substr(0,C-3)+"..."}function ae(){return typeof Sr=="function"}var _e=function(){return!1},$e=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function Pe(b){var C=b.match($e);if(C)return{fileName:C[1],line:parseInt(C[2],10)}}function xa(b,C){if(ae()){for(var A=b.stack.split(`
`),B=C.stack.split(`
`),z=-1,le=-1,ie,J,ue=0;ue<A.length;++ue){var pe=Pe(A[ue]);if(pe){ie=pe.fileName,z=pe.line;break}}for(var ue=0;ue<B.length;++ue){var pe=Pe(B[ue]);if(pe){J=pe.fileName,le=pe.line;break}}z<0||le<0||!ie||!J||ie!==J||z>=le||(_e=function(xe){if(l.test(xe))return!0;var Oe=Pe(xe);return!!(Oe&&Oe.fileName===ie&&z<=Oe.line&&Oe.line<=le)})}}function Me(b){this._parent=b,this._promisesCreated=0;var C=this._length=1+(b===void 0?0:b._length);Sr(this,Me),C>32&&this.uncycle()}p.inherits(Me,Error),t.CapturedTrace=Me,Me.prototype.uncycle=function(){var b=this._length;if(!(b<2)){for(var C=[],A={},B=0,z=this;z!==void 0;++B)C.push(z),z=z._parent;b=this._length=B;for(var B=b-1;B>=0;--B){var le=C[B].stack;A[le]===void 0&&(A[le]=B)}for(var B=0;B<b;++B){var ie=C[B].stack,J=A[ie];if(J!==void 0&&J!==B){J>0&&(C[J-1]._parent=void 0,C[J-1]._length=1),C[B]._parent=void 0,C[B]._length=1;var ue=B>0?C[B-1]:this;J<b-1?(ue._parent=C[J+1],ue._parent.uncycle(),ue._length=ue._parent._length+1):(ue._parent=void 0,ue._length=1);for(var pe=ue._length+1,xe=B-2;xe>=0;--xe)C[xe]._length=pe,pe++;return}}}},Me.prototype.attachExtraTrace=function(b){if(!b.__stackCleaned__){this.uncycle();for(var C=T(b),A=C.message,B=[C.stack],z=this;z!==void 0;)B.push(ne(z.stack.split(`
`))),z=z._parent;U(B),V(B),p.notEnumerableProp(b,"stack",K(A,B)),p.notEnumerableProp(b,"__stackCleaned__",!0)}};var Sr=function(){var C=/^\s*at\s*/,A=function(ie,J){return typeof ie=="string"?ie:J.name!==void 0&&J.message!==void 0?J.toString():Z(J)};if(typeof Error.stackTraceLimit=="number"&&typeof Error.captureStackTrace=="function"){Error.stackTraceLimit+=6,y=C,g=A;var B=Error.captureStackTrace;return _e=function(ie){return l.test(ie)},function(ie,J){Error.stackTraceLimit+=6,B(ie,J),Error.stackTraceLimit-=6}}var z=new Error;if(typeof z.stack=="string"&&z.stack.split(`
`)[0].indexOf("stackDetection@")>=0)return y=/@/,g=A,c=!0,function(J){J.stack=new Error().stack};var le;try{throw new Error}catch(ie){le="stack"in ie}return!("stack"in z)&&le&&typeof Error.stackTraceLimit=="number"?(y=C,g=A,function(J){Error.stackTraceLimit+=6;try{throw new Error}catch(ue){J.stack=ue.stack}Error.stackTraceLimit-=6}):(g=function(ie,J){return typeof ie=="string"?ie:(typeof J=="object"||typeof J=="function")&&J.name!==void 0&&J.message!==void 0?J.toString():Z(J)},null)}();typeof console<"u"&&typeof console.warn<"u"&&(v=function(b){console.warn(b)},p.isNode&&process.stderr.isTTY?v=function(b,C){var A=C?"\x1B[33m":"\x1B[31m";console.warn(A+b+`\x1B[0m
`)}:!p.isNode&&typeof new Error().stack=="string"&&(v=function(b,C){console.warn("%c"+b,C?"color: darkorange":"color: red")}));var fe={warnings:E,longStackTraces:!1,cancellation:!1,monitoring:!1};return x&&e.longStackTraces(),{longStackTraces:function(){return fe.longStackTraces},warnings:function(){return fe.warnings},cancellation:function(){return fe.cancellation},monitoring:function(){return fe.monitoring},propagateFromFunction:function(){return d},boundValueFunction:function(){return w},checkForgottenReturns:D,setBounds:xa,warn:$,deprecated:_,CapturedTrace:Me,fireDomEvent:M,fireGlobalEvent:L}}),It}var At,Dr;function Wa(){return Dr||(Dr=1,At=function(e,t){var r=oe(),n=e.CancellationError,o=r.errorObj;function p(s,y,g){this.promise=s,this.type=y,this.handler=g,this.called=!1,this.cancelPromise=null}p.prototype.isFinallyHandler=function(){return this.type===0};function f(s){this.finallyHandler=s}f.prototype._resultCancelled=function(){u(this.finallyHandler)};function u(s,y){return s.cancelPromise!=null?(arguments.length>1?s.cancelPromise._reject(y):s.cancelPromise._cancel(),s.cancelPromise=null,!0):!1}function a(){return i.call(this,this.promise._target()._settledValue())}function l(s){if(!u(this,s))return o.e=s,o}function i(s){var y=this.promise,g=this.handler;if(!this.called){this.called=!0;var c=this.isFinallyHandler()?g.call(y._boundValue()):g.call(y._boundValue(),s);if(c!==void 0){y._setReturnedNonUndefined();var v=t(c,y);if(v instanceof e){if(this.cancelPromise!=null)if(v._isCancelled()){var m=new n("late cancellation observer");return y._attachExtraTrace(m),o.e=m,o}else v.isPending()&&v._attachCancellationCallback(new f(this));return v._then(a,l,void 0,this,void 0)}}}return y.isRejected()?(u(this),o.e=s,o):(u(this),s)}return e.prototype._passThrough=function(s,y,g,c){return typeof s!="function"?this.then():this._then(g,c,void 0,new p(this,y,s),void 0)},e.prototype.lastly=e.prototype.finally=function(s){return this._passThrough(s,0,i,i)},e.prototype.tap=function(s){return this._passThrough(s,1,i)},p}),At}var Nt,Hr;function Xa(){return Hr||(Hr=1,Nt=function(e){var t=oe(),r=Ue().keys,n=t.tryCatch,o=t.errorObj;function p(f,u,a){return function(l){var i=a._boundValue();e:for(var s=0;s<f.length;++s){var y=f[s];if(y===Error||y!=null&&y.prototype instanceof Error){if(l instanceof y)return n(u).call(i,l)}else if(typeof y=="function"){var g=n(y).call(i,l);if(g===o)return g;if(g)return n(u).call(i,l)}else if(t.isObject(l)){for(var c=r(y),v=0;v<c.length;++v){var m=c[v];if(y[m]!=l[m])continue e}return n(u).call(i,l)}}return e}}return p}),Nt}var qt,$r;function Bn(){if($r)return qt;$r=1;var e=oe(),t=e.maybeWrapAsError,r=Be(),n=r.OperationalError,o=Ue();function p(l){return l instanceof Error&&o.getPrototypeOf(l)===Error.prototype}var f=/^(?:name|message|stack|cause)$/;function u(l){var i;if(p(l)){i=new n(l),i.name=l.name,i.message=l.message,i.stack=l.stack;for(var s=o.keys(l),y=0;y<s.length;++y){var g=s[y];f.test(g)||(i[g]=l[g])}return i}return e.markAsOriginatingFromRejection(l),l}function a(l,i){return function(s,y){if(l!==null){if(s){var g=u(t(s));l._attachExtraTrace(g),l._reject(g)}else if(!i)l._fulfill(y);else{for(var c=arguments.length,v=new Array(Math.max(c-1,0)),m=1;m<c;++m)v[m-1]=arguments[m];l._fulfill(v)}l=null}}}return qt=a,qt}var Bt,Pr;function za(){return Pr||(Pr=1,Bt=function(e,t,r,n,o){var p=oe(),f=p.tryCatch;e.method=function(u){if(typeof u!="function")throw new e.TypeError("expecting a function but got "+p.classString(u));return function(){var a=new e(t);a._captureStackTrace(),a._pushContext();var l=f(u).apply(this,arguments),i=a._popContext();return o.checkForgottenReturns(l,i,"Promise.method",a),a._resolveFromSyncValue(l),a}},e.attempt=e.try=function(u){if(typeof u!="function")return n("expecting a function but got "+p.classString(u));var a=new e(t);a._captureStackTrace(),a._pushContext();var l;if(arguments.length>1){o.deprecated("calling Promise.try with more than 1 argument");var i=arguments[1],s=arguments[2];l=p.isArray(i)?f(u).apply(s,i):f(u).call(s,i)}else l=f(u)();var y=a._popContext();return o.checkForgottenReturns(l,y,"Promise.try",a),a._resolveFromSyncValue(l),a},e.prototype._resolveFromSyncValue=function(u){u===p.errorObj?this._rejectCallback(u.e,!1):this._resolveCallback(u,!0)}}),Bt}var Mt,Lr;function Ga(){return Lr||(Lr=1,Mt=function(e,t,r,n){var o=!1,p=function(l,i){this._reject(i)},f=function(l,i){i.promiseRejectionQueued=!0,i.bindingPromise._then(p,p,null,this,l)},u=function(l,i){this._bitField&50397184||this._resolveCallback(i.target)},a=function(l,i){i.promiseRejectionQueued||this._reject(l)};e.prototype.bind=function(l){o||(o=!0,e.prototype._propagateFrom=n.propagateFromFunction(),e.prototype._boundValue=n.boundValueFunction());var i=r(l),s=new e(t);s._propagateFrom(this,1);var y=this._target();if(s._setBoundTo(i),i instanceof e){var g={promiseRejectionQueued:!1,promise:s,target:y,bindingPromise:i};y._then(t,f,void 0,s,g),i._then(u,a,void 0,s,g),s._setOnCancel(i)}else s._resolveCallback(y);return s},e.prototype._setBoundTo=function(l){l!==void 0?(this._bitField=this._bitField|2097152,this._boundTo=l):this._bitField=this._bitField&-2097153},e.prototype._isBound=function(){return(this._bitField&2097152)===2097152},e.bind=function(l,i){return e.resolve(i).bind(l)}}),Mt}var Dt,Vr;function Qa(){return Vr||(Vr=1,Dt=function(e,t,r,n){var o=oe(),p=o.tryCatch,f=o.errorObj,u=e._async;e.prototype.break=e.prototype.cancel=function(){if(!n.cancellation())return this._warn("cancellation is disabled");for(var a=this,l=a;a._isCancellable();){if(!a._cancelBy(l)){l._isFollowing()?l._followee().cancel():l._cancelBranched();break}var i=a._cancellationParent;if(i==null||!i._isCancellable()){a._isFollowing()?a._followee().cancel():a._cancelBranched();break}else a._isFollowing()&&a._followee().cancel(),a._setWillBeCancelled(),l=a,a=i}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return this._branchesRemainingToCancel===void 0||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(a){return a===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),this._enoughBranchesHaveCancelled()?(this._invokeOnCancel(),!0):!1)},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),u.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(a,l){if(o.isArray(a))for(var i=0;i<a.length;++i)this._doInvokeOnCancel(a[i],l);else if(a!==void 0)if(typeof a=="function"){if(!l){var s=p(a).call(this._boundValue());s===f&&(this._attachExtraTrace(s.e),u.throwLater(s.e))}}else a._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var a=this._onCancel();this._unsetOnCancel(),u.invoke(this._doInvokeOnCancel,this,a)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}),Dt}var Ht,Ur;function Za(){return Ur||(Ur=1,Ht=function(e){function t(){return this.value}function r(){throw this.reason}e.prototype.return=e.prototype.thenReturn=function(n){return n instanceof e&&n.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:n},void 0)},e.prototype.throw=e.prototype.thenThrow=function(n){return this._then(r,void 0,void 0,{reason:n},void 0)},e.prototype.catchThrow=function(n){if(arguments.length<=1)return this._then(void 0,r,void 0,{reason:n},void 0);var o=arguments[1],p=function(){throw o};return this.caught(n,p)},e.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof e&&n.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:n},void 0);var o=arguments[1];o instanceof e&&o.suppressUnhandledRejections();var p=function(){return o};return this.caught(n,p)}}),Ht}var $t,Wr;function Ka(){return Wr||(Wr=1,$t=function(e){function t(a){a!==void 0?(a=a._target(),this._bitField=a._bitField,this._settledValueField=a._isFateSealed()?a._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var r=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError(`cannot get fulfillment value of a non-fulfilled promise

    See http://goo.gl/MqrFmX
`);return this._settledValue()},n=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError(`cannot get rejection reason of a non-rejected promise

    See http://goo.gl/MqrFmX
`);return this._settledValue()},o=t.prototype.isFulfilled=function(){return(this._bitField&33554432)!==0},p=t.prototype.isRejected=function(){return(this._bitField&16777216)!==0},f=t.prototype.isPending=function(){return(this._bitField&50397184)===0},u=t.prototype.isResolved=function(){return(this._bitField&50331648)!==0};t.prototype.isCancelled=function(){return(this._bitField&8454144)!==0},e.prototype.__isCancelled=function(){return(this._bitField&65536)===65536},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return(this._target()._bitField&8454144)!==0},e.prototype.isPending=function(){return f.call(this._target())},e.prototype.isRejected=function(){return p.call(this._target())},e.prototype.isFulfilled=function(){return o.call(this._target())},e.prototype.isResolved=function(){return u.call(this._target())},e.prototype.value=function(){return r.call(this._target())},e.prototype.reason=function(){var a=this._target();return a._unsetRejectionIsUnhandled(),n.call(a)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}),$t}var Pt,Xr;function Ja(){return Xr||(Xr=1,Pt=function(e,t,r,n,o,p){var f=oe(),u=f.canEvaluate,a=f.tryCatch,l=f.errorObj,i;if(u){for(var s=function(x){return new Function("value","holder",`                             
	            'use strict';                                                    
	            holder.pIndex = value;                                           
	            holder.checkFulfillment(this);                                   
	            `.replace(/Index/g,x))},y=function(x){return new Function("promise","holder",`                           
	            'use strict';                                                    
	            holder.pIndex = promise;                                         
	            `.replace(/Index/g,x))},g=function(x){for(var F=new Array(x),H=0;H<F.length;++H)F[H]="this.p"+(H+1);var M=F.join(" = ")+" = null;",L=`var promise;
`+F.map(function(te){return`                                                         
	                promise = `+te+`;                                      
	                if (promise instanceof Promise) {                            
	                    promise.cancel();                                        
	                }                                                            
	            `}).join(`
`),W=F.join(", "),X="Holder$"+x,G=`return function(tryCatch, errorObj, Promise, async) {    
	            'use strict';                                                    
	            function [TheName](fn) {                                         
	                [TheProperties]                                              
	                this.fn = fn;                                                
	                this.asyncNeeded = true;                                     
	                this.now = 0;                                                
	            }                                                                
	                                                                             
	            [TheName].prototype._callFunction = function(promise) {          
	                promise._pushContext();                                      
	                var ret = tryCatch(this.fn)([ThePassedArguments]);           
	                promise._popContext();                                       
	                if (ret === errorObj) {                                      
	                    promise._rejectCallback(ret.e, false);                   
	                } else {                                                     
	                    promise._resolveCallback(ret);                           
	                }                                                            
	            };                                                               
	                                                                             
	            [TheName].prototype.checkFulfillment = function(promise) {       
	                var now = ++this.now;                                        
	                if (now === [TheTotal]) {                                    
	                    if (this.asyncNeeded) {                                  
	                        async.invoke(this._callFunction, this, promise);     
	                    } else {                                                 
	                        this._callFunction(promise);                         
	                    }                                                        
	                                                                             
	                }                                                            
	            };                                                               
	                                                                             
	            [TheName].prototype._resultCancelled = function() {              
	                [CancellationCode]                                           
	            };                                                               
	                                                                             
	            return [TheName];                                                
	        }(tryCatch, errorObj, Promise, async);                               
	        `;return G=G.replace(/\[TheName\]/g,X).replace(/\[TheTotal\]/g,x).replace(/\[ThePassedArguments\]/g,W).replace(/\[TheProperties\]/g,M).replace(/\[CancellationCode\]/g,L),new Function("tryCatch","errorObj","Promise","async",G)(a,l,e,o)},c=[],v=[],m=[],E=0;E<8;++E)c.push(g(E+1)),v.push(s(E+1)),m.push(y(E+1));i=function(x){this._reject(x)}}e.join=function(){var x=arguments.length-1,F;if(x>0&&typeof arguments[x]=="function"&&(F=arguments[x],x<=8&&u)){var q=new e(n);q._captureStackTrace();for(var H=c[x-1],M=new H(F),L=v,W=0;W<x;++W){var X=r(arguments[W],q);if(X instanceof e){X=X._target();var G=X._bitField;G&50397184?G&33554432?L[W].call(q,X._value(),M):G&16777216?q._reject(X._reason()):q._cancel():(X._then(L[W],i,void 0,q,M),m[W](X,M),M.asyncNeeded=!1)}else L[W].call(q,X,M)}if(!q._isFateSealed()){if(M.asyncNeeded){var te=p();te!==null&&(M.fn=f.domainBind(te,M.fn))}q._setAsyncGuaranteed(),q._setOnCancel(M)}return q}for(var se=arguments.length,k=new Array(se),N=0;N<se;++N)k[N]=arguments[N];F&&k.pop();var q=new t(k).promise();return F!==void 0?q.spread(F):q}}),Pt}var Lt,zr;function Ya(){return zr||(zr=1,Lt=function(e,t,r,n,o,p){var f=e._getDomain,u=oe(),a=u.tryCatch,l=u.errorObj,i=e._async;function s(g,c,v,m){this.constructor$(g),this._promise._captureStackTrace();var E=f();this._callback=E===null?c:u.domainBind(E,c),this._preservedValues=m===o?new Array(this.length()):null,this._limit=v,this._inFlight=0,this._queue=[],i.invoke(this._asyncInit,this,void 0)}u.inherits(s,t),s.prototype._asyncInit=function(){this._init$(void 0,-2)},s.prototype._init=function(){},s.prototype._promiseFulfilled=function(g,c){var v=this._values,m=this.length(),E=this._preservedValues,x=this._limit;if(c<0){if(c=c*-1-1,v[c]=g,x>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(x>=1&&this._inFlight>=x)return v[c]=g,this._queue.push(c),!1;E!==null&&(E[c]=g);var F=this._promise,H=this._callback,M=F._boundValue();F._pushContext();var L=a(H).call(M,g,c,m),W=F._popContext();if(p.checkForgottenReturns(L,W,E!==null?"Promise.filter":"Promise.map",F),L===l)return this._reject(L.e),!0;var X=n(L,this._promise);if(X instanceof e){X=X._target();var G=X._bitField;if(G&50397184)if(G&33554432)L=X._value();else return G&16777216?(this._reject(X._reason()),!0):(this._cancel(),!0);else return x>=1&&this._inFlight++,v[c]=X,X._proxy(this,(c+1)*-1),!1}v[c]=L}var te=++this._totalResolved;return te>=m?(E!==null?this._filter(v,E):this._resolve(v),!0):!1},s.prototype._drainQueue=function(){for(var g=this._queue,c=this._limit,v=this._values;g.length>0&&this._inFlight<c;){if(this._isResolved())return;var m=g.pop();this._promiseFulfilled(v[m],m)}},s.prototype._filter=function(g,c){for(var v=c.length,m=new Array(v),E=0,x=0;x<v;++x)g[x]&&(m[E++]=c[x]);m.length=E,this._resolve(m)},s.prototype.preservedValues=function(){return this._preservedValues};function y(g,c,v,m){if(typeof c!="function")return r("expecting a function but got "+u.classString(c));var E=0;if(v!==void 0)if(typeof v=="object"&&v!==null){if(typeof v.concurrency!="number")return e.reject(new TypeError("'concurrency' must be a number but it is "+u.classString(v.concurrency)));E=v.concurrency}else return e.reject(new TypeError("options argument must be an object but it is "+u.classString(v)));return E=typeof E=="number"&&isFinite(E)&&E>=1?E:0,new s(g,c,E,m).promise()}e.prototype.map=function(g,c){return y(this,g,c,null)},e.map=function(g,c,v,m){return y(g,c,v,m)}}),Lt}var Vt,Gr;function ei(){if(Gr)return Vt;Gr=1;var e=Object.create;if(e){var t=e(null),r=e(null);t[" size"]=r[" size"]=0}return Vt=function(n){var o=oe(),p=o.canEvaluate,f=o.isIdentifier,u,a;{var l=function(m){return new Function("ensureMethod",`                                    
	        return function(obj) {                                               
	            'use strict'                                                     
	            var len = this.length;                                           
	            ensureMethod(obj, 'methodName');                                 
	            switch(len) {                                                    
	                case 1: return obj.methodName(this[0]);                      
	                case 2: return obj.methodName(this[0], this[1]);             
	                case 3: return obj.methodName(this[0], this[1], this[2]);    
	                case 0: return obj.methodName();                             
	                default:                                                     
	                    return obj.methodName.apply(obj, this);                  
	            }                                                                
	        };                                                                   
	        `.replace(/methodName/g,m))(y)},i=function(m){return new Function("obj",`                                             
	        'use strict';                                                        
	        return obj.propertyName;                                             
	        `.replace("propertyName",m))},s=function(m,E,x){var F=x[m];if(typeof F!="function"){if(!f(m))return null;if(F=E(m),x[m]=F,x[" size"]++,x[" size"]>512){for(var H=Object.keys(x),M=0;M<256;++M)delete x[H[M]];x[" size"]=H.length-256}}return F};u=function(m){return s(m,l,t)},a=function(m){return s(m,i,r)}}function y(m,E){var x;if(m!=null&&(x=m[E]),typeof x!="function"){var F="Object "+o.classString(m)+" has no method '"+o.toString(E)+"'";throw new n.TypeError(F)}return x}function g(m){var E=this.pop(),x=y(m,E);return x.apply(m,this)}n.prototype.call=function(m){for(var E=arguments.length,x=new Array(Math.max(E-1,0)),F=1;F<E;++F)x[F-1]=arguments[F];if(p){var H=u(m);if(H!==null)return this._then(H,void 0,void 0,x,void 0)}return x.push(m),this._then(g,void 0,void 0,x,void 0)};function c(m){return m[this]}function v(m){var E=+this;return E<0&&(E=Math.max(0,E+m.length)),m[E]}n.prototype.get=function(m){var E=typeof m=="number",x;if(E)x=v;else if(p){var F=a(m);x=F!==null?F:c}else x=c;return this._then(x,void 0,void 0,m,void 0)}},Vt}var Ut,Qr;function ti(){return Qr||(Qr=1,Ut=function(e,t,r,n,o,p){var f=oe(),u=Be().TypeError,a=oe().inherits,l=f.errorObj,i=f.tryCatch,s={};function y(F){setTimeout(function(){throw F},0)}function g(F){var H=r(F);return H!==F&&typeof F._isDisposable=="function"&&typeof F._getDisposer=="function"&&F._isDisposable()&&H._setDisposable(F._getDisposer()),H}function c(F,H){var M=0,L=F.length,W=new e(o);function X(){if(M>=L)return W._fulfill();var G=g(F[M++]);if(G instanceof e&&G._isDisposable()){try{G=r(G._getDisposer().tryDispose(H),F.promise)}catch(te){return y(te)}if(G instanceof e)return G._then(X,y,null,null,null)}X()}return X(),W}function v(F,H,M){this._data=F,this._promise=H,this._context=M}v.prototype.data=function(){return this._data},v.prototype.promise=function(){return this._promise},v.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():s},v.prototype.tryDispose=function(F){var H=this.resource(),M=this._context;M!==void 0&&M._pushContext();var L=H!==s?this.doDispose(H,F):null;return M!==void 0&&M._popContext(),this._promise._unsetDisposable(),this._data=null,L},v.isDisposer=function(F){return F!=null&&typeof F.resource=="function"&&typeof F.tryDispose=="function"};function m(F,H,M){this.constructor$(F,H,M)}a(m,v),m.prototype.doDispose=function(F,H){var M=this.data();return M.call(F,F,H)};function E(F){return v.isDisposer(F)?(this.resources[this.index]._setDisposable(F),F.promise()):F}function x(F){this.length=F,this.promise=null,this[F-1]=null}x.prototype._resultCancelled=function(){for(var F=this.length,H=0;H<F;++H){var M=this[H];M instanceof e&&M.cancel()}},e.using=function(){var F=arguments.length;if(F<2)return t("you must pass at least 2 arguments to Promise.using");var H=arguments[F-1];if(typeof H!="function")return t("expecting a function but got "+f.classString(H));var M,L=!0;F===2&&Array.isArray(arguments[0])?(M=arguments[0],F=M.length,L=!1):(M=arguments,F--);for(var W=new x(F),X=0;X<F;++X){var G=M[X];if(v.isDisposer(G)){var te=G;G=G.promise(),G._setDisposable(te)}else{var se=r(G);se instanceof e&&(G=se._then(E,null,null,{resources:W,index:X},void 0))}W[X]=G}for(var k=new Array(W.length),X=0;X<k.length;++X)k[X]=e.resolve(W[X]).reflect();var N=e.all(k).then(function(Q){for(var h=0;h<Q.length;++h){var R=Q[h];if(R.isRejected())return l.e=R.error(),l;if(!R.isFulfilled()){N.cancel();return}Q[h]=R.value()}q._pushContext(),H=i(H);var d=L?H.apply(void 0,Q):H(Q),w=q._popContext();return p.checkForgottenReturns(d,w,"Promise.using",q),d}),q=N.lastly(function(){var Q=new e.PromiseInspection(N);return c(W,Q)});return W.promise=q,q._setOnCancel(W),q},e.prototype._setDisposable=function(F){this._bitField=this._bitField|131072,this._disposer=F},e.prototype._isDisposable=function(){return(this._bitField&131072)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=this._bitField&-131073,this._disposer=void 0},e.prototype.disposer=function(F){if(typeof F=="function")return new m(F,this,n());throw new u}}),Ut}var Wt,Zr;function ri(){return Zr||(Zr=1,Wt=function(e,t,r){var n=oe(),o=e.TimeoutError;function p(s){this.handle=s}p.prototype._resultCancelled=function(){clearTimeout(this.handle)};var f=function(s){return u(+this).thenReturn(s)},u=e.delay=function(s,y){var g,c;return y!==void 0?(g=e.resolve(y)._then(f,null,null,s,void 0),r.cancellation()&&y instanceof e&&g._setOnCancel(y)):(g=new e(t),c=setTimeout(function(){g._fulfill()},+s),r.cancellation()&&g._setOnCancel(new p(c)),g._captureStackTrace()),g._setAsyncGuaranteed(),g};e.prototype.delay=function(s){return u(s,this)};var a=function(s,y,g){var c;typeof y!="string"?y instanceof Error?c=y:c=new o("operation timed out"):c=new o(y),n.markAsOriginatingFromRejection(c),s._attachExtraTrace(c),s._reject(c),g!=null&&g.cancel()};function l(s){return clearTimeout(this.handle),s}function i(s){throw clearTimeout(this.handle),s}e.prototype.timeout=function(s,y){s=+s;var g,c,v=new p(setTimeout(function(){g.isPending()&&a(g,y,c)},s));return r.cancellation()?(c=this.then(),g=c._then(l,i,void 0,v,void 0),g._setOnCancel(v)):g=this._then(l,i,void 0,v,void 0),g}}),Wt}var Xt,Kr;function ni(){return Kr||(Kr=1,Xt=function(e,t,r,n,o,p){var f=Be(),u=f.TypeError,a=oe(),l=a.errorObj,i=a.tryCatch,s=[];function y(c,v,m){for(var E=0;E<v.length;++E){m._pushContext();var x=i(v[E])(c);if(m._popContext(),x===l){m._pushContext();var F=e.reject(l.e);return m._popContext(),F}var H=n(x,m);if(H instanceof e)return H}return null}function g(c,v,m,E){if(p.cancellation()){var x=new e(r),F=this._finallyPromise=new e(r);this._promise=x.lastly(function(){return F}),x._captureStackTrace(),x._setOnCancel(this)}else{var H=this._promise=new e(r);H._captureStackTrace()}this._stack=E,this._generatorFunction=c,this._receiver=v,this._generator=void 0,this._yieldHandlers=typeof m=="function"?[m].concat(s):s,this._yieldedPromise=null,this._cancellationPhase=!1}a.inherits(g,o),g.prototype._isResolved=function(){return this._promise===null},g.prototype._cleanup=function(){this._promise=this._generator=null,p.cancellation()&&this._finallyPromise!==null&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},g.prototype._promiseCancelled=function(){if(!this._isResolved()){var c=typeof this._generator.return<"u",v;if(c)this._promise._pushContext(),v=i(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var m=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=m,this._promise._attachExtraTrace(m),this._promise._pushContext(),v=i(this._generator.throw).call(this._generator,m),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(v)}},g.prototype._promiseFulfilled=function(c){this._yieldedPromise=null,this._promise._pushContext();var v=i(this._generator.next).call(this._generator,c);this._promise._popContext(),this._continue(v)},g.prototype._promiseRejected=function(c){this._yieldedPromise=null,this._promise._attachExtraTrace(c),this._promise._pushContext();var v=i(this._generator.throw).call(this._generator,c);this._promise._popContext(),this._continue(v)},g.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var c=this._yieldedPromise;this._yieldedPromise=null,c.cancel()}},g.prototype.promise=function(){return this._promise},g.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},g.prototype._continue=function(c){var v=this._promise;if(c===l)return this._cleanup(),this._cancellationPhase?v.cancel():v._rejectCallback(c.e,!1);var m=c.value;if(c.done===!0)return this._cleanup(),this._cancellationPhase?v.cancel():v._resolveCallback(m);var E=n(m,this._promise);if(!(E instanceof e)&&(E=y(E,this._yieldHandlers,this._promise),E===null)){this._promiseRejected(new u(`A value %s was yielded that could not be treated as a promise

    See http://goo.gl/MqrFmX

`.replace("%s",m)+`From coroutine:
`+this._stack.split(`
`).slice(1,-7).join(`
`)));return}E=E._target();var x=E._bitField;x&50397184?x&33554432?e._async.invoke(this._promiseFulfilled,this,E._value()):x&16777216?e._async.invoke(this._promiseRejected,this,E._reason()):this._promiseCancelled():(this._yieldedPromise=E,E._proxy(this,null))},e.coroutine=function(c,v){if(typeof c!="function")throw new u(`generatorFunction must be a function

    See http://goo.gl/MqrFmX
`);var m=Object(v).yieldHandler,E=g,x=new Error().stack;return function(){var F=c.apply(this,arguments),H=new E(void 0,void 0,m,x),M=H.promise();return H._generator=F,H._promiseFulfilled(void 0),M}},e.coroutine.addYieldHandler=function(c){if(typeof c!="function")throw new u("expecting a function but got "+a.classString(c));s.push(c)},e.spawn=function(c){if(p.deprecated("Promise.spawn()","Promise.coroutine()"),typeof c!="function")return t(`generatorFunction must be a function

    See http://goo.gl/MqrFmX
`);var v=new g(c,this),m=v.promise();return v._run(e.spawn),m}}),Xt}var zt,Jr;function ai(){return Jr||(Jr=1,zt=function(e){var t=oe(),r=e._async,n=t.tryCatch,o=t.errorObj;function p(a,l){var i=this;if(!t.isArray(a))return f.call(i,a,l);var s=n(l).apply(i._boundValue(),[null].concat(a));s===o&&r.throwLater(s.e)}function f(a,l){var i=this,s=i._boundValue(),y=a===void 0?n(l).call(s,null):n(l).call(s,null,a);y===o&&r.throwLater(y.e)}function u(a,l){var i=this;if(!a){var s=new Error(a+"");s.cause=a,a=s}var y=n(l).call(i._boundValue(),a);y===o&&r.throwLater(y.e)}e.prototype.asCallback=e.prototype.nodeify=function(a,l){if(typeof a=="function"){var i=f;l!==void 0&&Object(l).spread&&(i=p),this._then(i,u,void 0,this,a)}return this}}),zt}var Gt,Yr;function ii(){return Yr||(Yr=1,Gt=function(e,t){var r={},n=oe(),o=Bn(),p=n.withAppended,f=n.maybeWrapAsError,u=n.canEvaluate,a=Be().TypeError,l="Async",i={__isPromisified__:!0},s=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],y=new RegExp("^(?:"+s.join("|")+")$"),g=function(N){return n.isIdentifier(N)&&N.charAt(0)!=="_"&&N!=="constructor"};function c(N){return!y.test(N)}function v(N){try{return N.__isPromisified__===!0}catch{return!1}}function m(N,q,Q){var h=n.getDataPropertyOrDefault(N,q+Q,i);return h?v(h):!1}function E(N,q,Q){for(var h=0;h<N.length;h+=2){var R=N[h];if(Q.test(R)){for(var d=R.replace(Q,""),w=0;w<N.length;w+=2)if(N[w]===d)throw new a(`Cannot promisify an API that has normal methods with '%s'-suffix

    See http://goo.gl/MqrFmX
`.replace("%s",q))}}}function x(N,q,Q,h){for(var R=n.inheritedDataKeys(N),d=[],w=0;w<R.length;++w){var S=R[w],O=N[S],D=h===g?!0:g(S);typeof O=="function"&&!v(O)&&!m(N,S,q)&&h(S,O,N,D)&&d.push(S,O)}return E(d,q,Q),d}var F=function(N){return N.replace(/([$])/,"\\$")},H;{var M=function(N){for(var q=[N],Q=Math.max(0,N-1-3),h=N-1;h>=Q;--h)q.push(h);for(var h=N+1;h<=3;++h)q.push(h);return q},L=function(N){return n.filledRange(N,"_arg","")},W=function(N){return n.filledRange(Math.max(N,3),"_arg","")},X=function(N){return typeof N.length=="number"?Math.max(Math.min(N.length,1024),0):0};H=function(N,q,Q,h,R,d){var w=Math.max(0,X(h)-1),S=M(w),O=typeof N=="string"||q===r;function D(V){var U=L(V).join(", "),ne=V>0?", ":"",ye;return O?ye=`ret = callback.call(this, {{args}}, nodeback); break;
`:ye=q===void 0?`ret = callback({{args}}, nodeback); break;
`:`ret = callback.call(receiver, {{args}}, nodeback); break;
`,ye.replace("{{args}}",U).replace(", ",ne)}function _(){for(var V="",U=0;U<S.length;++U)V+="case "+S[U]+":"+D(S[U]);return V+=`                                                             
	        default:                                                             
	            var args = new Array(len + 1);                                   
	            var i = 0;                                                       
	            for (var i = 0; i < len; ++i) {                                  
	               args[i] = arguments[i];                                       
	            }                                                                
	            args[i] = nodeback;                                              
	            [CodeForCall]                                                    
	            break;                                                           
	        `.replace("[CodeForCall]",O?`ret = callback.apply(this, args);
`:`ret = callback.apply(receiver, args);
`),V}var $=typeof N=="string"?"this != null ? this['"+N+"'] : fn":"fn",K=`'use strict';                                                
	        var ret = function (Parameters) {                                    
	            'use strict';                                                    
	            var len = arguments.length;                                      
	            var promise = new Promise(INTERNAL);                             
	            promise._captureStackTrace();                                    
	            var nodeback = nodebackForPromise(promise, `+d+`);   
	            var ret;                                                         
	            var callback = tryCatch([GetFunctionCode]);                      
	            switch(len) {                                                    
	                [CodeForSwitchCase]                                          
	            }                                                                
	            if (ret === errorObj) {                                          
	                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);
	            }                                                                
	            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     
	            return promise;                                                  
	        };                                                                   
	        notEnumerableProp(ret, '__isPromisified__', true);                   
	        return ret;                                                          
	    `.replace("[CodeForSwitchCase]",_()).replace("[GetFunctionCode]",$);return K=K.replace("Parameters",W(w)),new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL",K)(e,h,q,p,f,o,n.tryCatch,n.errorObj,n.notEnumerableProp,t)}}function G(N,q,Q,h,R,d){var w=function(){return this}(),S=N;typeof S=="string"&&(N=h);function O(){var D=q;q===r&&(D=this);var _=new e(t);_._captureStackTrace();var $=typeof S=="string"&&this!==w?this[S]:N,K=o(_,d);try{$.apply(D,p(arguments,K))}catch(V){_._rejectCallback(f(V),!0,!0)}return _._isFateSealed()||_._setAsyncGuaranteed(),_}return n.notEnumerableProp(O,"__isPromisified__",!0),O}var te=u?H:G;function se(N,q,Q,h,R){for(var d=new RegExp(F(q)+"$"),w=x(N,q,d,Q),S=0,O=w.length;S<O;S+=2){var D=w[S],_=w[S+1],$=D+q;if(h===te)N[$]=te(D,r,D,_,q,R);else{var K=h(_,function(){return te(D,r,D,_,q,R)});n.notEnumerableProp(K,"__isPromisified__",!0),N[$]=K}}return n.toFastProperties(N),N}function k(N,q,Q){return te(N,q,void 0,N,null,Q)}e.promisify=function(N,q){if(typeof N!="function")throw new a("expecting a function but got "+n.classString(N));if(v(N))return N;q=Object(q);var Q=q.context===void 0?r:q.context,h=!!q.multiArgs,R=k(N,Q,h);return n.copyDescriptors(N,R,c),R},e.promisifyAll=function(N,q){if(typeof N!="function"&&typeof N!="object")throw new a(`the target of promisifyAll must be an object or a function

    See http://goo.gl/MqrFmX
`);q=Object(q);var Q=!!q.multiArgs,h=q.suffix;typeof h!="string"&&(h=l);var R=q.filter;typeof R!="function"&&(R=g);var d=q.promisifier;if(typeof d!="function"&&(d=te),!n.isIdentifier(h))throw new RangeError(`suffix must be a valid identifier

    See http://goo.gl/MqrFmX
`);for(var w=n.inheritedDataKeys(N),S=0;S<w.length;++S){var O=N[w[S]];w[S]!=="constructor"&&n.isClass(O)&&(se(O.prototype,h,R,d,Q),se(O,h,R,d,Q))}return se(N,h,R,d,Q)}}),Gt}var Qt,en;function oi(){return en||(en=1,Qt=function(e,t,r,n){var o=oe(),p=o.isObject,f=Ue(),u;typeof Map=="function"&&(u=Map);var a=function(){var y=0,g=0;function c(v,m){this[y]=v,this[y+g]=m,y++}return function(m){g=m.size,y=0;var E=new Array(m.size*2);return m.forEach(c,E),E}}(),l=function(y){for(var g=new u,c=y.length/2|0,v=0;v<c;++v){var m=y[c+v],E=y[v];g.set(m,E)}return g};function i(y){var g=!1,c;if(u!==void 0&&y instanceof u)c=a(y),g=!0;else{var v=f.keys(y),m=v.length;c=new Array(m*2);for(var E=0;E<m;++E){var x=v[E];c[E]=y[x],c[E+m]=x}}this.constructor$(c),this._isMap=g,this._init$(void 0,-3)}o.inherits(i,t),i.prototype._init=function(){},i.prototype._promiseFulfilled=function(y,g){this._values[g]=y;var c=++this._totalResolved;if(c>=this._length){var v;if(this._isMap)v=l(this._values);else{v={};for(var m=this.length(),E=0,x=this.length();E<x;++E)v[this._values[E+m]]=this._values[E]}return this._resolve(v),!0}return!1},i.prototype.shouldCopyValues=function(){return!1},i.prototype.getActualLength=function(y){return y>>1};function s(y){var g,c=r(y);if(p(c))c instanceof e?g=c._then(e.props,void 0,void 0,void 0,void 0):g=new i(c).promise();else return n(`cannot await properties of a non-object

    See http://goo.gl/MqrFmX
`);return c instanceof e&&g._propagateFrom(c,2),g}e.prototype.props=function(){return s(this)},e.props=function(y){return s(y)}}),Qt}var Zt,tn;function ui(){return tn||(tn=1,Zt=function(e,t,r,n){var o=oe(),p=function(u){return u.then(function(a){return f(a,u)})};function f(u,a){var l=r(u);if(l instanceof e)return p(l);if(u=o.asArray(u),u===null)return n("expecting an array or an iterable object but got "+o.classString(u));var i=new e(t);a!==void 0&&i._propagateFrom(a,3);for(var s=i._fulfill,y=i._reject,g=0,c=u.length;g<c;++g){var v=u[g];v===void 0&&!(g in u)||e.cast(v)._then(s,y,void 0,i,null)}return i}e.race=function(u){return f(u,void 0)},e.prototype.race=function(){return f(this,void 0)}}),Zt}var Kt,rn;function si(){return rn||(rn=1,Kt=function(e,t,r,n,o,p){var f=e._getDomain,u=oe(),a=u.tryCatch;function l(c,v,m,E){this.constructor$(c);var x=f();this._fn=x===null?v:u.domainBind(x,v),m!==void 0&&(m=e.resolve(m),m._attachCancellationCallback(this)),this._initialValue=m,this._currentCancellable=null,E===o?this._eachValues=Array(this._length):E===0?this._eachValues=null:this._eachValues=void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}u.inherits(l,t),l.prototype._gotAccum=function(c){this._eachValues!==void 0&&this._eachValues!==null&&c!==o&&this._eachValues.push(c)},l.prototype._eachComplete=function(c){return this._eachValues!==null&&this._eachValues.push(c),this._eachValues},l.prototype._init=function(){},l.prototype._resolveEmptyArray=function(){this._resolve(this._eachValues!==void 0?this._eachValues:this._initialValue)},l.prototype.shouldCopyValues=function(){return!1},l.prototype._resolve=function(c){this._promise._resolveCallback(c),this._values=null},l.prototype._resultCancelled=function(c){if(c===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel())},l.prototype._iterate=function(c){this._values=c;var v,m,E=c.length;if(this._initialValue!==void 0?(v=this._initialValue,m=0):(v=e.resolve(c[0]),m=1),this._currentCancellable=v,!v.isRejected())for(;m<E;++m){var x={accum:null,value:c[m],index:m,length:E,array:this};v=v._then(y,void 0,void 0,x,void 0)}this._eachValues!==void 0&&(v=v._then(this._eachComplete,void 0,void 0,this,void 0)),v._then(i,i,void 0,v,this)},e.prototype.reduce=function(c,v){return s(this,c,v,null)},e.reduce=function(c,v,m,E){return s(c,v,m,E)};function i(c,v){this.isFulfilled()?v._resolve(c):v._reject(c)}function s(c,v,m,E){if(typeof v!="function")return r("expecting a function but got "+u.classString(v));var x=new l(c,v,m,E);return x.promise()}function y(c){this.accum=c,this.array._gotAccum(c);var v=n(this.value,this.array._promise);return v instanceof e?(this.array._currentCancellable=v,v._then(g,void 0,void 0,this,void 0)):g.call(this,v)}function g(c){var v=this.array,m=v._promise,E=a(v._fn);m._pushContext();var x;v._eachValues!==void 0?x=E.call(m._boundValue(),c,this.index,this.length):x=E.call(m._boundValue(),this.accum,c,this.index,this.length),x instanceof e&&(v._currentCancellable=x);var F=m._popContext();return p.checkForgottenReturns(x,F,v._eachValues!==void 0?"Promise.each":"Promise.reduce",m),x}}),Kt}var Jt,nn;function li(){return nn||(nn=1,Jt=function(e,t,r){var n=e.PromiseInspection,o=oe();function p(f){this.constructor$(f)}o.inherits(p,t),p.prototype._promiseResolved=function(f,u){this._values[f]=u;var a=++this._totalResolved;return a>=this._length?(this._resolve(this._values),!0):!1},p.prototype._promiseFulfilled=function(f,u){var a=new n;return a._bitField=33554432,a._settledValueField=f,this._promiseResolved(u,a)},p.prototype._promiseRejected=function(f,u){var a=new n;return a._bitField=16777216,a._settledValueField=f,this._promiseResolved(u,a)},e.settle=function(f){return r.deprecated(".settle()",".reflect()"),new p(f).promise()},e.prototype.settle=function(){return e.settle(this)}}),Jt}var Yt,an;function ci(){return an||(an=1,Yt=function(e,t,r){var n=oe(),o=Be().RangeError,p=Be().AggregateError,f=n.isArray,u={};function a(i){this.constructor$(i),this._howMany=0,this._unwrap=!1,this._initialized=!1}n.inherits(a,t),a.prototype._init=function(){if(this._initialized){if(this._howMany===0){this._resolve([]);return}this._init$(void 0,-5);var i=f(this._values);!this._isResolved()&&i&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},a.prototype.init=function(){this._initialized=!0,this._init()},a.prototype.setUnwrap=function(){this._unwrap=!0},a.prototype.howMany=function(){return this._howMany},a.prototype.setHowMany=function(i){this._howMany=i},a.prototype._promiseFulfilled=function(i){return this._addFulfilled(i),this._fulfilled()===this.howMany()?(this._values.length=this.howMany(),this.howMany()===1&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0):!1},a.prototype._promiseRejected=function(i){return this._addRejected(i),this._checkOutcome()},a.prototype._promiseCancelled=function(){return this._values instanceof e||this._values==null?this._cancel():(this._addRejected(u),this._checkOutcome())},a.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var i=new p,s=this.length();s<this._values.length;++s)this._values[s]!==u&&i.push(this._values[s]);return i.length>0?this._reject(i):this._cancel(),!0}return!1},a.prototype._fulfilled=function(){return this._totalResolved},a.prototype._rejected=function(){return this._values.length-this.length()},a.prototype._addRejected=function(i){this._values.push(i)},a.prototype._addFulfilled=function(i){this._values[this._totalResolved++]=i},a.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},a.prototype._getRangeError=function(i){var s="Input array must contain at least "+this._howMany+" items but contains only "+i+" items";return new o(s)},a.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))};function l(i,s){if((s|0)!==s||s<0)return r(`expecting a positive integer

    See http://goo.gl/MqrFmX
`);var y=new a(i),g=y.promise();return y.setHowMany(s),y.init(),g}e.some=function(i,s){return l(i,s)},e.prototype.some=function(i){return l(this,i)},e._SomePromiseArray=a}),Yt}var er,on;function fi(){return on||(on=1,er=function(e,t){var r=e.map;e.prototype.filter=function(n,o){return r(this,n,o,t)},e.filter=function(n,o,p){return r(n,o,p,t)}}),er}var tr,un;function pi(){return un||(un=1,tr=function(e,t){var r=e.reduce,n=e.all;function o(){return n(this)}function p(f,u){return r(f,u,t,t)}e.prototype.each=function(f){return r(this,f,t,0)._then(o,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(f){return r(this,f,t,t)},e.each=function(f,u){return r(f,u,t,0)._then(o,void 0,void 0,f,void 0)},e.mapSeries=p}),tr}var rr,sn;function hi(){return sn||(sn=1,rr=function(e){var t=e._SomePromiseArray;function r(n){var o=new t(n),p=o.promise();return o.setHowMany(1),o.setUnwrap(),o.init(),p}e.any=function(n){return r(n)},e.prototype.any=function(){return r(this)}}),rr}(function(e){e.exports=function(){var t=function(){return new y(`circular promise resolution chain

    See http://goo.gl/MqrFmX
`)},r=function(){return new k.PromiseInspection(this._target())},n=function(h){return k.reject(new y(h))};function o(){}var p={},f=oe(),u;f.isNode?u=function(){var h=process.domain;return h===void 0&&(h=null),h}:u=function(){return null},f.notEnumerableProp(k,"_getDomain",u);var a=Ue(),l=$a(),i=new l;a.defineProperty(k,"_async",{value:i});var s=Be(),y=k.TypeError=s.TypeError;k.RangeError=s.RangeError;var g=k.CancellationError=s.CancellationError;k.TimeoutError=s.TimeoutError,k.OperationalError=s.OperationalError,k.RejectionError=s.OperationalError,k.AggregateError=s.AggregateError;var c=function(){},v={},m={},E=Pa()(k,c),x=La()(k,c,E,n,o),F=Va()(k),H=F.create,M=Ua()(k,F);M.CapturedTrace;var L=Wa()(k,E),W=Xa()(m),X=Bn(),G=f.errorObj,te=f.tryCatch;function se(h,R){if(typeof R!="function")throw new y("expecting a function but got "+f.classString(R));if(h.constructor!==k)throw new y(`the promise constructor cannot be invoked directly

    See http://goo.gl/MqrFmX
`)}function k(h){this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,h!==c&&(se(this,h),this._resolveFromExecutor(h)),this._promiseCreated(),this._fireEvent("promiseCreated",this)}k.prototype.toString=function(){return"[object Promise]"},k.prototype.caught=k.prototype.catch=function(h){var R=arguments.length;if(R>1){var d=new Array(R-1),w=0,S;for(S=0;S<R-1;++S){var O=arguments[S];if(f.isObject(O))d[w++]=O;else return n("expecting an object but got A catch statement predicate "+f.classString(O))}return d.length=w,h=arguments[S],this.then(void 0,W(d,h,this))}return this.then(void 0,h)},k.prototype.reflect=function(){return this._then(r,r,void 0,this,void 0)},k.prototype.then=function(h,R){if(M.warnings()&&arguments.length>0&&typeof h!="function"&&typeof R!="function"){var d=".then() only accepts functions but was passed: "+f.classString(h);arguments.length>1&&(d+=", "+f.classString(R)),this._warn(d)}return this._then(h,R,void 0,void 0,void 0)},k.prototype.done=function(h,R){var d=this._then(h,R,void 0,void 0,void 0);d._setIsFinal()},k.prototype.spread=function(h){return typeof h!="function"?n("expecting a function but got "+f.classString(h)):this.all()._then(h,void 0,void 0,v,void 0)},k.prototype.toJSON=function(){var h={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(h.fulfillmentValue=this.value(),h.isFulfilled=!0):this.isRejected()&&(h.rejectionReason=this.reason(),h.isRejected=!0),h},k.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new x(this).promise()},k.prototype.error=function(h){return this.caught(f.originatesFromRejection,h)},k.getNewLibraryCopy=e.exports,k.is=function(h){return h instanceof k},k.fromNode=k.fromCallback=function(h){var R=new k(c);R._captureStackTrace();var d=arguments.length>1?!!Object(arguments[1]).multiArgs:!1,w=te(h)(X(R,d));return w===G&&R._rejectCallback(w.e,!0),R._isFateSealed()||R._setAsyncGuaranteed(),R},k.all=function(h){return new x(h).promise()},k.cast=function(h){var R=E(h);return R instanceof k||(R=new k(c),R._captureStackTrace(),R._setFulfilled(),R._rejectionHandler0=h),R},k.resolve=k.fulfilled=k.cast,k.reject=k.rejected=function(h){var R=new k(c);return R._captureStackTrace(),R._rejectCallback(h,!0),R},k.setScheduler=function(h){if(typeof h!="function")throw new y("expecting a function but got "+f.classString(h));return i.setScheduler(h)},k.prototype._then=function(h,R,d,w,S){var O=S!==void 0,D=O?S:new k(c),_=this._target(),$=_._bitField;O||(D._propagateFrom(this,3),D._captureStackTrace(),w===void 0&&this._bitField&2097152&&($&50397184?w=this._boundValue():w=_===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,D));var K=u();if($&50397184){var V,U,ne=_._settlePromiseCtx;$&33554432?(U=_._rejectionHandler0,V=h):$&16777216?(U=_._fulfillmentHandler0,V=R,_._unsetRejectionIsUnhandled()):(ne=_._settlePromiseLateCancellationObserver,U=new g("late cancellation observer"),_._attachExtraTrace(U),V=R),i.invoke(ne,_,{handler:K===null?V:typeof V=="function"&&f.domainBind(K,V),promise:D,receiver:w,value:U})}else _._addCallbacks(h,R,D,w,K);return D},k.prototype._length=function(){return this._bitField&65535},k.prototype._isFateSealed=function(){return(this._bitField&117506048)!==0},k.prototype._isFollowing=function(){return(this._bitField&67108864)===67108864},k.prototype._setLength=function(h){this._bitField=this._bitField&-65536|h&65535},k.prototype._setFulfilled=function(){this._bitField=this._bitField|33554432,this._fireEvent("promiseFulfilled",this)},k.prototype._setRejected=function(){this._bitField=this._bitField|16777216,this._fireEvent("promiseRejected",this)},k.prototype._setFollowing=function(){this._bitField=this._bitField|67108864,this._fireEvent("promiseResolved",this)},k.prototype._setIsFinal=function(){this._bitField=this._bitField|4194304},k.prototype._isFinal=function(){return(this._bitField&4194304)>0},k.prototype._unsetCancelled=function(){this._bitField=this._bitField&-65537},k.prototype._setCancelled=function(){this._bitField=this._bitField|65536,this._fireEvent("promiseCancelled",this)},k.prototype._setWillBeCancelled=function(){this._bitField=this._bitField|8388608},k.prototype._setAsyncGuaranteed=function(){i.hasCustomScheduler()||(this._bitField=this._bitField|134217728)},k.prototype._receiverAt=function(h){var R=h===0?this._receiver0:this[h*4-4+3];if(R!==p)return R===void 0&&this._isBound()?this._boundValue():R},k.prototype._promiseAt=function(h){return this[h*4-4+2]},k.prototype._fulfillmentHandlerAt=function(h){return this[h*4-4+0]},k.prototype._rejectionHandlerAt=function(h){return this[h*4-4+1]},k.prototype._boundValue=function(){},k.prototype._migrateCallback0=function(h){h._bitField;var R=h._fulfillmentHandler0,d=h._rejectionHandler0,w=h._promise0,S=h._receiverAt(0);S===void 0&&(S=p),this._addCallbacks(R,d,w,S,null)},k.prototype._migrateCallbackAt=function(h,R){var d=h._fulfillmentHandlerAt(R),w=h._rejectionHandlerAt(R),S=h._promiseAt(R),O=h._receiverAt(R);O===void 0&&(O=p),this._addCallbacks(d,w,S,O,null)},k.prototype._addCallbacks=function(h,R,d,w,S){var O=this._length();if(O>=65531&&(O=0,this._setLength(0)),O===0)this._promise0=d,this._receiver0=w,typeof h=="function"&&(this._fulfillmentHandler0=S===null?h:f.domainBind(S,h)),typeof R=="function"&&(this._rejectionHandler0=S===null?R:f.domainBind(S,R));else{var D=O*4-4;this[D+2]=d,this[D+3]=w,typeof h=="function"&&(this[D+0]=S===null?h:f.domainBind(S,h)),typeof R=="function"&&(this[D+1]=S===null?R:f.domainBind(S,R))}return this._setLength(O+1),O},k.prototype._proxy=function(h,R){this._addCallbacks(void 0,void 0,R,h,null)},k.prototype._resolveCallback=function(h,R){if(!(this._bitField&117506048)){if(h===this)return this._rejectCallback(t(),!1);var d=E(h,this);if(!(d instanceof k))return this._fulfill(h);R&&this._propagateFrom(d,2);var w=d._target();if(w===this){this._reject(t());return}var S=w._bitField;if(S&50397184)if(S&33554432)this._fulfill(w._value());else if(S&16777216)this._reject(w._reason());else{var _=new g("late cancellation observer");w._attachExtraTrace(_),this._reject(_)}else{var O=this._length();O>0&&w._migrateCallback0(this);for(var D=1;D<O;++D)w._migrateCallbackAt(this,D);this._setFollowing(),this._setLength(0),this._setFollowee(w)}}},k.prototype._rejectCallback=function(h,R,d){var w=f.ensureErrorObject(h),S=w===h;if(!S&&!d&&M.warnings()){var O="a promise was rejected with a non-error: "+f.classString(h);this._warn(O,!0)}this._attachExtraTrace(w,R?S:!1),this._reject(h)},k.prototype._resolveFromExecutor=function(h){var R=this;this._captureStackTrace(),this._pushContext();var d=!0,w=this._execute(h,function(S){R._resolveCallback(S)},function(S){R._rejectCallback(S,d)});d=!1,this._popContext(),w!==void 0&&R._rejectCallback(w,!0)},k.prototype._settlePromiseFromHandler=function(h,R,d,w){var S=w._bitField;if(!(S&65536)){w._pushContext();var O;R===v?!d||typeof d.length!="number"?(O=G,O.e=new y("cannot .spread() a non-array: "+f.classString(d))):O=te(h).apply(this._boundValue(),d):O=te(h).call(R,d);var D=w._popContext();S=w._bitField,!(S&65536)&&(O===m?w._reject(d):O===G?w._rejectCallback(O.e,!1):(M.checkForgottenReturns(O,D,"",w,this),w._resolveCallback(O)))}},k.prototype._target=function(){for(var h=this;h._isFollowing();)h=h._followee();return h},k.prototype._followee=function(){return this._rejectionHandler0},k.prototype._setFollowee=function(h){this._rejectionHandler0=h},k.prototype._settlePromise=function(h,R,d,w){var S=h instanceof k,O=this._bitField,D=(O&134217728)!==0;O&65536?(S&&h._invokeInternalOnCancel(),d instanceof L&&d.isFinallyHandler()?(d.cancelPromise=h,te(R).call(d,w)===G&&h._reject(G.e)):R===r?h._fulfill(r.call(d)):d instanceof o?d._promiseCancelled(h):S||h instanceof x?h._cancel():d.cancel()):typeof R=="function"?S?(D&&h._setAsyncGuaranteed(),this._settlePromiseFromHandler(R,d,w,h)):R.call(d,w,h):d instanceof o?d._isResolved()||(O&33554432?d._promiseFulfilled(w,h):d._promiseRejected(w,h)):S&&(D&&h._setAsyncGuaranteed(),O&33554432?h._fulfill(w):h._reject(w))},k.prototype._settlePromiseLateCancellationObserver=function(h){var R=h.handler,d=h.promise,w=h.receiver,S=h.value;typeof R=="function"?d instanceof k?this._settlePromiseFromHandler(R,w,S,d):R.call(w,S,d):d instanceof k&&d._reject(S)},k.prototype._settlePromiseCtx=function(h){this._settlePromise(h.promise,h.handler,h.receiver,h.value)},k.prototype._settlePromise0=function(h,R,d){var w=this._promise0,S=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(w,h,S,R)},k.prototype._clearCallbackDataAtIndex=function(h){var R=h*4-4;this[R+2]=this[R+3]=this[R+0]=this[R+1]=void 0},k.prototype._fulfill=function(h){var R=this._bitField;if(!((R&117506048)>>>16)){if(h===this){var d=t();return this._attachExtraTrace(d),this._reject(d)}this._setFulfilled(),this._rejectionHandler0=h,(R&65535)>0&&(R&134217728?this._settlePromises():i.settlePromises(this))}},k.prototype._reject=function(h){var R=this._bitField;if(!((R&117506048)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=h,this._isFinal())return i.fatalError(h,f.isNode);(R&65535)>0?i.settlePromises(this):this._ensurePossibleRejectionHandled()}},k.prototype._fulfillPromises=function(h,R){for(var d=1;d<h;d++){var w=this._fulfillmentHandlerAt(d),S=this._promiseAt(d),O=this._receiverAt(d);this._clearCallbackDataAtIndex(d),this._settlePromise(S,w,O,R)}},k.prototype._rejectPromises=function(h,R){for(var d=1;d<h;d++){var w=this._rejectionHandlerAt(d),S=this._promiseAt(d),O=this._receiverAt(d);this._clearCallbackDataAtIndex(d),this._settlePromise(S,w,O,R)}},k.prototype._settlePromises=function(){var h=this._bitField,R=h&65535;if(R>0){if(h&16842752){var d=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,d,h),this._rejectPromises(R,d)}else{var w=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,w,h),this._fulfillPromises(R,w)}this._setLength(0)}this._clearCancellationData()},k.prototype._settledValue=function(){var h=this._bitField;if(h&33554432)return this._rejectionHandler0;if(h&16777216)return this._fulfillmentHandler0};function N(h){this.promise._resolveCallback(h)}function q(h){this.promise._rejectCallback(h,!1)}k.defer=k.pending=function(){M.deprecated("Promise.defer","new Promise");var h=new k(c);return{promise:h,resolve:N,reject:q}},f.notEnumerableProp(k,"_makeSelfResolutionError",t),za()(k,c,E,n,M),Ga()(k,c,E,M),Qa()(k,x,n,M),Za()(k),Ka()(k),Ja()(k,x,E,c,i,u),k.Promise=k,k.version="3.4.7",Ya()(k,x,n,E,c,M),ei()(k),ti()(k,n,E,H,c,M),ri()(k,c,M),ni()(k,n,c,E,o,M),ai()(k),ii()(k,c),oi()(k,x,E,n),ui()(k,c,E,n),si()(k,x,n,E,c,M),li()(k,x,M),ci()(k,x,n),fi()(k,c),pi()(k,c),hi()(k),f.toFastProperties(k),f.toFastProperties(k.prototype);function Q(h){var R=new k(c);R._fulfillmentHandler0=h,R._rejectionHandler0=h,R._promise0=h,R._receiver0=h}return Q({a:1}),Q({b:2}),Q({c:3}),Q(1),Q(function(){}),Q(void 0),Q(!1),Q(new k(c)),M.setBounds(l.firstLineError,f.lastLineError),k}})(qn);var di=qn.exports,vi=he,we=di();de.defer=mi;de.when=we.resolve;de.resolve=we.resolve;de.all=we.all;de.props=we.props;de.reject=we.reject;de.promisify=we.promisify;de.mapSeries=we.mapSeries;de.attempt=we.attempt;de.nfcall=function(e){var t=Array.prototype.slice.call(arguments,1),r=we.promisify(e);return r.apply(null,t)};we.prototype.fail=we.prototype.caught;we.prototype.also=function(e){return this.then(function(t){var r=vi.extend({},t,e(t));return we.props(r)})};function mi(){var e,t,r=new we.Promise(function(n,o){e=n,t=o});return{resolve:e,reject:t,promise:r}}var ee={},yi=he,be=ee.types={document:"document",paragraph:"paragraph",run:"run",text:"text",tab:"tab",hyperlink:"hyperlink",noteReference:"noteReference",image:"image",note:"note",commentReference:"commentReference",comment:"comment",table:"table",tableRow:"tableRow",tableCell:"tableCell",break:"break",bookmarkStart:"bookmarkStart"};function _i(e,t){return t=t||{},{type:be.document,children:e,notes:t.notes||new pt({}),comments:t.comments||[]}}function gi(e,t){t=t||{};var r=t.indent||{};return{type:be.paragraph,children:e,styleId:t.styleId||null,styleName:t.styleName||null,numbering:t.numbering||null,alignment:t.alignment||null,indent:{start:r.start||null,end:r.end||null,firstLine:r.firstLine||null,hanging:r.hanging||null}}}function bi(e,t){return t=t||{},{type:be.run,children:e,styleId:t.styleId||null,styleName:t.styleName||null,isBold:!!t.isBold,isUnderline:!!t.isUnderline,isItalic:!!t.isItalic,isStrikethrough:!!t.isStrikethrough,isAllCaps:!!t.isAllCaps,isSmallCaps:!!t.isSmallCaps,verticalAlignment:t.verticalAlignment||Mn.baseline,font:t.font||null,fontSize:t.fontSize||null,highlight:t.highlight||null}}var Mn={baseline:"baseline",superscript:"superscript",subscript:"subscript"};function wi(e){return{type:be.text,value:e}}function Ei(){return{type:be.tab}}function Ti(e,t){return{type:be.hyperlink,children:e,href:t.href,anchor:t.anchor,targetFrame:t.targetFrame}}function Ci(e){return{type:be.noteReference,noteType:e.noteType,noteId:e.noteId}}function pt(e){this._notes=yi.indexBy(e,function(t){return Dn(t.noteType,t.noteId)})}pt.prototype.resolve=function(e){return this.findNoteByKey(Dn(e.noteType,e.noteId))};pt.prototype.findNoteByKey=function(e){return this._notes[e]||null};function ki(e){return{type:be.note,noteType:e.noteType,noteId:e.noteId,body:e.body}}function Ri(e){return{type:be.commentReference,commentId:e.commentId}}function Si(e){return{type:be.comment,commentId:e.commentId,body:e.body,authorName:e.authorName,authorInitials:e.authorInitials}}function Dn(e,t){return e+"-"+t}function Fi(e){return{type:be.image,read:function(t){return t?e.readImage(t):e.readImage().then(function(r){return Buffer.from(r)})},readAsArrayBuffer:function(){return e.readImage()},readAsBase64String:function(){return e.readImage("base64")},readAsBuffer:function(){return e.readImage().then(function(t){return Buffer.from(t)})},altText:e.altText,contentType:e.contentType}}function xi(e,t){return t=t||{},{type:be.table,children:e,styleId:t.styleId||null,styleName:t.styleName||null}}function Oi(e,t){return t=t||{},{type:be.tableRow,children:e,isHeader:t.isHeader||!1}}function ji(e,t){return t=t||{},{type:be.tableCell,children:e,colSpan:t.colSpan==null?1:t.colSpan,rowSpan:t.rowSpan==null?1:t.rowSpan}}function cr(e){return{type:be.break,breakType:e}}function Ii(e){return{type:be.bookmarkStart,name:e.name}}ee.document=ee.Document=_i;ee.paragraph=ee.Paragraph=gi;ee.run=ee.Run=bi;ee.text=ee.Text=wi;ee.tab=ee.Tab=Ei;ee.Hyperlink=Ti;ee.noteReference=ee.NoteReference=Ci;ee.Notes=pt;ee.Note=ki;ee.commentReference=Ri;ee.comment=Si;ee.Image=Fi;ee.Table=xi;ee.TableRow=Oi;ee.TableCell=ji;ee.lineBreak=cr("line");ee.pageBreak=cr("page");ee.columnBreak=cr("column");ee.BookmarkStart=Ii;ee.verticalAlignment=Mn;var Ee={},Ze=he;Ee.Result=Se;Ee.success=Ai;Ee.warning=Ni;Ee.error=qi;function Se(e,t){this.value=e,this.messages=t||[]}Se.prototype.map=function(e){return new Se(e(this.value),this.messages)};Se.prototype.flatMap=function(e){var t=e(this.value);return new Se(t.value,fr([this,t]))};Se.prototype.flatMapThen=function(e){var t=this;return e(this.value).then(function(r){return new Se(r.value,fr([t,r]))})};Se.combine=function(e){var t=Ze.flatten(Ze.pluck(e,"value")),r=fr(e);return new Se(t,r)};function Ai(e){return new Se(e,[])}function Ni(e){return{type:"warning",message:e}}function qi(e){return{type:"error",message:e.message,error:e}}function fr(e){var t=[];return Ze.flatten(Ze.pluck(e,"messages"),!0).forEach(function(r){Bi(t,r)||t.push(r)}),t}function Bi(e,t){return Ze.find(e,Mi.bind(null,t))!==void 0}function Mi(e,t){return e.type===t.type&&e.message===t.message}var Ye={},Di=Na,Hi=qa;Ye.openArrayBuffer=$i;Ye.splitPath=Pi;Ye.joinPath=Li;function $i(e){return Hi.loadAsync(e).then(function(t){function r(f){return t.file(f)!==null}function n(f,u){return t.file(f).async("uint8array").then(function(a){if(u==="base64")return Di.fromByteArray(a);if(u){var l=new TextDecoder(u);return l.decode(a)}else return a})}function o(f,u){t.file(f,u)}function p(){return t.generateAsync({type:"arraybuffer"})}return{exists:r,read:n,write:o,toArrayBuffer:p}})}function Pi(e){var t=e.lastIndexOf("/");return t===-1?{dirname:"",basename:e}:{dirname:e.substring(0,t),basename:e.substring(t+1)}}function Li(){var e=Array.prototype.filter.call(arguments,function(r){return r}),t=[];return e.forEach(function(r){/^\//.test(r)?t=[r]:t.push(r)}),t.join("/")}var pr={},He={},et={},ht=he;et.Element=We;et.element=function(e,t,r){return new We(e,t,r)};et.text=function(e){return{type:"text",value:e}};var Hn={first:function(){return null},firstOrEmpty:function(){return Hn},attributes:{}};function We(e,t,r){this.type="element",this.name=e,this.attributes=t||{},this.children=r||[]}We.prototype.first=function(e){return ht.find(this.children,function(t){return t.name===e})};We.prototype.firstOrEmpty=function(e){return this.first(e)||Hn};We.prototype.getElementsByTagName=function(e){var t=ht.filter(this.children,function(r){return r.name===e});return $n(t)};We.prototype.text=function(){if(this.children.length===0)return"";if(this.children.length!==1||this.children[0].type!=="text")throw new Error("Not implemented");return this.children[0].value};var Vi={getElementsByTagName:function(e){return $n(ht.flatten(this.map(function(t){return t.getElementsByTagName(e)},!0)))}};function $n(e){return ht.extend(e,Vi)}var Pn={},hr={},Ui=Aa,Wi=Ia;function Xi(e){var t=null,r=new Ui.DOMParser({errorHandler:function(o,p){t={level:o,message:p}}}),n=r.parseFromString(e);if(t===null)return n;throw new Error(t.level+": "+t.message)}hr.parseFromString=Xi;hr.Node=Wi.Node;var nr=de,ln=he,Ln=hr,Vn=et,zi=Vn.Element;Pn.readString=Gi;var cn=Ln.Node;function Gi(e,t){t=t||{};try{var r=Ln.parseFromString(e,"text/xml")}catch(f){return nr.reject(f)}if(r.documentElement.tagName==="parsererror")return nr.resolve(new Error(r.documentElement.textContent));function n(f){switch(f.nodeType){case cn.ELEMENT_NODE:return o(f);case cn.TEXT_NODE:return Vn.text(f.nodeValue)}}function o(f){var u=p(f),a=[];ln.forEach(f.childNodes,function(i){var s=n(i);s&&a.push(s)});var l={};return ln.forEach(f.attributes,function(i){l[p(i)]=i.value}),new zi(u,l,a)}function p(f){if(f.namespaceURI){var u=t[f.namespaceURI],a;return u?a=u+":":a="{"+f.namespaceURI+"}",a+f.localName}else return f.localName}return nr.resolve(n(r.documentElement))}var Un={},fn=he,Qi=Ba;Un.writeString=Zi;function Zi(e,t){var r=fn.invert(t),n={element:p,text:Ki};function o(a,l){return n[l.type](a,l)}function p(a,l){var i=a.element(f(l.name),l.attributes);l.children.forEach(function(s){o(i,s)})}function f(a){var l=/^\{(.*)\}(.*)$/.exec(a);if(l){var i=r[l[1]];return i+(i===""?"":":")+l[2]}else return a}function u(a){var l=Qi.create(f(a.name),{version:"1.0",encoding:"UTF-8",standalone:!0});return fn.forEach(t,function(i,s){var y="xmlns"+(s===""?"":":"+s);l.attribute(y,i)}),a.children.forEach(function(i){o(l,i)}),l.end()}return u(e)}function Ki(e,t){e.text(t.value)}var dr=et;He.Element=dr.Element;He.element=dr.element;He.text=dr.text;He.readString=Pn.readString;He.writeString=Un.writeString;var Ji=he,Yi=de,eo=He;pr.read=Wn;pr.readXmlFromZipFile=ro;var to={"http://schemas.openxmlformats.org/wordprocessingml/2006/main":"w","http://schemas.openxmlformats.org/officeDocument/2006/relationships":"r","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing":"wp","http://schemas.openxmlformats.org/drawingml/2006/main":"a","http://schemas.openxmlformats.org/drawingml/2006/picture":"pic","http://purl.oclc.org/ooxml/wordprocessingml/main":"w","http://purl.oclc.org/ooxml/officeDocument/relationships":"r","http://purl.oclc.org/ooxml/drawingml/wordprocessingDrawing":"wp","http://purl.oclc.org/ooxml/drawingml/main":"a","http://purl.oclc.org/ooxml/drawingml/picture":"pic","http://schemas.openxmlformats.org/package/2006/content-types":"content-types","http://schemas.openxmlformats.org/package/2006/relationships":"relationships","http://schemas.openxmlformats.org/markup-compatibility/2006":"mc","urn:schemas-microsoft-com:vml":"v","urn:schemas-microsoft-com:office:word":"office-word"};function Wn(e){return eo.readString(e,to).then(function(t){return Xn(t)[0]})}function ro(e,t){return e.exists(t)?e.read(t,"utf-8").then(no).then(Wn):Yi.resolve(null)}function no(e){return e.replace(/^\uFEFF/g,"")}function Xn(e){return e.type==="element"?e.name==="mc:AlternateContent"?e.first("mc:Fallback").children:(e.children=Ji.flatten(e.children.map(Xn,!0)),[e]):[e]}var vr={},mr={};mr.uriToZipEntryName=ao;mr.replaceFragment=io;function ao(e,t){return t.charAt(0)==="/"?t.substr(1):e+"/"+t}function io(e,t){var r=e.indexOf("#");return r!==-1&&(e=e.substring(0,r)),e+"#"+t}vr.createBodyReader=oo;vr._readNumberingProperties=Gn;var pn=Ma,ke=he,ce=ee,zn=Ee.Result,je=Ee.warning,hn=mr;function oo(e){return{readXmlElement:function(t){return new dn(e).readXmlElement(t)},readXmlElements:function(t){return new dn(e).readXmlElements(t)}}}function dn(e){var t=[],r=[],n=[],o=e.relationships,p=e.contentTypes,f=e.docxFile,u=e.files,a=e.numbering,l=e.styles;function i(T){var I=T.map(s);return vn(I)}function s(T){if(T.type==="element"){var I=Q[T.name];if(I)return I(T);if(!Object.prototype.hasOwnProperty.call(so,T.name)){var P=je("An unrecognised element was ignored: "+T.name);return Ge([P])}}return Qe()}function y(T){return x(T).map(function(I){return{type:"paragraphProperties",styleId:I.styleId,styleName:I.name,alignment:T.firstOrEmpty("w:jc").attributes["w:val"],numbering:Gn(I.styleId,T.firstOrEmpty("w:numPr"),a),indent:g(T.firstOrEmpty("w:ind"))}})}function g(T){return{start:T.attributes["w:start"]||T.attributes["w:left"],end:T.attributes["w:end"]||T.attributes["w:right"],firstLine:T.attributes["w:firstLine"],hanging:T.attributes["w:hanging"]}}function c(T){return F(T).map(function(I){var P=T.firstOrEmpty("w:sz").attributes["w:val"],Z=/^[0-9]+$/.test(P)?parseInt(P,10)/2:null;return{type:"runProperties",styleId:I.styleId,styleName:I.name,verticalAlignment:T.firstOrEmpty("w:vertAlign").attributes["w:val"],font:T.firstOrEmpty("w:rFonts").attributes["w:ascii"],fontSize:Z,isBold:m(T.first("w:b")),isUnderline:v(T.first("w:u")),isItalic:m(T.first("w:i")),isStrikethrough:m(T.first("w:strike")),isAllCaps:m(T.first("w:caps")),isSmallCaps:m(T.first("w:smallCaps")),highlight:E(T.firstOrEmpty("w:highlight").attributes["w:val"])}})}function v(T){if(T){var I=T.attributes["w:val"];return I!==void 0&&I!=="false"&&I!=="0"&&I!=="none"}else return!1}function m(T){if(T){var I=T.attributes["w:val"];return I!=="false"&&I!=="0"}else return!1}function E(T){return!T||T==="none"?null:T}function x(T){return M(T,"w:pStyle","Paragraph",l.findParagraphStyleById)}function F(T){return M(T,"w:rStyle","Run",l.findCharacterStyleById)}function H(T){return M(T,"w:tblStyle","Table",l.findTableStyleById)}function M(T,I,P,Z){var re=[],ae=T.first(I),_e=null,$e=null;if(ae&&(_e=ae.attributes["w:val"],_e)){var Pe=Z(_e);Pe?$e=Pe.name:re.push(ye(P,_e))}return nt({styleId:_e,name:$e},re)}var L={type:"unknown"};function W(T){var I=T.attributes["w:fldCharType"];if(I==="begin")t.push(L),r=[];else if(I==="end")t.pop();else if(I==="separate"){var P=G(r.join("")),Z=P===null?L:{type:"hyperlink",options:P};t.pop(),t.push(Z)}return Qe()}function X(){var T=ke.last(t.filter(function(I){return I.type==="hyperlink"}));return T?T.options:null}function G(T){var I=/\s*HYPERLINK "(.*)"/.exec(T);if(I)return{href:I[1]};var P=/\s*HYPERLINK\s+\\l\s+"(.*)"/.exec(T);return P?{anchor:P[1]}:null}function te(T){return r.push(T.text()),Qe()}function se(T){var I=T.attributes["w:font"],P=T.attributes["w:char"],Z=pn.hex(I,P);return Z==null&&/^F0..$/.test(P)&&(Z=pn.hex(I,P.substring(2))),Z==null?Ge([je("A w:sym element with an unsupported character was ignored: char "+P+" in font "+I)]):Te(new ce.Text(Z.string))}function k(T){return function(I){var P=I.attributes["w:id"];return Te(new ce.NoteReference({noteType:T,noteId:P}))}}function N(T){return Te(ce.commentReference({commentId:T.attributes["w:id"]}))}function q(T){return i(T.children)}var Q={"w:p":function(T){var I=T.firstOrEmpty("w:pPr"),P=!!I.firstOrEmpty("w:rPr").first("w:del");if(P)return T.children.forEach(function(re){n.push(re)}),Qe();var Z=T.children;return n.length>0&&(Z=n.concat(Z),n=[]),ve.map(y(I),i(Z),function(re,ae){return new ce.Paragraph(ae,re)}).insertExtra()},"w:r":function(T){return ve.map(c(T.firstOrEmpty("w:rPr")),i(T.children),function(I,P){var Z=X();return Z!==null&&(P=[new ce.Hyperlink(P,Z)]),new ce.Run(P,I)})},"w:fldChar":W,"w:instrText":te,"w:t":function(T){return Te(new ce.Text(T.text()))},"w:tab":function(T){return Te(new ce.Tab)},"w:noBreakHyphen":function(){return Te(new ce.Text(""))},"w:softHyphen":function(T){return Te(new ce.Text(""))},"w:sym":se,"w:hyperlink":function(T){var I=T.attributes["r:id"],P=T.attributes["w:anchor"];return i(T.children).map(function(Z){function re(_e){var $e=T.attributes["w:tgtFrame"]||null;return new ce.Hyperlink(Z,ke.extend({targetFrame:$e},_e))}if(I){var ae=o.findTargetByRelationshipId(I);return P&&(ae=hn.replaceFragment(ae,P)),re({href:ae})}else return P?re({anchor:P}):Z})},"w:tbl":h,"w:tr":d,"w:tc":w,"w:footnoteReference":k("footnote"),"w:endnoteReference":k("endnote"),"w:commentReference":N,"w:br":function(T){var I=T.attributes["w:type"];return I==null||I==="textWrapping"?Te(ce.lineBreak):I==="page"?Te(ce.pageBreak):I==="column"?Te(ce.columnBreak):Ge([je("Unsupported break type: "+I)])},"w:bookmarkStart":function(T){var I=T.attributes["w:name"];return I==="_GoBack"?Qe():Te(new ce.BookmarkStart({name:I}))},"mc:AlternateContent":function(T){return q(T.first("mc:Fallback"))},"w:sdt":function(T){return i(T.firstOrEmpty("w:sdtContent").children)},"w:ins":q,"w:object":q,"w:smartTag":q,"w:drawing":q,"w:pict":function(T){return q(T).toExtra()},"v:roundrect":q,"v:shape":q,"v:textbox":q,"w:txbxContent":q,"wp:inline":D,"wp:anchor":D,"v:imagedata":V,"v:group":q,"v:rect":q};return{readXmlElement:s,readXmlElements:i};function h(T){var I=R(T.firstOrEmpty("w:tblPr"));return i(T.children).flatMap(O).flatMap(function(P){return I.map(function(Z){return ce.Table(P,Z)})})}function R(T){return H(T).map(function(I){return{styleId:I.styleId,styleName:I.name}})}function d(T){var I=T.firstOrEmpty("w:trPr"),P=!!I.first("w:tblHeader");return i(T.children).map(function(Z){return ce.TableRow(Z,{isHeader:P})})}function w(T){return i(T.children).map(function(I){var P=T.firstOrEmpty("w:tcPr"),Z=P.firstOrEmpty("w:gridSpan").attributes["w:val"],re=Z?parseInt(Z,10):1,ae=ce.TableCell(I,{colSpan:re});return ae._vMerge=S(P),ae})}function S(T){var I=T.first("w:vMerge");if(I){var P=I.attributes["w:val"];return P==="continue"||!P}else return null}function O(T){var I=ke.any(T,function(re){return re.type!==ce.types.tableRow});if(I)return nt(T,[je("unexpected non-row element in table, cell merging may be incorrect")]);var P=ke.any(T,function(re){return ke.any(re.children,function(ae){return ae.type!==ce.types.tableCell})});if(P)return nt(T,[je("unexpected non-cell element in table row, cell merging may be incorrect")]);var Z={};return T.forEach(function(re){var ae=0;re.children.forEach(function(_e){_e._vMerge&&Z[ae]?Z[ae].rowSpan++:(Z[ae]=_e,_e._vMerge=!1),ae+=_e.colSpan})}),T.forEach(function(re){re.children=re.children.filter(function(ae){return!ae._vMerge}),re.children.forEach(function(ae){delete ae._vMerge})}),Te(T)}function D(T){var I=T.getElementsByTagName("a:graphic").getElementsByTagName("a:graphicData").getElementsByTagName("pic:pic").getElementsByTagName("pic:blipFill").getElementsByTagName("a:blip");return vn(I.map(_.bind(null,T)))}function _(T,I){var P=T.first("wp:docPr").attributes,Z=$(P.descr)?P.title:P.descr,re=K(I);return re===null?Ge([je("Could not find image file for a:blip element")]):ne(re,Z)}function $(T){return T==null||/^\s*$/.test(T)}function K(T){var I=T.attributes["r:embed"],P=T.attributes["r:link"];if(I)return U(I);if(P){var Z=o.findTargetByRelationshipId(P);return{path:Z,read:u.read.bind(u,Z)}}else return null}function V(T){var I=T.attributes["r:id"];return I?ne(U(I),T.attributes["o:title"]):Ge([je("A v:imagedata element without a relationship ID was ignored")])}function U(T){var I=hn.uriToZipEntryName("word",o.findTargetByRelationshipId(T));return{path:I,read:f.read.bind(f,I)}}function ne(T,I){var P=p.findContentType(T.path),Z=ce.Image({readImage:T.read,altText:I,contentType:P}),re=uo[P]?[]:je("Image of type "+P+" is unlikely to display in web browsers");return nt(Z,re)}function ye(T,I){return je(T+" style with ID "+I+" was referenced but not defined in the document")}}function Gn(e,t,r){var n=t.firstOrEmpty("w:ilvl").attributes["w:val"],o=t.firstOrEmpty("w:numId").attributes["w:val"];if(n!==void 0&&o!==void 0)return r.findLevel(o,n);if(e!=null){var p=r.findLevelByParagraphStyleId(e);if(p!=null)return p}return null}var uo={"image/png":!0,"image/gif":!0,"image/jpeg":!0,"image/svg+xml":!0,"image/tiff":!0},so={"office-word:wrap":!0,"v:shadow":!0,"v:shapetype":!0,"w:annotationRef":!0,"w:bookmarkEnd":!0,"w:sectPr":!0,"w:proofErr":!0,"w:lastRenderedPageBreak":!0,"w:commentRangeStart":!0,"w:commentRangeEnd":!0,"w:del":!0,"w:footnoteRef":!0,"w:endnoteRef":!0,"w:pPr":!0,"w:rPr":!0,"w:tblPr":!0,"w:tblGrid":!0,"w:trPr":!0,"w:tcPr":!0};function Ge(e){return new ve(null,null,e)}function Qe(){return new ve(null)}function Te(e){return new ve(e)}function nt(e,t){return new ve(e,null,t)}function ve(e,t,r){this.value=e||[],this.extra=t||[],this._result=new zn({element:this.value,extra:t},r),this.messages=this._result.messages}ve.prototype.toExtra=function(){return new ve(null,dt(this.extra,this.value),this.messages)};ve.prototype.insertExtra=function(){var e=this.extra;return e&&e.length?new ve(dt(this.value,e),null,this.messages):this};ve.prototype.map=function(e){var t=this._result.map(function(r){return e(r.element)});return new ve(t.value,this.extra,t.messages)};ve.prototype.flatMap=function(e){var t=this._result.flatMap(function(r){return e(r.element)._result});return new ve(t.value.element,dt(this.extra,t.value.extra),t.messages)};ve.map=function(e,t,r){return new ve(r(e.value,t.value),dt(e.extra,t.extra),e.messages.concat(t.messages))};function vn(e){var t=zn.combine(ke.pluck(e,"_result"));return new ve(ke.flatten(ke.pluck(t.value,"element")),ke.filter(ke.flatten(ke.pluck(t.value,"extra")),lo),t.messages)}function dt(e,t){return ke.flatten([e,t])}function lo(e){return e}var Qn={};Qn.DocumentXmlReader=po;var co=ee,fo=Ee.Result;function po(e){var t=e.bodyReader;function r(n){var o=n.first("w:body");if(o==null)throw new Error("Could not find the body element: are you sure this is a docx file?");var p=t.readXmlElements(o.children).map(function(f){return new co.Document(f,{notes:e.notes,comments:e.comments})});return new fo(p.value,p.messages)}return{convertXmlToDocument:r}}var vt={};vt.readRelationships=ho;vt.defaultValue=new yr([]);vt.Relationships=yr;function ho(e){var t=[];return e.children.forEach(function(r){if(r.name==="relationships:Relationship"){var n={relationshipId:r.attributes.Id,target:r.attributes.Target,type:r.attributes.Type};t.push(n)}}),new yr(t)}function yr(e){var t={};e.forEach(function(n){t[n.relationshipId]=n.target});var r={};return e.forEach(function(n){r[n.type]||(r[n.type]=[]),r[n.type].push(n.target)}),{findTargetByRelationshipId:function(n){return t[n]},findTargetsByType:function(n){return r[n]||[]}}}var _r={};_r.readContentTypesFromXml=mo;var vo={png:"png",gif:"gif",jpeg:"jpeg",jpg:"jpeg",tif:"tiff",tiff:"tiff",bmp:"bmp"};_r.defaultContentTypes=Zn({},{});function mo(e){var t={},r={};return e.children.forEach(function(n){if(n.name==="content-types:Default"&&(t[n.attributes.Extension]=n.attributes.ContentType),n.name==="content-types:Override"){var o=n.attributes.PartName;o.charAt(0)==="/"&&(o=o.substring(1)),r[o]=n.attributes.ContentType}}),Zn(r,t)}function Zn(e,t){return{findContentType:function(r){var n=e[r];if(n)return n;var o=r.split("."),p=o[o.length-1];if(t.hasOwnProperty(p))return t[p];var f=vo[p.toLowerCase()];return f?"image/"+f:null}}}var mt={},at=he;mt.readNumberingXml=yo;mt.Numbering=gr;mt.defaultNumbering=new gr({},{});function gr(e,t,r){var n=at.flatten(at.values(t).map(function(u){return at.values(u.levels)})),o=at.indexBy(n.filter(function(u){return u.paragraphStyleId!=null}),"paragraphStyleId");function p(u,a){var l=e[u];if(l){var i=t[l.abstractNumId];if(i){if(i.numStyleLink==null)return t[l.abstractNumId].levels[a];var s=r.findNumberingStyleById(i.numStyleLink);return p(s.numId,a)}else return null}else return null}function f(u){return o[u]||null}return{findLevel:p,findLevelByParagraphStyleId:f}}function yo(e,t){if(!t||!t.styles)throw new Error("styles is missing");var r=_o(e),n=bo(e);return new gr(n,r,t.styles)}function _o(e){var t={};return e.getElementsByTagName("w:abstractNum").forEach(function(r){var n=r.attributes["w:abstractNumId"];t[n]=go(r)}),t}function go(e){var t={};e.getElementsByTagName("w:lvl").forEach(function(n){var o=n.attributes["w:ilvl"],p=n.firstOrEmpty("w:numFmt").attributes["w:val"],f=n.firstOrEmpty("w:pStyle").attributes["w:val"];t[o]={isOrdered:p!=="bullet",level:o,paragraphStyleId:f}});var r=e.firstOrEmpty("w:numStyleLink").attributes["w:val"];return{levels:t,numStyleLink:r}}function bo(e){var t={};return e.getElementsByTagName("w:num").forEach(function(r){var n=r.attributes["w:numId"],o=r.first("w:abstractNumId").attributes["w:val"];t[n]={abstractNumId:o}}),t}var yt={};yt.readStylesXml=wo;yt.Styles=Ke;yt.defaultStyles=new Ke({},{});function Ke(e,t,r,n){return{findParagraphStyleById:function(o){return e[o]},findCharacterStyleById:function(o){return t[o]},findTableStyleById:function(o){return r[o]},findNumberingStyleById:function(o){return n[o]}}}Ke.EMPTY=new Ke({},{},{},{});function wo(e){var t={},r={},n={},o={},p={paragraph:t,character:r,table:n};return e.getElementsByTagName("w:style").forEach(function(f){var u=Eo(f);if(u.type==="numbering")o[u.styleId]=Co(f);else{var a=p[u.type];a&&(a[u.styleId]=u)}}),new Ke(t,r,n,o)}function Eo(e){var t=e.attributes["w:type"],r=e.attributes["w:styleId"],n=To(e);return{type:t,styleId:r,name:n}}function To(e){var t=e.first("w:name");return t?t.attributes["w:val"]:null}function Co(e){var t=e.firstOrEmpty("w:pPr").firstOrEmpty("w:numPr").firstOrEmpty("w:numId").attributes["w:val"];return{numId:t}}var br={},ko=ee,Ro=Ee.Result;br.createFootnotesReader=Kn.bind(qe,"footnote");br.createEndnotesReader=Kn.bind(qe,"endnote");function Kn(e,t){function r(p){return Ro.combine(p.getElementsByTagName("w:"+e).filter(n).map(o))}function n(p){var f=p.attributes["w:type"];return f!=="continuationSeparator"&&f!=="separator"}function o(p){var f=p.attributes["w:id"];return t.readXmlElements(p.children).map(function(u){return ko.Note({noteType:e,noteId:f,body:u})})}return r}var Jn={},So=ee,Fo=Ee.Result;function xo(e){function t(n){return Fo.combine(n.getElementsByTagName("w:comment").map(r))}function r(n){var o=n.attributes["w:id"];function p(f){return(n.attributes[f]||"").trim()||null}return e.readXmlElements(n.children).map(function(f){return So.comment({commentId:o,body:f,authorName:p("w:author"),authorInitials:p("w:initials")})})}return t}Jn.createCommentsReader=xo;var Yn={},Oo=de;Yn.Files=jo;function jo(){function e(t){return Oo.reject(new Error("could not open external image: '"+t+`'
cannot open linked files from a web browser`))}return{read:e}}lr.read=Mo;lr._findPartPaths=ta;var Io=de,Ao=ee,ar=Ee.Result,lt=Ye,ea=pr.readXmlFromZipFile,No=vr.createBodyReader,qo=Qn.DocumentXmlReader,Ve=vt,mn=_r,yn=mt,_n=yt,gn=br,Bo=Jn,bn=Yn.Files;function Mo(e,t){return t=t||{},Io.props({contentTypes:Ho(e),partPaths:ta(e),docxFile:e,files:t.path?bn.relativeToFile(t.path):new bn(null)}).also(function(r){return{styles:Po(e,r.partPaths.styles)}}).also(function(r){return{numbering:$o(e,r.partPaths.numbering,r.styles)}}).also(function(r){return{footnotes:it(r.partPaths.footnotes,r,function(n,o){return o?gn.createFootnotesReader(n)(o):new ar([])}),endnotes:it(r.partPaths.endnotes,r,function(n,o){return o?gn.createEndnotesReader(n)(o):new ar([])}),comments:it(r.partPaths.comments,r,function(n,o){return o?Bo.createCommentsReader(n)(o):new ar([])})}}).also(function(r){return{notes:r.footnotes.flatMap(function(n){return r.endnotes.map(function(o){return new Ao.Notes(n.concat(o))})})}}).then(function(r){return it(r.partPaths.mainDocument,r,function(n,o){return r.notes.flatMap(function(p){return r.comments.flatMap(function(f){var u=new qo({bodyReader:n,notes:p,comments:f});return u.convertXmlToDocument(o)})})})})}function ta(e){return Lo(e).then(function(t){var r=wn({docxFile:e,relationships:t,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",basePath:"",fallbackPath:"word/document.xml"});if(!e.exists(r))throw new Error("Could not find main document part. Are you sure this is a valid .docx file?");return Xe({filename:ra(r),readElement:Ve.readRelationships,defaultValue:Ve.defaultValue})(e).then(function(n){function o(p){return wn({docxFile:e,relationships:n,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/"+p,basePath:lt.splitPath(r).dirname,fallbackPath:"word/"+p+".xml"})}return{mainDocument:r,comments:o("comments"),endnotes:o("endnotes"),footnotes:o("footnotes"),numbering:o("numbering"),styles:o("styles")}})})}function wn(e){var t=e.docxFile,r=e.relationships,n=e.relationshipType,o=e.basePath,p=e.fallbackPath,f=r.findTargetsByType(n),u=f.map(function(l){return Do(lt.joinPath(o,l),"/")}),a=u.filter(function(l){return t.exists(l)});return a.length===0?p:a[0]}function Do(e,t){return e.substring(0,t.length)===t?e.substring(t.length):e}function Xe(e){return function(t){return ea(t,e.filename).then(function(r){return r?e.readElement(r):e.defaultValue})}}function it(e,t,r){var n=Xe({filename:ra(e),readElement:Ve.readRelationships,defaultValue:Ve.defaultValue});return n(t.docxFile).then(function(o){var p=new No({relationships:o,contentTypes:t.contentTypes,docxFile:t.docxFile,numbering:t.numbering,styles:t.styles,files:t.files});return ea(t.docxFile,e).then(function(f){return r(p,f)})})}function ra(e){var t=lt.splitPath(e);return lt.joinPath(t.dirname,"_rels",t.basename+".rels")}var Ho=Xe({filename:"[Content_Types].xml",readElement:mn.readContentTypesFromXml,defaultValue:mn.defaultContentTypes});function $o(e,t,r){return Xe({filename:t,readElement:function(n){return yn.readNumberingXml(n,{styles:r})},defaultValue:yn.defaultNumbering})(e)}function Po(e,t){return Xe({filename:t,readElement:_n.readStylesXml,defaultValue:_n.defaultStyles})(e)}var Lo=Xe({filename:"_rels/.rels",readElement:Ve.readRelationships,defaultValue:Ve.defaultValue}),wr={},Vo=he,Uo=de,Je=He;wr.writeStyleMap=Xo;wr.readStyleMap=Qo;var Wo="http://schemas.zwobble.org/mammoth/style-map",ct="mammoth/style-map",na="/"+ct;function Xo(e,t){return e.write(ct,t),zo(e).then(function(){return Go(e)})}function zo(e){var t="word/_rels/document.xml.rels",r="http://schemas.openxmlformats.org/package/2006/relationships",n="{"+r+"}Relationship";return e.read(t,"utf8").then(Je.readString).then(function(o){var p=o.children;aa(p,n,"Id",{Id:"rMammothStyleMap",Type:Wo,Target:na});var f={"":r};return e.write(t,Je.writeString(o,f))})}function Go(e){var t="[Content_Types].xml",r="http://schemas.openxmlformats.org/package/2006/content-types",n="{"+r+"}Override";return e.read(t,"utf8").then(Je.readString).then(function(o){var p=o.children;aa(p,n,"PartName",{PartName:na,ContentType:"text/prs.mammoth.style-map"});var f={"":r};return e.write(t,Je.writeString(o,f))})}function aa(e,t,r,n){var o=Vo.find(e,function(p){return p.name===t&&p.attributes[r]===n[r]});o?o.attributes=n:e.push(Je.element(t,n))}function Qo(e){return e.exists(ct)?e.read(ct,"utf8"):Uo.resolve(null)}var Er={},De={},Ie={},Ae={},En;function ia(){if(En)return Ae;En=1;var e=gt();function t(a,l,i){return n(e.element(a,l,{fresh:!1}),i)}function r(a,l,i){var s=e.element(a,l,{fresh:!0});return n(s,i)}function n(a,l){return{type:"element",tag:a,children:l||[]}}function o(a){return{type:"text",value:a}}var p={type:"forceWrite"};Ae.freshElement=r,Ae.nonFreshElement=t,Ae.elementWithTag=n,Ae.text=o,Ae.forceWrite=p;var f={br:!0,hr:!0,img:!0};function u(a){return a.children.length===0&&f[a.tag.tagName]}return Ae.isVoidElement=u,Ae}var ir,Tn;function Zo(){if(Tn)return ir;Tn=1;var e=he,t=ia();function r(v){return n(l(v))}function n(v){var m=[];return v.map(o).forEach(function(E){a(m,E)}),m}function o(v){return p[v.type](v)}var p={element:f,text:u,forceWrite:u};function f(v){return t.elementWithTag(v.tag,n(v.children))}function u(v){return v}function a(v,m){var E=v[v.length-1];m.type==="element"&&!m.tag.fresh&&E&&E.type==="element"&&m.tag.matchesElement(E.tag)?(m.tag.separator&&a(E.children,t.text(m.tag.separator)),m.children.forEach(function(x){a(E.children,x)})):v.push(m)}function l(v){return i(v,function(m){return s[m.type](m)})}function i(v,m){return e.flatten(e.map(v,m),!0)}var s={element:g,text:c,forceWrite:y};function y(v){return[v]}function g(v){var m=l(v.children);return m.length===0&&!t.isVoidElement(v)?[]:[t.elementWithTag(v.tag,m)]}function c(v){return v.value.length===0?[]:[v]}return ir=r,ir}var Cn;function _t(){if(Cn)return Ie;Cn=1;var e=ia();Ie.freshElement=e.freshElement,Ie.nonFreshElement=e.nonFreshElement,Ie.elementWithTag=e.elementWithTag,Ie.text=e.text,Ie.forceWrite=e.forceWrite,Ie.simplify=Zo();function t(f,u){u.forEach(function(a){r(f,a)})}function r(f,u){n[u.type](f,u)}var n={element:o,text:p,forceWrite:function(){}};function o(f,u){e.isVoidElement(u)?f.selfClosing(u.tag.tagName,u.tag.attributes):(f.open(u.tag.tagName,u.tag.attributes),t(f,u.children),f.close(u.tag.tagName))}function p(f,u){f.text(u.value)}return Ie.write=t,Ie}var kn;function gt(){if(kn)return De;kn=1;var e=he,t=_t();De.topLevelElement=r,De.elements=n,De.element=p;function r(u,a){return n([p(u,a,{fresh:!0})])}function n(u){return new o(u.map(function(a){return e.isString(a)?p(a):a}))}function o(u){this._elements=u}o.prototype.wrap=function(a){for(var l=a(),i=this._elements.length-1;i>=0;i--)l=this._elements[i].wrapNodes(l);return l};function p(u,a,l){return l=l||{},new f(u,a,l)}function f(u,a,l){var i={};e.isArray(u)?(u.forEach(function(s){i[s]=!0}),u=u[0]):i[u]=!0,this.tagName=u,this.tagNames=i,this.attributes=a||{},this.fresh=l.fresh,this.separator=l.separator}return f.prototype.matchesElement=function(u){return this.tagNames[u.tagName]&&e.isEqual(this.attributes||{},u.attributes||{})},f.prototype.wrap=function(a){return this.wrapNodes(a())},f.prototype.wrapNodes=function(a){return[t.elementWithTag(this,a)]},De.empty=n([]),De.ignore={wrap:function(){return[]}},De}var Tr={};(function(e){var t=he,r=de,n=_t();e.imgElement=o;function o(p){return function(f,u){return r.when(p(f)).then(function(a){var l={};return f.altText&&(l.alt=f.altText),t.extend(l,a),[n.freshElement("img",l)]})}}e.inline=e.imgElement,e.dataUri=o(function(p){return p.readAsBase64String().then(function(f){return{src:"data:"+p.contentType+";base64,"+f}})})})(Tr);var oa={},ua={},sa=he;ua.writer=Ko;function Ko(e){return e=e||{},e.prettyPrint?Jo():la()}var ot={div:!0,p:!0,ul:!0,li:!0};function Jo(){var e=0,t="  ",r=[],n=!0,o=!1,p=la();function f(c,v){ot[c]&&y(),r.push(c),p.open(c,v),ot[c]&&e++,n=!1}function u(c){ot[c]&&(e--,y()),r.pop(),p.close(c)}function a(c){s();var v=g()?c:c.replace(`
`,`
`+t);p.text(v)}function l(c,v){y(),p.selfClosing(c,v)}function i(){return r.length===0||ot[r[r.length-1]]}function s(){o||(y(),o=!0)}function y(){if(o=!1,!n&&i()&&!g()){p._append(`
`);for(var c=0;c<e;c++)p._append(t)}}function g(){return sa.some(r,function(c){return c==="pre"})}return{asString:p.asString,open:f,close:u,text:a,selfClosing:l}}function la(){var e=[];function t(a,l){var i=o(l);e.push("<"+a+i+">")}function r(a){e.push("</"+a+">")}function n(a,l){var i=o(l);e.push("<"+a+i+" />")}function o(a){return sa.map(a,function(l,i){return" "+i+'="'+eu(l)+'"'}).join("")}function p(a){e.push(Yo(a))}function f(a){e.push(a)}function u(){return e.join("")}return{asString:u,open:t,close:r,text:p,selfClosing:n,_append:f}}function Yo(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function eu(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var ca={},tu=he;function Rn(e){return ft(e,e)}function ft(e,t){return function(){return{start:e,end:t}}}function ru(e){var t=e.href||"";return t?{start:"[",end:"]("+t+")",anchorPosition:"before"}:{}}function nu(e){var t=e.src||"",r=e.alt||"";return t||r?{start:"!["+r+"]("+t+")"}:{}}function Sn(e){return function(t,r){return{start:r?`
`:"",end:r?"":`
`,list:{isOrdered:e.isOrdered,indent:r?r.indent+1:0,count:0}}}}function au(e,t,r){t=t||{indent:0,isOrdered:!1,count:0},t.count++,r.hasClosed=!1;var n=t.isOrdered?t.count+".":"-",o=pa("	",t.indent)+n+" ";return{start:o,end:function(){if(!r.hasClosed)return r.hasClosed=!0,`
`}}}var fa={p:ft("",`

`),br:ft("",`  
`),ul:Sn({isOrdered:!1}),ol:Sn({isOrdered:!0}),li:au,strong:Rn("__"),em:Rn("*"),a:ru,img:nu};(function(){for(var e=1;e<=6;e++)fa["h"+e]=ft(pa("#",e)+" ",`

`)})();function pa(e,t){return new Array(t+1).join(e)}function iu(){var e=[],t=[],r=null,n={};function o(i,s){s=s||{};var y=fa[i]||function(){return{}},g=y(s,r,n);t.push({end:g.end,list:r}),g.list&&(r=g.list);var c=g.anchorPosition==="before";c&&p(s),e.push(g.start||""),c||p(s)}function p(i){i.id&&e.push('<a id="'+i.id+'"></a>')}function f(i){var s=t.pop();r=s.list;var y=tu.isFunction(s.end)?s.end():s.end;e.push(y||"")}function u(i,s){o(i,s),f()}function a(i){e.push(ou(i))}function l(){return e.join("")}return{asString:l,open:o,close:f,text:a,selfClosing:u}}ca.writer=iu;function ou(e){return e.replace(/\\/g,"\\\\").replace(/([\`\*_\{\}\[\]\(\)\#\+\-\.\!])/g,"\\$1")}var uu=ua,su=ca;oa.writer=lu;function lu(e){return e=e||{},e.outputFormat==="markdown"?su.writer():uu.writer(e)}var Ne=he,Fn=de,ut=ee,Ce=gt(),sr=Ee,cu=Tr,Y=_t(),fu=oa;Er.DocumentConverter=pu;function pu(e){return{convertToHtml:function(t){var r=Ne.indexBy(t.type===ut.types.document?t.comments:[],"commentId"),n=new hu(e,r);return n.convertToHtml(t)}}}function hu(e,t){var r=1,n=[],o=[];e=Ne.extend({ignoreEmptyParagraphs:!0},e);var p=e.idPrefix===void 0?"":e.idPrefix,f=e.ignoreEmptyParagraphs,u=Ce.topLevelElement("p"),a=e.styleMap||[];function l(d){var w=[],S=s(d,w,{}),O=[];ha(S,function(_){_.type==="deferred"&&O.push(_)});var D={};return Fn.mapSeries(O,function(_){return _.value().then(function($){D[_.id]=$})}).then(function(){function _(K){return or(K,function(V){return V.type==="deferred"?D[V.id]:V.children?[Ne.extend({},V,{children:_(V.children)})]:[V]})}var $=fu.writer({prettyPrint:e.prettyPrint,outputFormat:e.outputFormat});return Y.write($,Y.simplify(_(S))),new sr.Result($.asString(),w)})}function i(d,w,S){return or(d,function(O){return s(O,w,S)})}function s(d,w,S){if(!S)throw new Error("options not set");var O=R[d.type];return O?O(d,w,S):[]}function y(d,w,S){return g(d,w).wrap(function(){var O=i(d.children,w,S);return f?O:[Y.forceWrite].concat(O)})}function g(d,w){var S=E(d);return S?S.to:(d.styleId&&w.push(xn("paragraph",d)),u)}function c(d,w,S){var O=function(){return i(d.children,w,S)},D=[];if(d.highlight!==null){var _=m({type:"highlight",color:d.highlight});_&&D.push(_)}d.isSmallCaps&&D.push(v("smallCaps")),d.isAllCaps&&D.push(v("allCaps")),d.isStrikethrough&&D.push(v("strikethrough","s")),d.isUnderline&&D.push(v("underline")),d.verticalAlignment===ut.verticalAlignment.subscript&&D.push(Ce.element("sub",{},{fresh:!1})),d.verticalAlignment===ut.verticalAlignment.superscript&&D.push(Ce.element("sup",{},{fresh:!1})),d.isItalic&&D.push(v("italic","em")),d.isBold&&D.push(v("bold","strong"));var $=Ce.empty,K=E(d);return K?$=K.to:d.styleId&&w.push(xn("run",d)),D.push($),D.forEach(function(V){O=V.wrap.bind(V,O)}),O()}function v(d,w){var S=m({type:d});return S||(w?Ce.element(w,{},{fresh:!1}):Ce.empty)}function m(d,w){var S=E(d);return S?S.to:w}function E(d){for(var w=0;w<a.length;w++)if(a[w].from.matches(d))return a[w]}function x(d){return function(w,S){return Fn.attempt(function(){return d(w,S)}).caught(function(O){return S.push(sr.error(O)),[]})}}function F(d){return M(d.noteType,d.noteId)}function H(d){return L(d.noteType,d.noteId)}function M(d,w){return W(d+"-"+w)}function L(d,w){return W(d+"-ref-"+w)}function W(d){return p+d}var X=Ce.elements([Ce.element("table",{},{fresh:!0})]);function G(d,w,S){return m(d,X).wrap(function(){return te(d,w,S)})}function te(d,w,S){var O=Ne.findIndex(d.children,function(K){return!K.type===ut.types.tableRow||!K.isHeader});O===-1&&(O=d.children.length);var D;if(O===0)D=i(d.children,w,Ne.extend({},S,{isTableHeader:!1}));else{var _=i(d.children.slice(0,O),w,Ne.extend({},S,{isTableHeader:!0})),$=i(d.children.slice(O),w,Ne.extend({},S,{isTableHeader:!1}));D=[Y.freshElement("thead",{},_),Y.freshElement("tbody",{},$)]}return[Y.forceWrite].concat(D)}function se(d,w,S){var O=i(d.children,w,S);return[Y.freshElement("tr",{},[Y.forceWrite].concat(O))]}function k(d,w,S){var O=S.isTableHeader?"th":"td",D=i(d.children,w,S),_={};return d.colSpan!==1&&(_.colspan=d.colSpan.toString()),d.rowSpan!==1&&(_.rowspan=d.rowSpan.toString()),[Y.freshElement(O,_,[Y.forceWrite].concat(D))]}function N(d,w,S){return m(d,Ce.ignore).wrap(function(){var O=t[d.commentId],D=o.length+1,_="["+mu(O)+D+"]";return o.push({label:_,comment:O}),[Y.freshElement("a",{href:"#"+M("comment",d.commentId),id:L("comment",d.commentId)},[Y.text(_)])]})}function q(d,w,S){var O=d.label,D=d.comment,_=i(D.body,w,S).concat([Y.nonFreshElement("p",{},[Y.text(" "),Y.freshElement("a",{href:"#"+L("comment",D.commentId)},[Y.text("")])])]);return[Y.freshElement("dt",{id:M("comment",D.commentId)},[Y.text("Comment "+O)]),Y.freshElement("dd",{},_)]}function Q(d,w,S){return h(d).wrap(function(){return[]})}function h(d){var w=E(d);return w?w.to:d.breakType==="line"?Ce.topLevelElement("br"):Ce.empty}var R={document:function(d,w,S){var O=i(d.children,w,S),D=n.map(function($){return d.notes.resolve($)}),_=i(D,w,S);return O.concat([Y.freshElement("ol",{},_),Y.freshElement("dl",{},or(o,function($){return q($,w,S)}))])},paragraph:y,run:c,text:function(d,w,S){return[Y.text(d.value)]},tab:function(d,w,S){return[Y.text("	")]},hyperlink:function(d,w,S){var O=d.anchor?"#"+W(d.anchor):d.href,D={href:O};d.targetFrame!=null&&(D.target=d.targetFrame);var _=i(d.children,w,S);return[Y.nonFreshElement("a",D,_)]},bookmarkStart:function(d,w,S){var O=Y.freshElement("a",{id:W(d.name)},[Y.forceWrite]);return[O]},noteReference:function(d,w,S){n.push(d);var O=Y.freshElement("a",{href:"#"+F(d),id:H(d)},[Y.text("["+r+++"]")]);return[Y.freshElement("sup",{},[O])]},note:function(d,w,S){var O=i(d.body,w,S),D=Y.elementWithTag(Ce.element("p",{},{fresh:!1}),[Y.text(" "),Y.freshElement("a",{href:"#"+H(d)},[Y.text("")])]),_=O.concat([D]);return Y.freshElement("li",{id:F(d)},_)},commentReference:N,comment:q,image:vu(x(e.convertImage||cu.dataUri)),table:G,tableRow:se,tableCell:k,break:Q};return{convertToHtml:l}}var du=1;function vu(e){return function(t,r,n){return[{type:"deferred",id:du++,value:function(){return e(t,r,n)}}]}}function xn(e,t){return sr.warning("Unrecognised "+e+" style: '"+t.styleName+"' (Style ID: "+t.styleId+")")}function or(e,t){return Ne.flatten(e.map(t),!0)}function ha(e,t){e.forEach(function(r){t(r),r.children&&ha(r.children,t)})}var mu=Er.commentAuthorLabel=function(t){return t.authorInitials||""},da={},yu=ee;function va(e){if(e.type==="text")return e.value;if(e.type===yu.types.tab)return"	";var t=e.type==="paragraph"?`

`:"";return(e.children||[]).map(va).join("")+t}da.convertElementToRawText=va;var bt={},me={};me.paragraph=_u;me.run=gu;me.table=bu;me.bold=new Re("bold");me.italic=new Re("italic");me.underline=new Re("underline");me.strikethrough=new Re("strikethrough");me.allCaps=new Re("allCaps");me.smallCaps=new Re("smallCaps");me.highlight=wu;me.commentReference=new Re("commentReference");me.lineBreak=new wt({breakType:"line"});me.pageBreak=new wt({breakType:"page"});me.columnBreak=new wt({breakType:"column"});me.equalTo=Tu;me.startsWith=Cu;function _u(e){return new Re("paragraph",e)}function gu(e){return new Re("run",e)}function bu(e){return new Re("table",e)}function wu(e){return new ma(e)}function Re(e,t){t=t||{},this._elementType=e,this._styleId=t.styleId,this._styleName=t.styleName,t.list&&(this._listIndex=t.list.levelIndex,this._listIsOrdered=t.list.isOrdered)}Re.prototype.matches=function(e){return e.type===this._elementType&&(this._styleId===void 0||e.styleId===this._styleId)&&(this._styleName===void 0||e.styleName&&this._styleName.operator(this._styleName.operand,e.styleName))&&(this._listIndex===void 0||Eu(e,this._listIndex,this._listIsOrdered))&&(this._breakType===void 0||this._breakType===e.breakType)};function ma(e){e=e||{},this._color=e.color}ma.prototype.matches=function(e){return e.type==="highlight"&&(this._color===void 0||e.color===this._color)};function wt(e){e=e||{},this._breakType=e.breakType}wt.prototype.matches=function(e){return e.type==="break"&&(this._breakType===void 0||e.breakType===this._breakType)};function Eu(e,t,r){return e.numbering&&e.numbering.level==t&&e.numbering.isOrdered==r}function Tu(e){return{operator:ku,operand:e}}function Cu(e){return{operator:Ru,operand:e}}function ku(e,t){return e.toUpperCase()===t.toUpperCase()}function Ru(e,t){return t.toUpperCase().indexOf(e.toUpperCase())===0}var ya={},Su=Nn,Fu=Su.RegexTokeniser;ya.tokenise=xu;var On="'((?:\\\\.|[^'])*)";function xu(e){var t="(?:[a-zA-Z\\-_]|\\\\.)",r=new Fu([{name:"identifier",regex:new RegExp("("+t+"(?:"+t+"|[0-9])*)")},{name:"dot",regex:/\./},{name:"colon",regex:/:/},{name:"gt",regex:/>/},{name:"whitespace",regex:/\s+/},{name:"arrow",regex:/=>/},{name:"equals",regex:/=/},{name:"startsWith",regex:/\^=/},{name:"open-paren",regex:/\(/},{name:"close-paren",regex:/\)/},{name:"open-square-bracket",regex:/\[/},{name:"close-square-bracket",regex:/\]/},{name:"string",regex:new RegExp(On+"'")},{name:"unterminated-string",regex:new RegExp(On)},{name:"integer",regex:/([0-9]+)/},{name:"choice",regex:/\|/},{name:"bang",regex:/(!)/}]);return r.tokenise(e)}var Ou=he,j=Nn,ge=me,st=gt(),ju=ya.tokenise,ur=Ee;bt.readHtmlPath=qu;bt.readDocumentMatcher=Nu;bt.readStyle=Iu;function Iu(e){return Cr(Vu,e)}function Au(){return j.rules.sequence(j.rules.sequence.capture(_a()),j.rules.tokenOfType("whitespace"),j.rules.tokenOfType("arrow"),j.rules.sequence.capture(j.rules.optional(j.rules.sequence(j.rules.tokenOfType("whitespace"),j.rules.sequence.capture(ga())).head())),j.rules.tokenOfType("end")).map(function(e,t){return{from:e,to:t.valueOrElse(st.empty)}})}function Nu(e){return Cr(_a(),e)}function _a(){var e=j.rules.sequence,t=function(L,W){return j.rules.then(j.rules.token("identifier",L),function(){return W})},r=t("p",ge.paragraph),n=t("r",ge.run),o=j.rules.firstOf("p or r or table",r,n),p=j.rules.sequence(j.rules.tokenOfType("dot"),j.rules.sequence.cut(),j.rules.sequence.capture(Et)).map(function(L){return{styleId:L}}),f=j.rules.firstOf("style name matcher",j.rules.then(j.rules.sequence(j.rules.tokenOfType("equals"),j.rules.sequence.cut(),j.rules.sequence.capture(Le)).head(),function(L){return{styleName:ge.equalTo(L)}}),j.rules.then(j.rules.sequence(j.rules.tokenOfType("startsWith"),j.rules.sequence.cut(),j.rules.sequence.capture(Le)).head(),function(L){return{styleName:ge.startsWith(L)}})),u=j.rules.sequence(j.rules.tokenOfType("open-square-bracket"),j.rules.sequence.cut(),j.rules.token("identifier","style-name"),j.rules.sequence.capture(f),j.rules.tokenOfType("close-square-bracket")).head(),a=j.rules.firstOf("list type",t("ordered-list",{isOrdered:!0}),t("unordered-list",{isOrdered:!1})),l=e(j.rules.tokenOfType("colon"),e.capture(a),e.cut(),j.rules.tokenOfType("open-paren"),e.capture(Bu),j.rules.tokenOfType("close-paren")).map(function(L,W){return{list:{isOrdered:L.isOrdered,levelIndex:W-1}}});function i(L){var W=j.rules.firstOf.apply(j.rules.firstOf,["matcher suffix"].concat(L)),X=j.rules.zeroOrMore(W);return j.rules.then(X,function(G){var te={};return G.forEach(function(se){Ou.extend(te,se)}),te})}var s=e(e.capture(o),e.capture(i([p,u,l]))).map(function(L,W){return L(W)}),y=e(j.rules.token("identifier","table"),e.capture(i([p,u]))).map(function(L){return ge.table(L)}),g=t("b",ge.bold),c=t("i",ge.italic),v=t("u",ge.underline),m=t("strike",ge.strikethrough),E=t("all-caps",ge.allCaps),x=t("small-caps",ge.smallCaps),F=e(j.rules.token("identifier","highlight"),j.rules.sequence.capture(j.rules.optional(j.rules.sequence(j.rules.tokenOfType("open-square-bracket"),j.rules.sequence.cut(),j.rules.token("identifier","color"),j.rules.tokenOfType("equals"),j.rules.sequence.capture(Le),j.rules.tokenOfType("close-square-bracket")).head()))).map(function(L){return ge.highlight({color:L.valueOrElse(void 0)})}),H=t("comment-reference",ge.commentReference),M=e(j.rules.token("identifier","br"),e.cut(),j.rules.tokenOfType("open-square-bracket"),j.rules.token("identifier","type"),j.rules.tokenOfType("equals"),e.capture(Le),j.rules.tokenOfType("close-square-bracket")).map(function(L){switch(L){case"line":return ge.lineBreak;case"page":return ge.pageBreak;case"column":return ge.columnBreak}});return j.rules.firstOf("element type",s,y,g,c,v,m,E,x,F,H,M)}function qu(e){return Cr(ga(),e)}function ga(){var e=j.rules.sequence.capture,t=j.rules.tokenOfType("whitespace"),r=j.rules.then(j.rules.optional(j.rules.sequence(j.rules.tokenOfType("colon"),j.rules.token("identifier","fresh"))),function(f){return f.map(function(){return!0}).valueOrElse(!1)}),n=j.rules.then(j.rules.optional(j.rules.sequence(j.rules.tokenOfType("colon"),j.rules.token("identifier","separator"),j.rules.tokenOfType("open-paren"),e(Le),j.rules.tokenOfType("close-paren")).head()),function(f){return f.valueOrElse("")}),o=j.rules.oneOrMoreWithSeparator(Et,j.rules.tokenOfType("choice")),p=j.rules.sequence(e(o),e(j.rules.zeroOrMore($u)),e(r),e(n)).map(function(f,u,a,l){var i={},s={};return u.forEach(function(y){y.append&&i[y.name]?i[y.name]+=" "+y.value:i[y.name]=y.value}),a&&(s.fresh=!0),l&&(s.separator=l),st.element(f,i,s)});return j.rules.firstOf("html path",j.rules.then(j.rules.tokenOfType("bang"),function(){return st.ignore}),j.rules.then(j.rules.zeroOrMoreWithSeparator(p,j.rules.sequence(t,j.rules.tokenOfType("gt"),t)),st.elements))}var Et=j.rules.then(j.rules.tokenOfType("identifier"),ba),Bu=j.rules.tokenOfType("integer"),Le=j.rules.then(j.rules.tokenOfType("string"),ba),Mu={n:`
`,r:"\r",t:"	"};function ba(e){return e.replace(/\\(.)/g,function(t,r){return Mu[r]||r})}var Du=j.rules.sequence(j.rules.tokenOfType("open-square-bracket"),j.rules.sequence.cut(),j.rules.sequence.capture(Et),j.rules.tokenOfType("equals"),j.rules.sequence.capture(Le),j.rules.tokenOfType("close-square-bracket")).map(function(e,t){return{name:e,value:t,append:!1}}),Hu=j.rules.sequence(j.rules.tokenOfType("dot"),j.rules.sequence.cut(),j.rules.sequence.capture(Et)).map(function(e){return{name:"class",value:e,append:!0}}),$u=j.rules.firstOf("attribute or class",Du,Hu);function Cr(e,t){var r=ju(t),n=j.Parser(),o=n.parseTokens(e,r);return o.isSuccess()?ur.success(o.value()):new ur.Result(null,[ur.warning(Pu(t,o))])}function Pu(e,t){return"Did not understand this style mapping, so ignored it: "+e+`
`+t.errors().map(Lu).join(`
`)}function Lu(e){return"Error was at character number "+e.characterNumber()+": Expected "+e.expected+" but got "+e.actual}var Vu=Au(),Tt={};Tt.readOptions=Xu;var wa=he,Uu=Tt._defaultStyleMap=["p.Heading1 => h1:fresh","p.Heading2 => h2:fresh","p.Heading3 => h3:fresh","p.Heading4 => h4:fresh","p.Heading5 => h5:fresh","p.Heading6 => h6:fresh","p[style-name='Heading 1'] => h1:fresh","p[style-name='Heading 2'] => h2:fresh","p[style-name='Heading 3'] => h3:fresh","p[style-name='Heading 4'] => h4:fresh","p[style-name='Heading 5'] => h5:fresh","p[style-name='Heading 6'] => h6:fresh","p[style-name='heading 1'] => h1:fresh","p[style-name='heading 2'] => h2:fresh","p[style-name='heading 3'] => h3:fresh","p[style-name='heading 4'] => h4:fresh","p[style-name='heading 5'] => h5:fresh","p[style-name='heading 6'] => h6:fresh","r[style-name='Strong'] => strong","p[style-name='footnote text'] => p:fresh","r[style-name='footnote reference'] =>","p[style-name='endnote text'] => p:fresh","r[style-name='endnote reference'] =>","p[style-name='annotation text'] => p:fresh","r[style-name='annotation reference'] =>","p[style-name='Footnote'] => p:fresh","r[style-name='Footnote anchor'] =>","p[style-name='Endnote'] => p:fresh","r[style-name='Endnote anchor'] =>","p:unordered-list(1) => ul > li:fresh","p:unordered-list(2) => ul|ol > li > ul > li:fresh","p:unordered-list(3) => ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:ordered-list(1) => ol > li:fresh","p:ordered-list(2) => ul|ol > li > ol > li:fresh","p:ordered-list(3) => ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","r[style-name='Hyperlink'] =>","p[style-name='Normal'] => p:fresh"],Wu=Tt._standardOptions={transformDocument:zu,includeDefaultStyleMap:!0,includeEmbeddedStyleMap:!0};function Xu(e){return e=e||{},wa.extend({},Wu,e,{customStyleMap:jn(e.styleMap),readStyleMap:function(){var t=this.customStyleMap;return this.includeEmbeddedStyleMap&&(t=t.concat(jn(this.embeddedStyleMap))),this.includeDefaultStyleMap&&(t=t.concat(Uu)),t}})}function jn(e){return e?wa.isString(e)?e.split(`
`).map(function(t){return t.trim()}).filter(function(t){return t!==""&&t.charAt(0)!=="#"}):e:[]}function zu(e){return e}var Ea={},In=de,Gu=Ye;Ea.openZip=Qu;function Qu(e){return e.arrayBuffer?In.resolve(Gu.openArrayBuffer(e.arrayBuffer)):In.reject(new Error("Could not find file in options"))}var ze={},An=he;ze.paragraph=Zu;ze.run=Ku;ze._elements=Ca;ze.getDescendantsOfType=Ju;ze.getDescendants=ka;function Zu(e){return Ta("paragraph",e)}function Ku(e){return Ta("run",e)}function Ta(e,t){return Ca(function(r){return r.type===e?t(r):r})}function Ca(e){return function t(r){if(r.children){var n=An.map(r.children,t);r=An.extend(r,{children:n})}return e(r)}}function Ju(e,t){return ka(e).filter(function(r){return r.type===t})}function ka(e){var t=[];return Ra(e,function(r){t.push(r)}),t}function Ra(e,t){e.children&&e.children.forEach(function(r){Ra(r,t),t(r)})}var Sa={},Yu=gt(),es=_t();Sa.element=ts;function ts(e){return function(t){return es.elementWithTag(Yu.element(e),[t])}}var rs=he,Fa=lr,kr=wr,ns=Er.DocumentConverter,as=da.convertElementToRawText,is=bt.readStyle,os=Tt.readOptions,Ct=Ea,us=Ee.Result;Fe.convertToHtml=ss;Fe.convertToMarkdown=ls;Fe.convert=Rr;Fe.extractRawText=hs;Fe.images=Tr;Fe.transforms=ze;Fe.underline=Sa;Fe.embedStyleMap=ds;Fe.readEmbeddedStyleMap=cs;function ss(e,t){return Rr(e,t)}function ls(e,t){var r=Object.create(t||{});return r.outputFormat="markdown",Rr(e,r)}function Rr(e,t){return t=os(t),Ct.openZip(e).tap(function(r){return kr.readStyleMap(r).then(function(n){t.embeddedStyleMap=n})}).then(function(r){return Fa.read(r,e).then(function(n){return n.map(t.transformDocument)}).then(function(n){return fs(n,t)})})}function cs(e){return Ct.openZip(e).then(kr.readStyleMap)}function fs(e,t){var r=ps(t.readStyleMap()),n=rs.extend({},t,{styleMap:r.value}),o=new ns(n);return e.flatMapThen(function(p){return r.flatMapThen(function(f){return o.convertToHtml(p)})})}function ps(e){return us.combine((e||[]).map(is)).map(function(t){return t.filter(function(r){return!!r})})}function hs(e){return Ct.openZip(e).then(Fa.read).then(function(t){return t.map(as)})}function ds(e,t){return Ct.openZip(e).tap(function(r){return kr.writeStyleMap(r,t)}).then(function(r){return r.toArrayBuffer()}).then(function(r){return{toArrayBuffer:function(){return r},toBuffer:function(){return Buffer.from(r)}}})}Fe.styleMapping=function(){throw new Error(`Use a raw string instead of mammoth.styleMapping e.g. "p[style-name='Title'] => h1" instead of mammoth.styleMapping("p[style-name='Title'] => h1")`)};export{Fe as l};
