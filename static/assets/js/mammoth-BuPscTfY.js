import{r as B}from"./underscore-b--1-EUR.js";import{p as zt}from"./bluebird-D4N7l2sI.js";import{b as Kt}from"./base64-js-D0UyVEDn.js";import{j as Gt}from"./jszip-BmYNtbIh.js";import{d as Yt,l as Jt,c as Qr}from"./@xmldom-DBEIMRBk.js";import{l as Qt}from"./xmlbuilder-MWHHUJUD.js";import{d as en}from"./dingbat-to-unicode-Cm9PDbSb.js";import{l as et}from"./lop-DvYkyT-y.js";var Q={},lr={},M={},rn=B,j=zt();M.defer=tn;M.when=j.resolve;M.resolve=j.resolve;M.all=j.all;M.props=j.props;M.reject=j.reject;M.promisify=j.promisify;M.mapSeries=j.mapSeries;M.attempt=j.attempt;M.nfcall=function(e){var r=Array.prototype.slice.call(arguments,1),t=j.promisify(e);return t.apply(null,r)};j.prototype.fail=j.prototype.caught;j.prototype.also=function(e){return this.then(function(r){var t=rn.extend({},r,e(r));return j.props(t)})};function tn(){var e,r,t=new j.Promise(function(n,i){e=n,r=i});return{resolve:e,reject:r,promise:t}}var k={},nn=B,D=k.types={document:"document",paragraph:"paragraph",run:"run",text:"text",tab:"tab",hyperlink:"hyperlink",noteReference:"noteReference",image:"image",note:"note",commentReference:"commentReference",comment:"comment",table:"table",tableRow:"tableRow",tableCell:"tableCell",break:"break",bookmarkStart:"bookmarkStart"};function an(e,r){return r=r||{},{type:D.document,children:e,notes:r.notes||new He({}),comments:r.comments||[]}}function un(e,r){r=r||{};var t=r.indent||{};return{type:D.paragraph,children:e,styleId:r.styleId||null,styleName:r.styleName||null,numbering:r.numbering||null,alignment:r.alignment||null,indent:{start:t.start||null,end:t.end||null,firstLine:t.firstLine||null,hanging:t.hanging||null}}}function ln(e,r){return r=r||{},{type:D.run,children:e,styleId:r.styleId||null,styleName:r.styleName||null,isBold:!!r.isBold,isUnderline:!!r.isUnderline,isItalic:!!r.isItalic,isStrikethrough:!!r.isStrikethrough,isAllCaps:!!r.isAllCaps,isSmallCaps:!!r.isSmallCaps,verticalAlignment:r.verticalAlignment||rt.baseline,font:r.font||null,fontSize:r.fontSize||null,highlight:r.highlight||null}}var rt={baseline:"baseline",superscript:"superscript",subscript:"subscript"};function sn(e){return{type:D.text,value:e}}function on(){return{type:D.tab}}function cn(e,r){return{type:D.hyperlink,children:e,href:r.href,anchor:r.anchor,targetFrame:r.targetFrame}}function fn(e){return{type:D.noteReference,noteType:e.noteType,noteId:e.noteId}}function He(e){this._notes=nn.indexBy(e,function(r){return tt(r.noteType,r.noteId)})}He.prototype.resolve=function(e){return this.findNoteByKey(tt(e.noteType,e.noteId))};He.prototype.findNoteByKey=function(e){return this._notes[e]||null};function mn(e){return{type:D.note,noteType:e.noteType,noteId:e.noteId,body:e.body}}function pn(e){return{type:D.commentReference,commentId:e.commentId}}function dn(e){return{type:D.comment,commentId:e.commentId,body:e.body,authorName:e.authorName,authorInitials:e.authorInitials}}function tt(e,r){return e+"-"+r}function hn(e){return{type:D.image,read:function(r){return r?e.readImage(r):e.readImage().then(function(t){return Buffer.from(t)})},readAsArrayBuffer:function(){return e.readImage()},readAsBase64String:function(){return e.readImage("base64")},readAsBuffer:function(){return e.readImage().then(function(r){return Buffer.from(r)})},altText:e.altText,contentType:e.contentType}}function vn(e,r){return r=r||{},{type:D.table,children:e,styleId:r.styleId||null,styleName:r.styleName||null}}function yn(e,r){return r=r||{},{type:D.tableRow,children:e,isHeader:r.isHeader||!1}}function gn(e,r){return r=r||{},{type:D.tableCell,children:e,colSpan:r.colSpan==null?1:r.colSpan,rowSpan:r.rowSpan==null?1:r.rowSpan}}function sr(e){return{type:D.break,breakType:e}}function wn(e){return{type:D.bookmarkStart,name:e.name}}k.document=k.Document=an;k.paragraph=k.Paragraph=un;k.run=k.Run=ln;k.text=k.Text=sn;k.tab=k.Tab=on;k.Hyperlink=cn;k.noteReference=k.NoteReference=fn;k.Notes=He;k.Note=mn;k.commentReference=pn;k.comment=dn;k.Image=hn;k.Table=vn;k.TableRow=yn;k.TableCell=gn;k.lineBreak=sr("line");k.pageBreak=sr("page");k.columnBreak=sr("column");k.BookmarkStart=wn;k.verticalAlignment=rt;var U={},Ee=B;U.Result=J;U.success=bn;U.warning=Tn;U.error=En;function J(e,r){this.value=e,this.messages=r||[]}J.prototype.map=function(e){return new J(e(this.value),this.messages)};J.prototype.flatMap=function(e){var r=e(this.value);return new J(r.value,or([this,r]))};J.prototype.flatMapThen=function(e){var r=this;return e(this.value).then(function(t){return new J(t.value,or([r,t]))})};J.combine=function(e){var r=Ee.flatten(Ee.pluck(e,"value")),t=or(e);return new J(r,t)};function bn(e){return new J(e,[])}function Tn(e){return{type:"warning",message:e}}function En(e){return{type:"error",message:e.message,error:e}}function or(e){var r=[];return Ee.flatten(Ee.pluck(e,"messages"),!0).forEach(function(t){xn(r,t)||r.push(t)}),r}function xn(e,r){return Ee.find(e,kn.bind(null,r))!==void 0}function kn(e,r){return e.type===r.type&&e.message===r.message}var Re={},Rn=Kt,Sn=Gt;Re.openArrayBuffer=In;Re.splitPath=Pn;Re.joinPath=Nn;function In(e){return Sn.loadAsync(e).then(function(r){function t(s){return r.file(s)!==null}function n(s,c){return r.file(s).async("uint8array").then(function(f){if(c==="base64")return Rn.fromByteArray(f);if(c){var d=new TextDecoder(c);return d.decode(f)}else return f})}function i(s,c){r.file(s,c)}function o(){return r.generateAsync({type:"arraybuffer"})}return{exists:t,read:n,write:i,toArrayBuffer:o}})}function Pn(e){var r=e.lastIndexOf("/");return r===-1?{dirname:"",basename:e}:{dirname:e.substring(0,r),basename:e.substring(r+1)}}function Nn(){var e=Array.prototype.filter.call(arguments,function(t){return t}),r=[];return e.forEach(function(t){/^\//.test(t)?r=[t]:r.push(t)}),r.join("/")}var cr={},se={},Se={},Ae=B;Se.Element=de;Se.element=function(e,r,t){return new de(e,r,t)};Se.text=function(e){return{type:"text",value:e}};var nt={first:function(){return null},firstOrEmpty:function(){return nt},attributes:{}};function de(e,r,t){this.type="element",this.name=e,this.attributes=r||{},this.children=t||[]}de.prototype.first=function(e){return Ae.find(this.children,function(r){return r.name===e})};de.prototype.firstOrEmpty=function(e){return this.first(e)||nt};de.prototype.getElementsByTagName=function(e){var r=Ae.filter(this.children,function(t){return t.name===e});return at(r)};de.prototype.text=function(){if(this.children.length===0)return"";if(this.children.length!==1||this.children[0].type!=="text")throw new Error("Not implemented");return this.children[0].value};var On={getElementsByTagName:function(e){return at(Ae.flatten(this.map(function(r){return r.getElementsByTagName(e)},!0)))}};function at(e){return Ae.extend(e,On)}var it={},fr={},Cn=Jt,$n=Yt;function Bn(e){var r=null,t=new Cn.DOMParser({errorHandler:function(i,o){r={level:i,message:o}}}),n=t.parseFromString(e);if(r===null)return n;throw new Error(r.level+": "+r.message)}fr.parseFromString=Bn;fr.Node=$n.Node;var rr=M,Pr=B,ut=fr,lt=Se,Mn=lt.Element;it.readString=_n;var Nr=ut.Node;function _n(e,r){r=r||{};try{var t=ut.parseFromString(e,"text/xml")}catch(s){return rr.reject(s)}if(t.documentElement.tagName==="parsererror")return rr.resolve(new Error(t.documentElement.textContent));function n(s){switch(s.nodeType){case Nr.ELEMENT_NODE:return i(s);case Nr.TEXT_NODE:return lt.text(s.nodeValue)}}function i(s){var c=o(s),f=[];Pr.forEach(s.childNodes,function(p){var b=n(p);b&&f.push(b)});var d={};return Pr.forEach(s.attributes,function(p){d[o(p)]=p.value}),new Mn(c,d,f)}function o(s){if(s.namespaceURI){var c=r[s.namespaceURI],f;return c?f=c+":":f="{"+s.namespaceURI+"}",f+s.localName}else return s.localName}return rr.resolve(n(t.documentElement))}var st={},Or=B,Fn=Qt;st.writeString=qn;function qn(e,r){var t=Or.invert(r),n={element:o,text:Hn};function i(f,d){return n[d.type](f,d)}function o(f,d){var p=f.element(s(d.name),d.attributes);d.children.forEach(function(b){i(p,b)})}function s(f){var d=/^\{(.*)\}(.*)$/.exec(f);if(d){var p=t[d[1]];return p+(p===""?"":":")+d[2]}else return f}function c(f){var d=Fn.create(s(f.name),{version:"1.0",encoding:"UTF-8",standalone:!0});return Or.forEach(r,function(p,b){var O="xmlns"+(b===""?"":":"+b);d.attribute(O,p)}),f.children.forEach(function(p){i(d,p)}),d.end()}return c(e)}function Hn(e,r){e.text(r.value)}var mr=Se;se.Element=mr.Element;se.element=mr.element;se.text=mr.text;se.readString=it.readString;se.writeString=st.writeString;var An=B,Dn=M,Wn=se;cr.read=ot;cr.readXmlFromZipFile=Xn;var Ln={"http://schemas.openxmlformats.org/wordprocessingml/2006/main":"w","http://schemas.openxmlformats.org/officeDocument/2006/relationships":"r","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing":"wp","http://schemas.openxmlformats.org/drawingml/2006/main":"a","http://schemas.openxmlformats.org/drawingml/2006/picture":"pic","http://purl.oclc.org/ooxml/wordprocessingml/main":"w","http://purl.oclc.org/ooxml/officeDocument/relationships":"r","http://purl.oclc.org/ooxml/drawingml/wordprocessingDrawing":"wp","http://purl.oclc.org/ooxml/drawingml/main":"a","http://purl.oclc.org/ooxml/drawingml/picture":"pic","http://schemas.openxmlformats.org/package/2006/content-types":"content-types","http://schemas.openxmlformats.org/package/2006/relationships":"relationships","http://schemas.openxmlformats.org/markup-compatibility/2006":"mc","urn:schemas-microsoft-com:vml":"v","urn:schemas-microsoft-com:office:word":"office-word"};function ot(e){return Wn.readString(e,Ln).then(function(r){return ct(r)[0]})}function Xn(e,r){return e.exists(r)?e.read(r,"utf-8").then(jn).then(ot):Dn.resolve(null)}function jn(e){return e.replace(/^\uFEFF/g,"")}function ct(e){return e.type==="element"?e.name==="mc:AlternateContent"?e.first("mc:Fallback").children:(e.children=An.flatten(e.children.map(ct,!0)),[e]):[e]}var pr={},dr={};dr.uriToZipEntryName=Un;dr.replaceFragment=Vn;function Un(e,r){return r.charAt(0)==="/"?r.substr(1):e+"/"+r}function Vn(e,r){var t=e.indexOf("#");return t!==-1&&(e=e.substring(0,t)),e+"#"+r}pr.createBodyReader=Zn;pr._readNumberingProperties=mt;var Cr=en,K=B,$=k,ft=U.Result,te=U.warning,$r=dr;function Zn(e){return{readXmlElement:function(r){return new Br(e).readXmlElement(r)},readXmlElements:function(r){return new Br(e).readXmlElements(r)}}}function Br(e){var r=[],t=[],n=[],i=e.relationships,o=e.contentTypes,s=e.docxFile,c=e.files,f=e.numbering,d=e.styles;function p(a){var m=a.map(b);return Mr(m)}function b(a){if(a.type==="element"){var m=Je[a.name];if(m)return m(a);if(!Object.prototype.hasOwnProperty.call(Kn,a.name)){var v=te("An unrecognised element was ignored: "+a.name);return be([v])}}return Te()}function O(a){return ue(a).map(function(m){return{type:"paragraphProperties",styleId:m.styleId,styleName:m.name,alignment:a.firstOrEmpty("w:jc").attributes["w:val"],numbering:mt(m.styleId,a.firstOrEmpty("w:numPr"),f),indent:q(a.firstOrEmpty("w:ind"))}})}function q(a){return{start:a.attributes["w:start"]||a.attributes["w:left"],end:a.attributes["w:end"]||a.attributes["w:right"],firstLine:a.attributes["w:firstLine"],hanging:a.attributes["w:hanging"]}}function I(a){return oe(a).map(function(m){var v=a.firstOrEmpty("w:sz").attributes["w:val"],T=/^[0-9]+$/.test(v)?parseInt(v,10)/2:null;return{type:"runProperties",styleId:m.styleId,styleName:m.name,verticalAlignment:a.firstOrEmpty("w:vertAlign").attributes["w:val"],font:a.firstOrEmpty("w:rFonts").attributes["w:ascii"],fontSize:T,isBold:R(a.first("w:b")),isUnderline:g(a.first("w:u")),isItalic:R(a.first("w:i")),isStrikethrough:R(a.first("w:strike")),isAllCaps:R(a.first("w:caps")),isSmallCaps:R(a.first("w:smallCaps")),highlight:H(a.firstOrEmpty("w:highlight").attributes["w:val"])}})}function g(a){if(a){var m=a.attributes["w:val"];return m!==void 0&&m!=="false"&&m!=="0"&&m!=="none"}else return!1}function R(a){if(a){var m=a.attributes["w:val"];return m!=="false"&&m!=="0"}else return!1}function H(a){return!a||a==="none"?null:a}function ue(a){return ee(a,"w:pStyle","Paragraph",d.findParagraphStyleById)}function oe(a){return ee(a,"w:rStyle","Run",d.findCharacterStyleById)}function ce(a){return ee(a,"w:tblStyle","Table",d.findTableStyleById)}function ee(a,m,v,T){var N=[],C=a.first(m),V=null,Pe=null;if(C&&(V=C.attributes["w:val"],V)){var Ir=T(V);Ir?Pe=Ir.name:N.push(Zt(v,V))}return Ne({styleId:V,name:Pe},N)}var P={type:"unknown"};function X(a){var m=a.attributes["w:fldCharType"];if(m==="begin")r.push(P),t=[];else if(m==="end")r.pop();else if(m==="separate"){var v=ge(t.join("")),T=v===null?P:{type:"hyperlink",options:v};r.pop(),r.push(T)}return Te()}function ye(){var a=K.last(r.filter(function(m){return m.type==="hyperlink"}));return a?a.options:null}function ge(a){var m=/\s*HYPERLINK "(.*)"/.exec(a);if(m)return{href:m[1]};var v=/\s*HYPERLINK\s+\\l\s+"(.*)"/.exec(a);return v?{anchor:v[1]}:null}function fe(a){return t.push(a.text()),Te()}function we(a){var m=a.attributes["w:font"],v=a.attributes["w:char"],T=Cr.hex(m,v);return T==null&&/^F0..$/.test(v)&&(T=Cr.hex(m,v.substring(2))),T==null?be([te("A w:sym element with an unsupported character was ignored: char "+v+" in font "+m)]):Z(new $.Text(T.string))}function Ie(a){return function(m){var v=m.attributes["w:id"];return Z(new $.NoteReference({noteType:a,noteId:v}))}}function Ye(a){return Z($.commentReference({commentId:a.attributes["w:id"]}))}function W(a){return p(a.children)}var Je={"w:p":function(a){var m=a.firstOrEmpty("w:pPr"),v=!!m.firstOrEmpty("w:rPr").first("w:del");if(v)return a.children.forEach(function(N){n.push(N)}),Te();var T=a.children;return n.length>0&&(T=n.concat(T),n=[]),_.map(O(m),p(T),function(N,C){return new $.Paragraph(C,N)}).insertExtra()},"w:r":function(a){return _.map(I(a.firstOrEmpty("w:rPr")),p(a.children),function(m,v){var T=ye();return T!==null&&(v=[new $.Hyperlink(v,T)]),new $.Run(v,m)})},"w:fldChar":X,"w:instrText":fe,"w:t":function(a){return Z(new $.Text(a.text()))},"w:tab":function(a){return Z(new $.Tab)},"w:noBreakHyphen":function(){return Z(new $.Text("‑"))},"w:softHyphen":function(a){return Z(new $.Text("­"))},"w:sym":we,"w:hyperlink":function(a){var m=a.attributes["r:id"],v=a.attributes["w:anchor"];return p(a.children).map(function(T){function N(V){var Pe=a.attributes["w:tgtFrame"]||null;return new $.Hyperlink(T,K.extend({targetFrame:Pe},V))}if(m){var C=i.findTargetByRelationshipId(m);return v&&(C=$r.replaceFragment(C,v)),N({href:C})}else return v?N({anchor:v}):T})},"w:tbl":Qe,"w:tr":u,"w:tc":h,"w:footnoteReference":Ie("footnote"),"w:endnoteReference":Ie("endnote"),"w:commentReference":Ye,"w:br":function(a){var m=a.attributes["w:type"];return m==null||m==="textWrapping"?Z($.lineBreak):m==="page"?Z($.pageBreak):m==="column"?Z($.columnBreak):be([te("Unsupported break type: "+m)])},"w:bookmarkStart":function(a){var m=a.attributes["w:name"];return m==="_GoBack"?Te():Z(new $.BookmarkStart({name:m}))},"mc:AlternateContent":function(a){return W(a.first("mc:Fallback"))},"w:sdt":function(a){return p(a.firstOrEmpty("w:sdtContent").children)},"w:ins":W,"w:object":W,"w:smartTag":W,"w:drawing":W,"w:pict":function(a){return W(a).toExtra()},"v:roundrect":W,"v:shape":W,"v:textbox":W,"w:txbxContent":W,"wp:inline":E,"wp:anchor":E,"v:imagedata":G,"v:group":W,"v:rect":W};return{readXmlElement:b,readXmlElements:p};function Qe(a){var m=er(a.firstOrEmpty("w:tblPr"));return p(a.children).flatMap(w).flatMap(function(v){return m.map(function(T){return $.Table(v,T)})})}function er(a){return ce(a).map(function(m){return{styleId:m.styleId,styleName:m.name}})}function u(a){var m=a.firstOrEmpty("w:trPr"),v=!!m.first("w:tblHeader");return p(a.children).map(function(T){return $.TableRow(T,{isHeader:v})})}function h(a){return p(a.children).map(function(m){var v=a.firstOrEmpty("w:tcPr"),T=v.firstOrEmpty("w:gridSpan").attributes["w:val"],N=T?parseInt(T,10):1,C=$.TableCell(m,{colSpan:N});return C._vMerge=y(v),C})}function y(a){var m=a.first("w:vMerge");if(m){var v=m.attributes["w:val"];return v==="continue"||!v}else return null}function w(a){var m=K.any(a,function(N){return N.type!==$.types.tableRow});if(m)return Ne(a,[te("unexpected non-row element in table, cell merging may be incorrect")]);var v=K.any(a,function(N){return K.any(N.children,function(C){return C.type!==$.types.tableCell})});if(v)return Ne(a,[te("unexpected non-cell element in table row, cell merging may be incorrect")]);var T={};return a.forEach(function(N){var C=0;N.children.forEach(function(V){V._vMerge&&T[C]?T[C].rowSpan++:(T[C]=V,V._vMerge=!1),C+=V.colSpan})}),a.forEach(function(N){N.children=N.children.filter(function(C){return!C._vMerge}),N.children.forEach(function(C){delete C._vMerge})}),Z(a)}function E(a){var m=a.getElementsByTagName("a:graphic").getElementsByTagName("a:graphicData").getElementsByTagName("pic:pic").getElementsByTagName("pic:blipFill").getElementsByTagName("a:blip");return Mr(m.map(S.bind(null,a)))}function S(a,m){var v=a.first("wp:docPr").attributes,T=L(v.descr)?v.title:v.descr,N=re(m);return N===null?be([te("Could not find image file for a:blip element")]):Sr(N,T)}function L(a){return a==null||/^\s*$/.test(a)}function re(a){var m=a.attributes["r:embed"],v=a.attributes["r:link"];if(m)return Rr(m);if(v){var T=i.findTargetByRelationshipId(v);return{path:T,read:c.read.bind(c,T)}}else return null}function G(a){var m=a.attributes["r:id"];return m?Sr(Rr(m),a.attributes["o:title"]):be([te("A v:imagedata element without a relationship ID was ignored")])}function Rr(a){var m=$r.uriToZipEntryName("word",i.findTargetByRelationshipId(a));return{path:m,read:s.read.bind(s,m)}}function Sr(a,m){var v=o.findContentType(a.path),T=$.Image({readImage:a.read,altText:m,contentType:v}),N=zn[v]?[]:te("Image of type "+v+" is unlikely to display in web browsers");return Ne(T,N)}function Zt(a,m){return te(a+" style with ID "+m+" was referenced but not defined in the document")}}function mt(e,r,t){var n=r.firstOrEmpty("w:ilvl").attributes["w:val"],i=r.firstOrEmpty("w:numId").attributes["w:val"];if(n!==void 0&&i!==void 0)return t.findLevel(i,n);if(e!=null){var o=t.findLevelByParagraphStyleId(e);if(o!=null)return o}return null}var zn={"image/png":!0,"image/gif":!0,"image/jpeg":!0,"image/svg+xml":!0,"image/tiff":!0},Kn={"office-word:wrap":!0,"v:shadow":!0,"v:shapetype":!0,"w:annotationRef":!0,"w:bookmarkEnd":!0,"w:sectPr":!0,"w:proofErr":!0,"w:lastRenderedPageBreak":!0,"w:commentRangeStart":!0,"w:commentRangeEnd":!0,"w:del":!0,"w:footnoteRef":!0,"w:endnoteRef":!0,"w:pPr":!0,"w:rPr":!0,"w:tblPr":!0,"w:tblGrid":!0,"w:trPr":!0,"w:tcPr":!0};function be(e){return new _(null,null,e)}function Te(){return new _(null)}function Z(e){return new _(e)}function Ne(e,r){return new _(e,null,r)}function _(e,r,t){this.value=e||[],this.extra=r||[],this._result=new ft({element:this.value,extra:r},t),this.messages=this._result.messages}_.prototype.toExtra=function(){return new _(null,De(this.extra,this.value),this.messages)};_.prototype.insertExtra=function(){var e=this.extra;return e&&e.length?new _(De(this.value,e),null,this.messages):this};_.prototype.map=function(e){var r=this._result.map(function(t){return e(t.element)});return new _(r.value,this.extra,r.messages)};_.prototype.flatMap=function(e){var r=this._result.flatMap(function(t){return e(t.element)._result});return new _(r.value.element,De(this.extra,r.value.extra),r.messages)};_.map=function(e,r,t){return new _(t(e.value,r.value),De(e.extra,r.extra),e.messages.concat(r.messages))};function Mr(e){var r=ft.combine(K.pluck(e,"_result"));return new _(K.flatten(K.pluck(r.value,"element")),K.filter(K.flatten(K.pluck(r.value,"extra")),Gn),r.messages)}function De(e,r){return K.flatten([e,r])}function Gn(e){return e}var pt={};pt.DocumentXmlReader=Qn;var Yn=k,Jn=U.Result;function Qn(e){var r=e.bodyReader;function t(n){var i=n.first("w:body");if(i==null)throw new Error("Could not find the body element: are you sure this is a docx file?");var o=r.readXmlElements(i.children).map(function(s){return new Yn.Document(s,{notes:e.notes,comments:e.comments})});return new Jn(o.value,o.messages)}return{convertXmlToDocument:t}}var We={};We.readRelationships=ea;We.defaultValue=new hr([]);We.Relationships=hr;function ea(e){var r=[];return e.children.forEach(function(t){if(t.name==="relationships:Relationship"){var n={relationshipId:t.attributes.Id,target:t.attributes.Target,type:t.attributes.Type};r.push(n)}}),new hr(r)}function hr(e){var r={};e.forEach(function(n){r[n.relationshipId]=n.target});var t={};return e.forEach(function(n){t[n.type]||(t[n.type]=[]),t[n.type].push(n.target)}),{findTargetByRelationshipId:function(n){return r[n]},findTargetsByType:function(n){return t[n]||[]}}}var vr={};vr.readContentTypesFromXml=ta;var ra={png:"png",gif:"gif",jpeg:"jpeg",jpg:"jpeg",tif:"tiff",tiff:"tiff",bmp:"bmp"};vr.defaultContentTypes=dt({},{});function ta(e){var r={},t={};return e.children.forEach(function(n){if(n.name==="content-types:Default"&&(r[n.attributes.Extension]=n.attributes.ContentType),n.name==="content-types:Override"){var i=n.attributes.PartName;i.charAt(0)==="/"&&(i=i.substring(1)),t[i]=n.attributes.ContentType}}),dt(t,r)}function dt(e,r){return{findContentType:function(t){var n=e[t];if(n)return n;var i=t.split("."),o=i[i.length-1];if(r.hasOwnProperty(o))return r[o];var s=ra[o.toLowerCase()];return s?"image/"+s:null}}}var Le={},Oe=B;Le.readNumberingXml=na;Le.Numbering=yr;Le.defaultNumbering=new yr({},{});function yr(e,r,t){var n=Oe.flatten(Oe.values(r).map(function(c){return Oe.values(c.levels)})),i=Oe.indexBy(n.filter(function(c){return c.paragraphStyleId!=null}),"paragraphStyleId");function o(c,f){var d=e[c];if(d){var p=r[d.abstractNumId];if(p){if(p.numStyleLink==null)return r[d.abstractNumId].levels[f];var b=t.findNumberingStyleById(p.numStyleLink);return o(b.numId,f)}else return null}else return null}function s(c){return i[c]||null}return{findLevel:o,findLevelByParagraphStyleId:s}}function na(e,r){if(!r||!r.styles)throw new Error("styles is missing");var t=aa(e),n=ua(e);return new yr(n,t,r.styles)}function aa(e){var r={};return e.getElementsByTagName("w:abstractNum").forEach(function(t){var n=t.attributes["w:abstractNumId"];r[n]=ia(t)}),r}function ia(e){var r={};e.getElementsByTagName("w:lvl").forEach(function(n){var i=n.attributes["w:ilvl"],o=n.firstOrEmpty("w:numFmt").attributes["w:val"],s=n.firstOrEmpty("w:pStyle").attributes["w:val"];r[i]={isOrdered:o!=="bullet",level:i,paragraphStyleId:s}});var t=e.firstOrEmpty("w:numStyleLink").attributes["w:val"];return{levels:r,numStyleLink:t}}function ua(e){var r={};return e.getElementsByTagName("w:num").forEach(function(t){var n=t.attributes["w:numId"],i=t.first("w:abstractNumId").attributes["w:val"];r[n]={abstractNumId:i}}),r}var Xe={};Xe.readStylesXml=la;Xe.Styles=xe;Xe.defaultStyles=new xe({},{});function xe(e,r,t,n){return{findParagraphStyleById:function(i){return e[i]},findCharacterStyleById:function(i){return r[i]},findTableStyleById:function(i){return t[i]},findNumberingStyleById:function(i){return n[i]}}}xe.EMPTY=new xe({},{},{},{});function la(e){var r={},t={},n={},i={},o={paragraph:r,character:t,table:n};return e.getElementsByTagName("w:style").forEach(function(s){var c=sa(s);if(c.type==="numbering")i[c.styleId]=ca(s);else{var f=o[c.type];f&&(f[c.styleId]=c)}}),new xe(r,t,n,i)}function sa(e){var r=e.attributes["w:type"],t=e.attributes["w:styleId"],n=oa(e);return{type:r,styleId:t,name:n}}function oa(e){var r=e.first("w:name");return r?r.attributes["w:val"]:null}function ca(e){var r=e.firstOrEmpty("w:pPr").firstOrEmpty("w:numPr").firstOrEmpty("w:numId").attributes["w:val"];return{numId:r}}var gr={},fa=k,ma=U.Result;gr.createFootnotesReader=ht.bind(Qr,"footnote");gr.createEndnotesReader=ht.bind(Qr,"endnote");function ht(e,r){function t(o){return ma.combine(o.getElementsByTagName("w:"+e).filter(n).map(i))}function n(o){var s=o.attributes["w:type"];return s!=="continuationSeparator"&&s!=="separator"}function i(o){var s=o.attributes["w:id"];return r.readXmlElements(o.children).map(function(c){return fa.Note({noteType:e,noteId:s,body:c})})}return t}var vt={},pa=k,da=U.Result;function ha(e){function r(n){return da.combine(n.getElementsByTagName("w:comment").map(t))}function t(n){var i=n.attributes["w:id"];function o(s){return(n.attributes[s]||"").trim()||null}return e.readXmlElements(n.children).map(function(s){return pa.comment({commentId:i,body:s,authorName:o("w:author"),authorInitials:o("w:initials")})})}return r}vt.createCommentsReader=ha;var yt={},va=M;yt.Files=ya;function ya(){function e(r){return va.reject(new Error("could not open external image: '"+r+`'
cannot open linked files from a web browser`))}return{read:e}}lr.read=xa;lr._findPartPaths=wt;var ga=M,wa=k,tr=U.Result,_e=Re,gt=cr.readXmlFromZipFile,ba=pr.createBodyReader,Ta=pt.DocumentXmlReader,pe=We,_r=vr,Fr=Le,qr=Xe,Hr=gr,Ea=vt,Ar=yt.Files;function xa(e,r){return r=r||{},ga.props({contentTypes:Ra(e),partPaths:wt(e),docxFile:e,files:r.path?Ar.relativeToFile(r.path):new Ar(null)}).also(function(t){return{styles:Ia(e,t.partPaths.styles)}}).also(function(t){return{numbering:Sa(e,t.partPaths.numbering,t.styles)}}).also(function(t){return{footnotes:Ce(t.partPaths.footnotes,t,function(n,i){return i?Hr.createFootnotesReader(n)(i):new tr([])}),endnotes:Ce(t.partPaths.endnotes,t,function(n,i){return i?Hr.createEndnotesReader(n)(i):new tr([])}),comments:Ce(t.partPaths.comments,t,function(n,i){return i?Ea.createCommentsReader(n)(i):new tr([])})}}).also(function(t){return{notes:t.footnotes.flatMap(function(n){return t.endnotes.map(function(i){return new wa.Notes(n.concat(i))})})}}).then(function(t){return Ce(t.partPaths.mainDocument,t,function(n,i){return t.notes.flatMap(function(o){return t.comments.flatMap(function(s){var c=new Ta({bodyReader:n,notes:o,comments:s});return c.convertXmlToDocument(i)})})})})}function wt(e){return Pa(e).then(function(r){var t=Dr({docxFile:e,relationships:r,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",basePath:"",fallbackPath:"word/document.xml"});if(!e.exists(t))throw new Error("Could not find main document part. Are you sure this is a valid .docx file?");return he({filename:bt(t),readElement:pe.readRelationships,defaultValue:pe.defaultValue})(e).then(function(n){function i(o){return Dr({docxFile:e,relationships:n,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/"+o,basePath:_e.splitPath(t).dirname,fallbackPath:"word/"+o+".xml"})}return{mainDocument:t,comments:i("comments"),endnotes:i("endnotes"),footnotes:i("footnotes"),numbering:i("numbering"),styles:i("styles")}})})}function Dr(e){var r=e.docxFile,t=e.relationships,n=e.relationshipType,i=e.basePath,o=e.fallbackPath,s=t.findTargetsByType(n),c=s.map(function(d){return ka(_e.joinPath(i,d),"/")}),f=c.filter(function(d){return r.exists(d)});return f.length===0?o:f[0]}function ka(e,r){return e.substring(0,r.length)===r?e.substring(r.length):e}function he(e){return function(r){return gt(r,e.filename).then(function(t){return t?e.readElement(t):e.defaultValue})}}function Ce(e,r,t){var n=he({filename:bt(e),readElement:pe.readRelationships,defaultValue:pe.defaultValue});return n(r.docxFile).then(function(i){var o=new ba({relationships:i,contentTypes:r.contentTypes,docxFile:r.docxFile,numbering:r.numbering,styles:r.styles,files:r.files});return gt(r.docxFile,e).then(function(s){return t(o,s)})})}function bt(e){var r=_e.splitPath(e);return _e.joinPath(r.dirname,"_rels",r.basename+".rels")}var Ra=he({filename:"[Content_Types].xml",readElement:_r.readContentTypesFromXml,defaultValue:_r.defaultContentTypes});function Sa(e,r,t){return he({filename:r,readElement:function(n){return Fr.readNumberingXml(n,{styles:t})},defaultValue:Fr.defaultNumbering})(e)}function Ia(e,r){return he({filename:r,readElement:qr.readStylesXml,defaultValue:qr.defaultStyles})(e)}var Pa=he({filename:"_rels/.rels",readElement:pe.readRelationships,defaultValue:pe.defaultValue}),wr={},Na=B,Oa=M,ke=se;wr.writeStyleMap=$a;wr.readStyleMap=_a;var Ca="http://schemas.zwobble.org/mammoth/style-map",Fe="mammoth/style-map",Tt="/"+Fe;function $a(e,r){return e.write(Fe,r),Ba(e).then(function(){return Ma(e)})}function Ba(e){var r="word/_rels/document.xml.rels",t="http://schemas.openxmlformats.org/package/2006/relationships",n="{"+t+"}Relationship";return e.read(r,"utf8").then(ke.readString).then(function(i){var o=i.children;Et(o,n,"Id",{Id:"rMammothStyleMap",Type:Ca,Target:Tt});var s={"":t};return e.write(r,ke.writeString(i,s))})}function Ma(e){var r="[Content_Types].xml",t="http://schemas.openxmlformats.org/package/2006/content-types",n="{"+t+"}Override";return e.read(r,"utf8").then(ke.readString).then(function(i){var o=i.children;Et(o,n,"PartName",{PartName:Tt,ContentType:"text/prs.mammoth.style-map"});var s={"":t};return e.write(r,ke.writeString(i,s))})}function Et(e,r,t,n){var i=Na.find(e,function(o){return o.name===r&&o.attributes[t]===n[t]});i?i.attributes=n:e.push(ke.element(r,n))}function _a(e){return e.exists(Fe)?e.read(Fe,"utf8"):Oa.resolve(null)}var br={},le={},ne={},ae={},Wr;function xt(){if(Wr)return ae;Wr=1;var e=Ue();function r(f,d,p){return n(e.element(f,d,{fresh:!1}),p)}function t(f,d,p){var b=e.element(f,d,{fresh:!0});return n(b,p)}function n(f,d){return{type:"element",tag:f,children:d||[]}}function i(f){return{type:"text",value:f}}var o={type:"forceWrite"};ae.freshElement=t,ae.nonFreshElement=r,ae.elementWithTag=n,ae.text=i,ae.forceWrite=o;var s={br:!0,hr:!0,img:!0};function c(f){return f.children.length===0&&s[f.tag.tagName]}return ae.isVoidElement=c,ae}var nr,Lr;function Fa(){if(Lr)return nr;Lr=1;var e=B,r=xt();function t(g){return n(d(g))}function n(g){var R=[];return g.map(i).forEach(function(H){f(R,H)}),R}function i(g){return o[g.type](g)}var o={element:s,text:c,forceWrite:c};function s(g){return r.elementWithTag(g.tag,n(g.children))}function c(g){return g}function f(g,R){var H=g[g.length-1];R.type==="element"&&!R.tag.fresh&&H&&H.type==="element"&&R.tag.matchesElement(H.tag)?(R.tag.separator&&f(H.children,r.text(R.tag.separator)),R.children.forEach(function(ue){f(H.children,ue)})):g.push(R)}function d(g){return p(g,function(R){return b[R.type](R)})}function p(g,R){return e.flatten(e.map(g,R),!0)}var b={element:q,text:I,forceWrite:O};function O(g){return[g]}function q(g){var R=d(g.children);return R.length===0&&!r.isVoidElement(g)?[]:[r.elementWithTag(g.tag,R)]}function I(g){return g.value.length===0?[]:[g]}return nr=t,nr}var Xr;function je(){if(Xr)return ne;Xr=1;var e=xt();ne.freshElement=e.freshElement,ne.nonFreshElement=e.nonFreshElement,ne.elementWithTag=e.elementWithTag,ne.text=e.text,ne.forceWrite=e.forceWrite,ne.simplify=Fa();function r(s,c){c.forEach(function(f){t(s,f)})}function t(s,c){n[c.type](s,c)}var n={element:i,text:o,forceWrite:function(){}};function i(s,c){e.isVoidElement(c)?s.selfClosing(c.tag.tagName,c.tag.attributes):(s.open(c.tag.tagName,c.tag.attributes),r(s,c.children),s.close(c.tag.tagName))}function o(s,c){s.text(c.value)}return ne.write=r,ne}var jr;function Ue(){if(jr)return le;jr=1;var e=B,r=je();le.topLevelElement=t,le.elements=n,le.element=o;function t(c,f){return n([o(c,f,{fresh:!0})])}function n(c){return new i(c.map(function(f){return e.isString(f)?o(f):f}))}function i(c){this._elements=c}i.prototype.wrap=function(f){for(var d=f(),p=this._elements.length-1;p>=0;p--)d=this._elements[p].wrapNodes(d);return d};function o(c,f,d){return d=d||{},new s(c,f,d)}function s(c,f,d){var p={};e.isArray(c)?(c.forEach(function(b){p[b]=!0}),c=c[0]):p[c]=!0,this.tagName=c,this.tagNames=p,this.attributes=f||{},this.fresh=d.fresh,this.separator=d.separator}return s.prototype.matchesElement=function(c){return this.tagNames[c.tagName]&&e.isEqual(this.attributes||{},c.attributes||{})},s.prototype.wrap=function(f){return this.wrapNodes(f())},s.prototype.wrapNodes=function(f){return[r.elementWithTag(this,f)]},le.empty=n([]),le.ignore={wrap:function(){return[]}},le}var Tr={};(function(e){var r=B,t=M,n=je();e.imgElement=i;function i(o){return function(s,c){return t.when(o(s)).then(function(f){var d={};return s.altText&&(d.alt=s.altText),r.extend(d,f),[n.freshElement("img",d)]})}}e.inline=e.imgElement,e.dataUri=i(function(o){return o.readAsBase64String().then(function(s){return{src:"data:"+o.contentType+";base64,"+s}})})})(Tr);var kt={},Rt={},St=B;Rt.writer=qa;function qa(e){return e=e||{},e.prettyPrint?Ha():It()}var $e={div:!0,p:!0,ul:!0,li:!0};function Ha(){var e=0,r="  ",t=[],n=!0,i=!1,o=It();function s(I,g){$e[I]&&O(),t.push(I),o.open(I,g),$e[I]&&e++,n=!1}function c(I){$e[I]&&(e--,O()),t.pop(),o.close(I)}function f(I){b();var g=q()?I:I.replace(`
`,`
`+r);o.text(g)}function d(I,g){O(),o.selfClosing(I,g)}function p(){return t.length===0||$e[t[t.length-1]]}function b(){i||(O(),i=!0)}function O(){if(i=!1,!n&&p()&&!q()){o._append(`
`);for(var I=0;I<e;I++)o._append(r)}}function q(){return St.some(t,function(I){return I==="pre"})}return{asString:o.asString,open:s,close:c,text:f,selfClosing:d}}function It(){var e=[];function r(f,d){var p=i(d);e.push("<"+f+p+">")}function t(f){e.push("</"+f+">")}function n(f,d){var p=i(d);e.push("<"+f+p+" />")}function i(f){return St.map(f,function(d,p){return" "+p+'="'+Da(d)+'"'}).join("")}function o(f){e.push(Aa(f))}function s(f){e.push(f)}function c(){return e.join("")}return{asString:c,open:r,close:t,text:o,selfClosing:n,_append:s}}function Aa(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Da(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var Pt={},Wa=B;function Ur(e){return qe(e,e)}function qe(e,r){return function(){return{start:e,end:r}}}function La(e){var r=e.href||"";return r?{start:"[",end:"]("+r+")",anchorPosition:"before"}:{}}function Xa(e){var r=e.src||"",t=e.alt||"";return r||t?{start:"!["+t+"]("+r+")"}:{}}function Vr(e){return function(r,t){return{start:t?`
`:"",end:t?"":`
`,list:{isOrdered:e.isOrdered,indent:t?t.indent+1:0,count:0}}}}function ja(e,r,t){r=r||{indent:0,isOrdered:!1,count:0},r.count++,t.hasClosed=!1;var n=r.isOrdered?r.count+".":"-",i=Ot("	",r.indent)+n+" ";return{start:i,end:function(){if(!t.hasClosed)return t.hasClosed=!0,`
`}}}var Nt={p:qe("",`

`),br:qe("",`  
`),ul:Vr({isOrdered:!1}),ol:Vr({isOrdered:!0}),li:ja,strong:Ur("__"),em:Ur("*"),a:La,img:Xa};(function(){for(var e=1;e<=6;e++)Nt["h"+e]=qe(Ot("#",e)+" ",`

`)})();function Ot(e,r){return new Array(r+1).join(e)}function Ua(){var e=[],r=[],t=null,n={};function i(p,b){b=b||{};var O=Nt[p]||function(){return{}},q=O(b,t,n);r.push({end:q.end,list:t}),q.list&&(t=q.list);var I=q.anchorPosition==="before";I&&o(b),e.push(q.start||""),I||o(b)}function o(p){p.id&&e.push('<a id="'+p.id+'"></a>')}function s(p){var b=r.pop();t=b.list;var O=Wa.isFunction(b.end)?b.end():b.end;e.push(O||"")}function c(p,b){i(p,b),s()}function f(p){e.push(Va(p))}function d(){return e.join("")}return{asString:d,open:i,close:s,text:f,selfClosing:c}}Pt.writer=Ua;function Va(e){return e.replace(/\\/g,"\\\\").replace(/([\`\*_\{\}\[\]\(\)\#\+\-\.\!])/g,"\\$1")}var Za=Rt,za=Pt;kt.writer=Ka;function Ka(e){return e=e||{},e.outputFormat==="markdown"?za.writer():Za.writer(e)}var ie=B,Zr=M,Be=k,z=Ue(),ur=U,Ga=Tr,x=je(),Ya=kt;br.DocumentConverter=Ja;function Ja(e){return{convertToHtml:function(r){var t=ie.indexBy(r.type===Be.types.document?r.comments:[],"commentId"),n=new Qa(e,t);return n.convertToHtml(r)}}}function Qa(e,r){var t=1,n=[],i=[];e=ie.extend({ignoreEmptyParagraphs:!0},e);var o=e.idPrefix===void 0?"":e.idPrefix,s=e.ignoreEmptyParagraphs,c=z.topLevelElement("p"),f=e.styleMap||[];function d(u){var h=[],y=b(u,h,{}),w=[];Ct(y,function(S){S.type==="deferred"&&w.push(S)});var E={};return Zr.mapSeries(w,function(S){return S.value().then(function(L){E[S.id]=L})}).then(function(){function S(re){return ar(re,function(G){return G.type==="deferred"?E[G.id]:G.children?[ie.extend({},G,{children:S(G.children)})]:[G]})}var L=Ya.writer({prettyPrint:e.prettyPrint,outputFormat:e.outputFormat});return x.write(L,x.simplify(S(y))),new ur.Result(L.asString(),h)})}function p(u,h,y){return ar(u,function(w){return b(w,h,y)})}function b(u,h,y){if(!y)throw new Error("options not set");var w=er[u.type];return w?w(u,h,y):[]}function O(u,h,y){return q(u,h).wrap(function(){var w=p(u.children,h,y);return s?w:[x.forceWrite].concat(w)})}function q(u,h){var y=H(u);return y?y.to:(u.styleId&&h.push(zr("paragraph",u)),c)}function I(u,h,y){var w=function(){return p(u.children,h,y)},E=[];if(u.highlight!==null){var S=R({type:"highlight",color:u.highlight});S&&E.push(S)}u.isSmallCaps&&E.push(g("smallCaps")),u.isAllCaps&&E.push(g("allCaps")),u.isStrikethrough&&E.push(g("strikethrough","s")),u.isUnderline&&E.push(g("underline")),u.verticalAlignment===Be.verticalAlignment.subscript&&E.push(z.element("sub",{},{fresh:!1})),u.verticalAlignment===Be.verticalAlignment.superscript&&E.push(z.element("sup",{},{fresh:!1})),u.isItalic&&E.push(g("italic","em")),u.isBold&&E.push(g("bold","strong"));var L=z.empty,re=H(u);return re?L=re.to:u.styleId&&h.push(zr("run",u)),E.push(L),E.forEach(function(G){w=G.wrap.bind(G,w)}),w()}function g(u,h){var y=R({type:u});return y||(h?z.element(h,{},{fresh:!1}):z.empty)}function R(u,h){var y=H(u);return y?y.to:h}function H(u){for(var h=0;h<f.length;h++)if(f[h].from.matches(u))return f[h]}function ue(u){return function(h,y){return Zr.attempt(function(){return u(h,y)}).caught(function(w){return y.push(ur.error(w)),[]})}}function oe(u){return ee(u.noteType,u.noteId)}function ce(u){return P(u.noteType,u.noteId)}function ee(u,h){return X(u+"-"+h)}function P(u,h){return X(u+"-ref-"+h)}function X(u){return o+u}var ye=z.elements([z.element("table",{},{fresh:!0})]);function ge(u,h,y){return R(u,ye).wrap(function(){return fe(u,h,y)})}function fe(u,h,y){var w=ie.findIndex(u.children,function(re){return!re.type===Be.types.tableRow||!re.isHeader});w===-1&&(w=u.children.length);var E;if(w===0)E=p(u.children,h,ie.extend({},y,{isTableHeader:!1}));else{var S=p(u.children.slice(0,w),h,ie.extend({},y,{isTableHeader:!0})),L=p(u.children.slice(w),h,ie.extend({},y,{isTableHeader:!1}));E=[x.freshElement("thead",{},S),x.freshElement("tbody",{},L)]}return[x.forceWrite].concat(E)}function we(u,h,y){var w=p(u.children,h,y);return[x.freshElement("tr",{},[x.forceWrite].concat(w))]}function Ie(u,h,y){var w=y.isTableHeader?"th":"td",E=p(u.children,h,y),S={};return u.colSpan!==1&&(S.colspan=u.colSpan.toString()),u.rowSpan!==1&&(S.rowspan=u.rowSpan.toString()),[x.freshElement(w,S,[x.forceWrite].concat(E))]}function Ye(u,h,y){return R(u,z.ignore).wrap(function(){var w=r[u.commentId],E=i.length+1,S="["+ti(w)+E+"]";return i.push({label:S,comment:w}),[x.freshElement("a",{href:"#"+ee("comment",u.commentId),id:P("comment",u.commentId)},[x.text(S)])]})}function W(u,h,y){var w=u.label,E=u.comment,S=p(E.body,h,y).concat([x.nonFreshElement("p",{},[x.text(" "),x.freshElement("a",{href:"#"+P("comment",E.commentId)},[x.text("↑")])])]);return[x.freshElement("dt",{id:ee("comment",E.commentId)},[x.text("Comment "+w)]),x.freshElement("dd",{},S)]}function Je(u,h,y){return Qe(u).wrap(function(){return[]})}function Qe(u){var h=H(u);return h?h.to:u.breakType==="line"?z.topLevelElement("br"):z.empty}var er={document:function(u,h,y){var w=p(u.children,h,y),E=n.map(function(L){return u.notes.resolve(L)}),S=p(E,h,y);return w.concat([x.freshElement("ol",{},S),x.freshElement("dl",{},ar(i,function(L){return W(L,h,y)}))])},paragraph:O,run:I,text:function(u,h,y){return[x.text(u.value)]},tab:function(u,h,y){return[x.text("	")]},hyperlink:function(u,h,y){var w=u.anchor?"#"+X(u.anchor):u.href,E={href:w};u.targetFrame!=null&&(E.target=u.targetFrame);var S=p(u.children,h,y);return[x.nonFreshElement("a",E,S)]},bookmarkStart:function(u,h,y){var w=x.freshElement("a",{id:X(u.name)},[x.forceWrite]);return[w]},noteReference:function(u,h,y){n.push(u);var w=x.freshElement("a",{href:"#"+oe(u),id:ce(u)},[x.text("["+t+++"]")]);return[x.freshElement("sup",{},[w])]},note:function(u,h,y){var w=p(u.body,h,y),E=x.elementWithTag(z.element("p",{},{fresh:!1}),[x.text(" "),x.freshElement("a",{href:"#"+ce(u)},[x.text("↑")])]),S=w.concat([E]);return x.freshElement("li",{id:oe(u)},S)},commentReference:Ye,comment:W,image:ri(ue(e.convertImage||Ga.dataUri)),table:ge,tableRow:we,tableCell:Ie,break:Je};return{convertToHtml:d}}var ei=1;function ri(e){return function(r,t,n){return[{type:"deferred",id:ei++,value:function(){return e(r,t,n)}}]}}function zr(e,r){return ur.warning("Unrecognised "+e+" style: '"+r.styleName+"' (Style ID: "+r.styleId+")")}function ar(e,r){return ie.flatten(e.map(r),!0)}function Ct(e,r){e.forEach(function(t){r(t),t.children&&Ct(t.children,r)})}var ti=br.commentAuthorLabel=function(r){return r.authorInitials||""},$t={},ni=k;function Bt(e){if(e.type==="text")return e.value;if(e.type===ni.types.tab)return"	";var r=e.type==="paragraph"?`

`:"";return(e.children||[]).map(Bt).join("")+r}$t.convertElementToRawText=Bt;var Ve={},F={};F.paragraph=ai;F.run=ii;F.table=ui;F.bold=new Y("bold");F.italic=new Y("italic");F.underline=new Y("underline");F.strikethrough=new Y("strikethrough");F.allCaps=new Y("allCaps");F.smallCaps=new Y("smallCaps");F.highlight=li;F.commentReference=new Y("commentReference");F.lineBreak=new Ze({breakType:"line"});F.pageBreak=new Ze({breakType:"page"});F.columnBreak=new Ze({breakType:"column"});F.equalTo=oi;F.startsWith=ci;function ai(e){return new Y("paragraph",e)}function ii(e){return new Y("run",e)}function ui(e){return new Y("table",e)}function li(e){return new Mt(e)}function Y(e,r){r=r||{},this._elementType=e,this._styleId=r.styleId,this._styleName=r.styleName,r.list&&(this._listIndex=r.list.levelIndex,this._listIsOrdered=r.list.isOrdered)}Y.prototype.matches=function(e){return e.type===this._elementType&&(this._styleId===void 0||e.styleId===this._styleId)&&(this._styleName===void 0||e.styleName&&this._styleName.operator(this._styleName.operand,e.styleName))&&(this._listIndex===void 0||si(e,this._listIndex,this._listIsOrdered))&&(this._breakType===void 0||this._breakType===e.breakType)};function Mt(e){e=e||{},this._color=e.color}Mt.prototype.matches=function(e){return e.type==="highlight"&&(this._color===void 0||e.color===this._color)};function Ze(e){e=e||{},this._breakType=e.breakType}Ze.prototype.matches=function(e){return e.type==="break"&&(this._breakType===void 0||e.breakType===this._breakType)};function si(e,r,t){return e.numbering&&e.numbering.level==r&&e.numbering.isOrdered==t}function oi(e){return{operator:fi,operand:e}}function ci(e){return{operator:mi,operand:e}}function fi(e,r){return e.toUpperCase()===r.toUpperCase()}function mi(e,r){return r.toUpperCase().indexOf(e.toUpperCase())===0}var _t={},pi=et,di=pi.RegexTokeniser;_t.tokenise=hi;var Kr="'((?:\\\\.|[^'])*)";function hi(e){var r="(?:[a-zA-Z\\-_]|\\\\.)",t=new di([{name:"identifier",regex:new RegExp("("+r+"(?:"+r+"|[0-9])*)")},{name:"dot",regex:/\./},{name:"colon",regex:/:/},{name:"gt",regex:/>/},{name:"whitespace",regex:/\s+/},{name:"arrow",regex:/=>/},{name:"equals",regex:/=/},{name:"startsWith",regex:/\^=/},{name:"open-paren",regex:/\(/},{name:"close-paren",regex:/\)/},{name:"open-square-bracket",regex:/\[/},{name:"close-square-bracket",regex:/\]/},{name:"string",regex:new RegExp(Kr+"'")},{name:"unterminated-string",regex:new RegExp(Kr)},{name:"integer",regex:/([0-9]+)/},{name:"choice",regex:/\|/},{name:"bang",regex:/(!)/}]);return t.tokenise(e)}var vi=B,l=et,A=F,Me=Ue(),yi=_t.tokenise,ir=U;Ve.readHtmlPath=Ti;Ve.readDocumentMatcher=bi;Ve.readStyle=gi;function gi(e){return Er(Ni,e)}function wi(){return l.rules.sequence(l.rules.sequence.capture(Ft()),l.rules.tokenOfType("whitespace"),l.rules.tokenOfType("arrow"),l.rules.sequence.capture(l.rules.optional(l.rules.sequence(l.rules.tokenOfType("whitespace"),l.rules.sequence.capture(qt())).head())),l.rules.tokenOfType("end")).map(function(e,r){return{from:e,to:r.valueOrElse(Me.empty)}})}function bi(e){return Er(Ft(),e)}function Ft(){var e=l.rules.sequence,r=function(P,X){return l.rules.then(l.rules.token("identifier",P),function(){return X})},t=r("p",A.paragraph),n=r("r",A.run),i=l.rules.firstOf("p or r or table",t,n),o=l.rules.sequence(l.rules.tokenOfType("dot"),l.rules.sequence.cut(),l.rules.sequence.capture(ze)).map(function(P){return{styleId:P}}),s=l.rules.firstOf("style name matcher",l.rules.then(l.rules.sequence(l.rules.tokenOfType("equals"),l.rules.sequence.cut(),l.rules.sequence.capture(me)).head(),function(P){return{styleName:A.equalTo(P)}}),l.rules.then(l.rules.sequence(l.rules.tokenOfType("startsWith"),l.rules.sequence.cut(),l.rules.sequence.capture(me)).head(),function(P){return{styleName:A.startsWith(P)}})),c=l.rules.sequence(l.rules.tokenOfType("open-square-bracket"),l.rules.sequence.cut(),l.rules.token("identifier","style-name"),l.rules.sequence.capture(s),l.rules.tokenOfType("close-square-bracket")).head(),f=l.rules.firstOf("list type",r("ordered-list",{isOrdered:!0}),r("unordered-list",{isOrdered:!1})),d=e(l.rules.tokenOfType("colon"),e.capture(f),e.cut(),l.rules.tokenOfType("open-paren"),e.capture(Ei),l.rules.tokenOfType("close-paren")).map(function(P,X){return{list:{isOrdered:P.isOrdered,levelIndex:X-1}}});function p(P){var X=l.rules.firstOf.apply(l.rules.firstOf,["matcher suffix"].concat(P)),ye=l.rules.zeroOrMore(X);return l.rules.then(ye,function(ge){var fe={};return ge.forEach(function(we){vi.extend(fe,we)}),fe})}var b=e(e.capture(i),e.capture(p([o,c,d]))).map(function(P,X){return P(X)}),O=e(l.rules.token("identifier","table"),e.capture(p([o,c]))).map(function(P){return A.table(P)}),q=r("b",A.bold),I=r("i",A.italic),g=r("u",A.underline),R=r("strike",A.strikethrough),H=r("all-caps",A.allCaps),ue=r("small-caps",A.smallCaps),oe=e(l.rules.token("identifier","highlight"),l.rules.sequence.capture(l.rules.optional(l.rules.sequence(l.rules.tokenOfType("open-square-bracket"),l.rules.sequence.cut(),l.rules.token("identifier","color"),l.rules.tokenOfType("equals"),l.rules.sequence.capture(me),l.rules.tokenOfType("close-square-bracket")).head()))).map(function(P){return A.highlight({color:P.valueOrElse(void 0)})}),ce=r("comment-reference",A.commentReference),ee=e(l.rules.token("identifier","br"),e.cut(),l.rules.tokenOfType("open-square-bracket"),l.rules.token("identifier","type"),l.rules.tokenOfType("equals"),e.capture(me),l.rules.tokenOfType("close-square-bracket")).map(function(P){switch(P){case"line":return A.lineBreak;case"page":return A.pageBreak;case"column":return A.columnBreak}});return l.rules.firstOf("element type",b,O,q,I,g,R,H,ue,oe,ce,ee)}function Ti(e){return Er(qt(),e)}function qt(){var e=l.rules.sequence.capture,r=l.rules.tokenOfType("whitespace"),t=l.rules.then(l.rules.optional(l.rules.sequence(l.rules.tokenOfType("colon"),l.rules.token("identifier","fresh"))),function(s){return s.map(function(){return!0}).valueOrElse(!1)}),n=l.rules.then(l.rules.optional(l.rules.sequence(l.rules.tokenOfType("colon"),l.rules.token("identifier","separator"),l.rules.tokenOfType("open-paren"),e(me),l.rules.tokenOfType("close-paren")).head()),function(s){return s.valueOrElse("")}),i=l.rules.oneOrMoreWithSeparator(ze,l.rules.tokenOfType("choice")),o=l.rules.sequence(e(i),e(l.rules.zeroOrMore(Si)),e(t),e(n)).map(function(s,c,f,d){var p={},b={};return c.forEach(function(O){O.append&&p[O.name]?p[O.name]+=" "+O.value:p[O.name]=O.value}),f&&(b.fresh=!0),d&&(b.separator=d),Me.element(s,p,b)});return l.rules.firstOf("html path",l.rules.then(l.rules.tokenOfType("bang"),function(){return Me.ignore}),l.rules.then(l.rules.zeroOrMoreWithSeparator(o,l.rules.sequence(r,l.rules.tokenOfType("gt"),r)),Me.elements))}var ze=l.rules.then(l.rules.tokenOfType("identifier"),Ht),Ei=l.rules.tokenOfType("integer"),me=l.rules.then(l.rules.tokenOfType("string"),Ht),xi={n:`
`,r:"\r",t:"	"};function Ht(e){return e.replace(/\\(.)/g,function(r,t){return xi[t]||t})}var ki=l.rules.sequence(l.rules.tokenOfType("open-square-bracket"),l.rules.sequence.cut(),l.rules.sequence.capture(ze),l.rules.tokenOfType("equals"),l.rules.sequence.capture(me),l.rules.tokenOfType("close-square-bracket")).map(function(e,r){return{name:e,value:r,append:!1}}),Ri=l.rules.sequence(l.rules.tokenOfType("dot"),l.rules.sequence.cut(),l.rules.sequence.capture(ze)).map(function(e){return{name:"class",value:e,append:!0}}),Si=l.rules.firstOf("attribute or class",ki,Ri);function Er(e,r){var t=yi(r),n=l.Parser(),i=n.parseTokens(e,t);return i.isSuccess()?ir.success(i.value()):new ir.Result(null,[ir.warning(Ii(r,i))])}function Ii(e,r){return"Did not understand this style mapping, so ignored it: "+e+`
`+r.errors().map(Pi).join(`
`)}function Pi(e){return"Error was at character number "+e.characterNumber()+": Expected "+e.expected+" but got "+e.actual}var Ni=wi(),Ke={};Ke.readOptions=$i;var At=B,Oi=Ke._defaultStyleMap=["p.Heading1 => h1:fresh","p.Heading2 => h2:fresh","p.Heading3 => h3:fresh","p.Heading4 => h4:fresh","p.Heading5 => h5:fresh","p.Heading6 => h6:fresh","p[style-name='Heading 1'] => h1:fresh","p[style-name='Heading 2'] => h2:fresh","p[style-name='Heading 3'] => h3:fresh","p[style-name='Heading 4'] => h4:fresh","p[style-name='Heading 5'] => h5:fresh","p[style-name='Heading 6'] => h6:fresh","p[style-name='heading 1'] => h1:fresh","p[style-name='heading 2'] => h2:fresh","p[style-name='heading 3'] => h3:fresh","p[style-name='heading 4'] => h4:fresh","p[style-name='heading 5'] => h5:fresh","p[style-name='heading 6'] => h6:fresh","r[style-name='Strong'] => strong","p[style-name='footnote text'] => p:fresh","r[style-name='footnote reference'] =>","p[style-name='endnote text'] => p:fresh","r[style-name='endnote reference'] =>","p[style-name='annotation text'] => p:fresh","r[style-name='annotation reference'] =>","p[style-name='Footnote'] => p:fresh","r[style-name='Footnote anchor'] =>","p[style-name='Endnote'] => p:fresh","r[style-name='Endnote anchor'] =>","p:unordered-list(1) => ul > li:fresh","p:unordered-list(2) => ul|ol > li > ul > li:fresh","p:unordered-list(3) => ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:ordered-list(1) => ol > li:fresh","p:ordered-list(2) => ul|ol > li > ol > li:fresh","p:ordered-list(3) => ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","r[style-name='Hyperlink'] =>","p[style-name='Normal'] => p:fresh"],Ci=Ke._standardOptions={transformDocument:Bi,includeDefaultStyleMap:!0,includeEmbeddedStyleMap:!0};function $i(e){return e=e||{},At.extend({},Ci,e,{customStyleMap:Gr(e.styleMap),readStyleMap:function(){var r=this.customStyleMap;return this.includeEmbeddedStyleMap&&(r=r.concat(Gr(this.embeddedStyleMap))),this.includeDefaultStyleMap&&(r=r.concat(Oi)),r}})}function Gr(e){return e?At.isString(e)?e.split(`
`).map(function(r){return r.trim()}).filter(function(r){return r!==""&&r.charAt(0)!=="#"}):e:[]}function Bi(e){return e}var Dt={},Yr=M,Mi=Re;Dt.openZip=_i;function _i(e){return e.arrayBuffer?Yr.resolve(Mi.openArrayBuffer(e.arrayBuffer)):Yr.reject(new Error("Could not find file in options"))}var ve={},Jr=B;ve.paragraph=Fi;ve.run=qi;ve._elements=Lt;ve.getDescendantsOfType=Hi;ve.getDescendants=Xt;function Fi(e){return Wt("paragraph",e)}function qi(e){return Wt("run",e)}function Wt(e,r){return Lt(function(t){return t.type===e?r(t):t})}function Lt(e){return function r(t){if(t.children){var n=Jr.map(t.children,r);t=Jr.extend(t,{children:n})}return e(t)}}function Hi(e,r){return Xt(e).filter(function(t){return t.type===r})}function Xt(e){var r=[];return jt(e,function(t){r.push(t)}),r}function jt(e,r){e.children&&e.children.forEach(function(t){jt(t,r),r(t)})}var Ut={},Ai=Ue(),Di=je();Ut.element=Wi;function Wi(e){return function(r){return Di.elementWithTag(Ai.element(e),[r])}}var Li=B,Vt=lr,xr=wr,Xi=br.DocumentConverter,ji=$t.convertElementToRawText,Ui=Ve.readStyle,Vi=Ke.readOptions,Ge=Dt,Zi=U.Result;Q.convertToHtml=zi;Q.convertToMarkdown=Ki;Q.convert=kr;Q.extractRawText=Qi;Q.images=Tr;Q.transforms=ve;Q.underline=Ut;Q.embedStyleMap=eu;Q.readEmbeddedStyleMap=Gi;function zi(e,r){return kr(e,r)}function Ki(e,r){var t=Object.create(r||{});return t.outputFormat="markdown",kr(e,t)}function kr(e,r){return r=Vi(r),Ge.openZip(e).tap(function(t){return xr.readStyleMap(t).then(function(n){r.embeddedStyleMap=n})}).then(function(t){return Vt.read(t,e).then(function(n){return n.map(r.transformDocument)}).then(function(n){return Yi(n,r)})})}function Gi(e){return Ge.openZip(e).then(xr.readStyleMap)}function Yi(e,r){var t=Ji(r.readStyleMap()),n=Li.extend({},r,{styleMap:t.value}),i=new Xi(n);return e.flatMapThen(function(o){return t.flatMapThen(function(s){return i.convertToHtml(o)})})}function Ji(e){return Zi.combine((e||[]).map(Ui)).map(function(r){return r.filter(function(t){return!!t})})}function Qi(e){return Ge.openZip(e).then(Vt.read).then(function(r){return r.map(ji)})}function eu(e,r){return Ge.openZip(e).tap(function(t){return xr.writeStyleMap(t,r)}).then(function(t){return t.toArrayBuffer()}).then(function(t){return{toArrayBuffer:function(){return t},toBuffer:function(){return Buffer.from(t)}}})}Q.styleMapping=function(){throw new Error(`Use a raw string instead of mammoth.styleMapping e.g. "p[style-name='Title'] => h1" instead of mammoth.styleMapping("p[style-name='Title'] => h1")`)};export{Q as l};
