import{r as g,j as e}from"./react-87inLI7G.js";import{R as te}from"./react-quill-new-P7oPFw6w.js";import{g as oe,a as C,h as ne,i as se,P as re,j as le,R as ie,U as ae,k as ce,l as de,I as ue,b as ge,m as M,n as U,o as $,p as K,q as Q}from"./@mui-BK4dZkFY.js";import{F as pe,P as xe,T as _,a as he,A as me}from"./docx-3zAYwSwR.js";import{F as fe}from"./file-saver-i-lmDZDm.js";import{u as J,a as ye}from"./index-D539wFXm.js";import{g as be,c as we,a as je,r as Ce}from"./spellcheckApiService-89dGNqow.js";import{Q as V}from"./quill-CZy4Qc3w.js";import{b as Te}from"./react-router-zBP4Nj_3.js";import"./@xmldom-DBEIMRBk.js";import"./lodash-BOf1oiLx.js";import"./react-is-DUDD-a5e.js";import"./clsx-B-dksMZM.js";import"./@emotion-D5W7hg8W.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./@babel-DuB8yAtz.js";import"./stylis-YPZU7XtI.js";import"./react-transition-group-CJLDkAA4.js";import"./react-dom-CosTHhxT.js";import"./scheduler-CzFDRTuY.js";import"./react-router-dom-DkNWbL0q.js";import"./@remix-run-kM2C-PwP.js";import"./axios-CCb-kr4I.js";import"./parchment-Crftfyop.js";import"./quill-delta-D6FENnLs.js";import"./fast-diff-Az_-rVRq.js";import"./lodash.clonedeep-Dbfj2Hht.js";import"./lodash.isequal-KULglXUe.js";import"./eventemitter3-DJ6nYskT.js";import"./lodash-es-BKPNmaDy.js";const ke=n=>{const o=document.createElement("div");o.innerHTML=n;const l=o.innerText||o.textContent,m=new Blob([l],{type:"text/plain;charset=utf-8"}),c=document.createElement("a");c.href=URL.createObjectURL(m),c.download="document.txt",document.body.appendChild(c),c.click(),document.body.removeChild(c)},ve=async n=>{console.log(n);const o=new pe({sections:[]}),l=u=>{const d=/<strong(.*?)>(.*?)<\/strong>/g,k=/style="background-color:\s*([^;]+);"/;let s=[];return u=u.replace(d,(p,b,T)=>{const f=b.match(k),y=f?f[1]:null;return s.push(new _({text:T,bold:!0,highlight:y||void 0})),""}),u.trim()&&s.push(new _({text:u.replace(/<\/?[^>]+(>|$)/g,"")})),new he({children:s,alignment:me.LEFT})},m=n.split("<br>").map(u=>l(u));o.addSection({children:m});const c=await xe.toBlob(o);fe.saveAs(c,"document.docx"),console.log("Document created successfully")},Ee=async n=>{try{if(!n)throw new Error("No content provided for PDF download.");const o=document.createElement("iframe");o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="0",o.style.height="0",o.style.border="none",document.body.appendChild(o);const l=o.contentWindow.document;l.open(),l.write(`
      <html>
        <head>
          <title>Document PDF</title>
          <style>
            /* Add any styles you need here */
            body {
              font-family: Arial, sans-serif;
              padding: 20px;
            }
          </style>
        </head>
        <body>${n}</body>
      </html>
    `),l.close(),o.onload=()=>{o.contentWindow.focus(),o.contentWindow.print()},o.addEventListener("afterprint",()=>{document.body.removeChild(o)})}catch(o){console.error("Error downloading as PDF:",o),alert("An error occurred: "+o.message)}},Se=({text:n,quillRef:o,handleRefresh:l,handleReset:m})=>{const{language:c}=J(),u={en:{downloadTxt:"Download as .txt",downloadDocx:"Download as .docx",downloadPdf:"Download as .pdf",refresh:"Refresh",reset:"Reset",undo:"Undo",redo:"Redo",downloadSuccess:"Downloaded as {type} successfully!",downloadError:"Failed to download as {type}",downloading:"Downloading...",resetConfirmation:"Are you sure you want to reset the editor? This action cannot be undone.",emptyTextError:"Text is empty. Please add some content before downloading."},kn:{downloadTxt:".txt ರೂಪದಲ್ಲಿ ಡೌನ್‌ಲೋಡ್ ಮಾಡಿ",downloadDocx:".docx ರೂಪದಲ್ಲಿ ಡೌನ್‌ಲೋಡ್ ಮಾಡಿ",downloadPdf:".pdf ರೂಪದಲ್ಲಿ ಡೌನ್‌ಲೋಡ್ ಮಾಡಿ",refresh:"ರಿಫ್ರೆಶ್ ಮಾಡಿ",reset:"ಮರುಹೊಂದಿಸಿ",undo:"ಮರು ಕಾರ್ಯನಿರ್ವಹಣೆ",redo:"ಮರುಪಡೆಯಿರಿ",downloadSuccess:"{type} ರೂಪದಲ್ಲಿ ಯಶಸ್ವಿಯಾಗಿ ಡೌನ್‌ಲೋಡ್ ಮಾಡಲಾಗಿದೆ!",downloadError:"{type} ರೂಪದಲ್ಲಿ ವಿಫಲವಾಗಿದೆ",downloading:"ಡೌನ್‌ಲೋಡ್ ಆಗುತ್ತಿದೆ...",resetConfirmation:"ನೀವು ಸಂಪಾದಕವನ್ನು ಮರುಹೊಂದಿಸಲು ಖಚಿತವಾಗಿದ್ದೀರಾ? ಈ ಕ್ರಿಯೆವನ್ನು ಹಿಂತಿರುಗಿಸಲು ಸಾಧ್ಯವಾಗುವುದಿಲ್ಲ.",emptyTextError:"ಪಠ್ಯ ಖಾಲಿಯಾಗಿದ್ದು ಡೌನ್‌ಲೋಡ್ ಮಾಡಲು ದಯವಿಟ್ಟು ವಿಷಯವನ್ನು ಸೇರಿಸಿ."}},d=u[c]||u.en,[k,s]=g.useState(!1),[p,b]=g.useState({open:!1,message:"",type:""}),[T,f]=g.useState([]),[y,v]=g.useState(-1),[A,x]=g.useState(!1),[I,E]=g.useState(!1),N=async(h,t)=>{if(!n||n.trim()===""||n==="<p><br></p>"){E(!0);return}s(!0);try{await t(),b({open:!0,message:d.downloadSuccess.replace("{type}",h),type:"success"})}catch{b({open:!0,message:d.downloadError.replace("{type}",h),type:"error"})}s(!1)},W=()=>b({...p,open:!1}),O=()=>{var t;const h=(t=o.current)==null?void 0:t.getEditor();h&&(h.history.undo(),y>0&&v(y-1))},F=()=>{var t;const h=(t=o.current)==null?void 0:t.getEditor();h&&(h.history.redo(),y<T.length-1&&v(y+1))},L=h=>{const t=T.slice(0,y+1);t.push(h),f(t),v(t.length-1)};g.useEffect(()=>{n&&L(n)},[n]);const q=()=>{var t;const h=(t=o.current)==null?void 0:t.getEditor();h&&(h.setText(""),f([]),v(-1)),x(!1)},z=()=>{x(!0)},H=()=>{q()},P=()=>{E(!1)};return e.jsxs("div",{className:"flex justify-end space-x-4 mb-4",children:[k&&e.jsx(oe,{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"}),e.jsx(C,{variant:"contained",title:d.downloadTxt,onClick:()=>{n&&N(".txt",()=>ke(n))},sx:{minWidth:0,padding:"8px",transition:"background-color 0.3s ease","&:hover":{backgroundColor:"#3b82f6"}},children:e.jsx(ne,{})}),e.jsx(C,{variant:"contained",title:d.downloadDocx,onClick:()=>N(".docx",()=>ve(n)),sx:{minWidth:0,padding:"8px",transition:"background-color 0.3s ease","&:hover":{backgroundColor:"#10b981"}},children:e.jsx(se,{})}),e.jsx(C,{variant:"contained",title:d.downloadPdf,onClick:()=>N(".pdf",()=>Ee(n)),sx:{minWidth:0,padding:"8px",transition:"background-color 0.3s ease","&:hover":{backgroundColor:"#ef4444"}},children:e.jsx(re,{})}),e.jsx(C,{variant:"contained",title:d.refresh,onClick:l,sx:{minWidth:0,padding:"8px",transition:"background-color 0.3s ease","&:hover":{backgroundColor:"#fbbf24"}},children:e.jsx(le,{})}),e.jsx(C,{variant:"contained",title:d.reset,onClick:z,sx:{minWidth:0,padding:"8px",transition:"background-color 0.3s ease","&:hover":{backgroundColor:"#ef4444"}},children:e.jsx(ie,{})}),e.jsx(C,{variant:"contained",title:d.undo,onClick:O,sx:{minWidth:0,padding:"8px",transition:"background-color 0.3s ease","&:hover":{backgroundColor:"#3b82f6"}},children:e.jsx(ae,{})}),e.jsx(C,{variant:"contained",title:d.redo,onClick:F,sx:{minWidth:0,padding:"8px",transition:"background-color 0.3s ease","&:hover":{backgroundColor:"#3b82f6"}},children:e.jsx(ce,{})}),e.jsx(de,{open:p.open,autoHideDuration:3e3,onClose:W,message:p.message,action:e.jsx(ue,{size:"small","aria-label":"close",color:"inherit",onClick:W,children:e.jsx(ge,{fontSize:"small"})}),severity:p.type}),e.jsxs(M,{open:A,onClose:()=>x(!1),"aria-labelledby":"reset-dialog-title",children:[e.jsx(U,{id:"reset-dialog-title",children:"Reset Confirmation"}),e.jsx($,{children:e.jsx(K,{children:d.resetConfirmation})}),e.jsxs(Q,{children:[e.jsx(C,{onClick:()=>x(!1),color:"primary",children:"Cancel"}),e.jsx(C,{onClick:H,color:"primary",children:"Confirm"})]})]}),e.jsxs(M,{open:I,onClose:P,"aria-labelledby":"empty-text-dialog-title",children:[e.jsx(U,{id:"empty-text-dialog-title",children:"Error"}),e.jsx($,{children:e.jsx(K,{children:d.emptyTextError})}),e.jsx(Q,{children:e.jsx(C,{onClick:P,color:"primary",children:"OK"})})]})]})},B={correctness:{},suggestions:{}},De=(n,o,l=[])=>{B.correctness[n]=o,B.suggestions[n]=l},Ae=n=>B.suggestions[n]||[],X=["8px","9px","10px","11px","12px","14px","16px","18px","20px","22px","24px","26px","28px","36px","48px"],Y=V.import("attributors/style/size");Y.whitelist=X;V.register(Y,!0);const Ne={toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],["link","image","video","formula"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"},{list:"check"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:X}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]]},Z=[".",",","!","?",";",":"],Re=(n,o)=>{let l=o,m=o;for(;l>0&&!/\s/.test(n[l-1])&&!Z.includes(n[l-1]);)l--;for(;m<n.length&&!/\s/.test(n[m])&&!Z.includes(n[m]);)m++;return n.substring(l,m)},G=(n,o)=>{const l=n.getText().indexOf(o);n.removeFormat(l,o.length),l!==-1&&n.formatText(l,o.length,{underline:!0,color:"red",bold:!1})},We=({clickedWord:n,suggestions:o,tooltipPosition:l,setClickedWord:m,replaceWord:c,addDictionary:u,replaceAll:d,ignoreAll:k})=>{var T;const{language:s}=J(),p={en:{addToDictionary:"Add to Dictionary",replaceAll:"Replace All",ignoreAll:"Ignore All",noSuggestions:"No suggestions available."},kn:{addToDictionary:"ಪದಕೋಶಕ್ಕೆ ಸೇರಿಸಿ",replaceAll:"ಎಲ್ಲವನ್ನೂ ಬದಲಿಸಿ",ignoreAll:"ಎಲ್ಲವನ್ನೂ ನಿರ್ಲಕ್ಷಿಸಿ",noSuggestions:"ಯಾವುದೇ ಸಲಹೆಗಳಿಲ್ಲ."}},b=p[s]||p.en;return e.jsxs("div",{className:"absolute bg-white border border-green-900 p-3 mt-20 rounded shadow-lg z-40",style:{top:l.top+100,left:l.left,minWidth:"150px"},children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("strong",{className:"text-green-700",children:n}),e.jsx("span",{className:"cursor-pointer text-red-600 hover:bg-gray-600 text-3xl",onClick:()=>m(null),"aria-label":"Close",children:"×"})]}),e.jsxs("div",{className:"mt-2 space-y-2",children:[((T=o[n])==null?void 0:T.length)>0?o[n].map((f,y)=>e.jsxs("div",{children:[e.jsx("div",{className:"cursor-pointer text-blue-600 hover:bg-gray-200",onClick:()=>c(f),children:f}),y<o[n].length-1&&e.jsx("hr",{className:"my-2 border-t border-gray-300"})]},f)):e.jsx("div",{className:"text-gray-500",children:b.noSuggestions}),e.jsx("hr",{className:"my-2 border-t border-gray-300"}),e.jsx("div",{className:"cursor-pointer text-blue-600 hover:bg-gray-200",onClick:u,children:b.addToDictionary}),e.jsx("hr",{className:"my-2 border-t border-gray-300"}),e.jsx("div",{className:"cursor-pointer text-blue-600 hover:bg-gray-200",onClick:d,children:b.replaceAll}),e.jsx("hr",{className:"my-2 border-t border-gray-300"}),e.jsx("div",{className:"cursor-pointer text-blue-600 hover:bg-gray-200",onClick:k,children:b.ignoreAll})]})]})},ct=()=>{var h;const o=((h=Te().state)==null?void 0:h.uploadedContent)||"",[l,m]=g.useState(o),[c,u]=g.useState([]),[d,k]=g.useState({}),[s,p]=g.useState(null),[b,T]=g.useState({}),[f,y]=g.useState(""),[v,A]=g.useState(!1),x=g.useRef(null),I=`!@#$%^&*()_+[]{}|;:',.<>/?~-=\\"`,{wrongWords:E,setWrongWords:N}=ye();g.useEffect(()=>{var t;if(E.length>0){const i=E.filter(a=>!c.includes(a)),r=(t=x.current)==null?void 0:t.getEditor();i.forEach(a=>G(r,a)),u(a=>[...a,...i])}},[E]),g.useEffect(()=>{var i;const t=(i=x.current)==null?void 0:i.getEditor();if(t.format("size","16px"),t){const r=async a=>{if(a&&a.length===0){const S=t.getText(),j=Re(S,a.index);if(j)if(c.includes(j)){let w=Ae(j);if(w.length===0)try{w=await be(j),De(j,!1,w)}catch(R){console.error("Error fetching suggestions:",R)}p(j),k(R=>({...R,[j]:w}));const D=t.getBounds(a.index);T({top:D.top+D.height+10,left:D.left})}else p(null)}};return t.on("selection-change",r),()=>{t.off("selection-change",r)}}},[c]);const W=t=>{m(t)},O=async t=>{t.key===" "&&(clearTimeout(window.debounceTimer),window.debounceTimer=setTimeout(async()=>{var a;const i=x.current.getEditor(),r=i.getSelection();if(r){const j=i.getText(0,r.index).trim().split(/\s+/);let w=j[j.length-1].split("").filter(D=>!I.includes(D)).join("");if(w&&!/^[a-zA-Z]+$/.test(w)&&!c.includes(w)&&!(await we(w)).status){u(ee=>[...ee,w]);const R=(a=x.current)==null?void 0:a.getEditor();G(R,w)}}},300))},F=t=>{const i=x.current.getEditor(),r=i.getText().indexOf(s);r!==-1&&(i.formatText(r,s.length,{underline:!1,color:""}),i.deleteText(r,s.length),i.insertText(r,t),i.setSelection(r+t.length,0),u(c.filter(a=>a!==s)),p(null))},L=async()=>{if(s)try{const t=await je(s);if(t){const i=x.current.getEditor(),r=i.getText();let a=r.indexOf(s);if(a!==-1)for(;a!==-1;)i.formatText(a,s.length,{underline:!1,color:""}),a=r.indexOf(s,a+s.length);u(c.filter(S=>S!==s)),p(null),console.log(t)}else console.error("Failed to add the word to the dictionary.")}catch(t){console.error("Error adding word to dictionary:",t)}},q=()=>{s&&A(!0)},z=()=>{const t=x.current.getEditor(),i=t.getText();let r=0;for(;(r=i.indexOf(s,r))!==-1;)t.deleteText(r,s.length),t.insertText(r,f),r+=f.length;A(!1),p(null),y("")},H=()=>{var a;const t=(a=x.current)==null?void 0:a.getEditor(),i=t.getText();let r=i.indexOf(s);if(r!==-1)for(;r!==-1;)t.formatText(r,s.length,{underline:!1,color:""}),r=i.indexOf(s,r+s.length);p(null),u(c.filter(S=>S!==s))},P=async()=>{var r;const t=(r=x.current)==null?void 0:r.getEditor(),i=await Ce(t);i&&N(i)};return e.jsx("div",{className:"flex justify-center min-h-screen bg-gray-500 p-3",children:e.jsxs("div",{className:"w-full max-w-full bg-white rounded-lg shadow-md p-4",children:[" ",e.jsx(Se,{text:l,quillRef:x,handleRefresh:P}),e.jsx(te,{ref:x,value:l,onChange:W,onKeyDown:O,modules:Ne,className:"",style:{height:"500px",minHeight:"400px",width:"100%"}}),v&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white border border-gray-300 p-4 rounded shadow-lg w-11/12 max-w-sm mx-auto",children:[" ",e.jsxs("h5",{className:"mb-2",children:["Replace ",s," with:"]}),e.jsx("input",{type:"text",value:f,onChange:t=>y(t.target.value),className:"border border-gray-300 p-2 rounded w-full",placeholder:"Replacement word"}),e.jsxs("div",{className:"mt-4 flex justify-end",children:[e.jsx("button",{onClick:z,className:"bg-blue-500 text-white px-4 py-2 rounded mr-2",children:"Replace All"}),e.jsx("button",{onClick:()=>A(!1),className:"bg-gray-300 px-4 py-2 rounded",children:"Cancel"})]})]})}),s&&d[s]&&e.jsx(We,{clickedWord:s,suggestions:d,tooltipPosition:b,setClickedWord:p,replaceWord:F,addDictionary:L,replaceAll:q,ignoreAll:H})]})})};export{ct as default};
