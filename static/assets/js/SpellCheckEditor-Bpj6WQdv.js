import{r as x,j as e}from"./react-87inLI7G.js";import{R as ce}from"./react-quill-new-P7oPFw6w.js";import{u as se,a as de,L as ue}from"./index-Bj76g1y2.js";import{g as pe,a as v,F as ge,h as xe,P as me,R as he,i as fe,U as ye,j as we,k as be,I as je,b as Ee,l as X,m as ee,n as Ce,o as Te,p as te}from"./@mui-BzP58hmc.js";import{F as Se}from"./file-saver-i-lmDZDm.js";import{m as ve}from"./quill-to-word-CqsuKUwa.js";import{Q as G}from"./quill-CZy4Qc3w.js";import{E as ke}from"./jspdf-cGIlQrZ8.js";import De from"./html2canvas-CBrSDip1.js";import{g as Ne,c as oe,a as Ae,r as We}from"./spellcheckApiService-CvYU9Cny.js";import{b as Re}from"./react-router-ri5stJUf.js";import"./@xmldom-DBEIMRBk.js";import"./lodash-BOf1oiLx.js";import"./react-dom-CosTHhxT.js";import"./scheduler-CzFDRTuY.js";import"./react-router-dom-Bk36vaWp.js";import"./@remix-run-CGjFHglr.js";import"./axios-CCb-kr4I.js";import"./@babel-CRFnVEoO.js";import"./fflate-EnPhvkmS.js";import"./react-is-DUDD-a5e.js";import"./clsx-B-dksMZM.js";import"./@emotion-Ca6BSwXP.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./stylis-YPZU7XtI.js";import"./react-transition-group-DGTJP9RM.js";import"./parchment-Crftfyop.js";import"./quill-delta-D6FENnLs.js";import"./fast-diff-Az_-rVRq.js";import"./lodash.clonedeep-Dbfj2Hht.js";import"./lodash.isequal-KULglXUe.js";import"./eventemitter3-DJ6nYskT.js";import"./lodash-es-BKPNmaDy.js";const Z=o=>{const t=new Date,r=String(t.getDate()).padStart(2,"0"),u=String(t.getMonth()+1).padStart(2,"0"),i=t.getFullYear(),g=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0");return`spellcheck-${r}${u}${i}-${g}${l}.${o}`},ze=o=>{const t=document.createElement("div");t.innerHTML=o;const r=t.innerText||t.textContent,u=new Blob([r],{type:"text/plain;charset=utf-8"}),i=document.createElement("a");i.href=URL.createObjectURL(u),i.download=Z("txt"),document.body.appendChild(i),i.click(),document.body.removeChild(i)},Le=async o=>{if(!o){console.error("No content provided for Word download.");return}try{const t=document.createElement("div");t.style.display="none",document.body.appendChild(t);const r=new G(t,{theme:"snow"});r.clipboard.dangerouslyPasteHTML(o);const u=r.getContents(),i={exportAs:"blob"},g=await ve.generateWord(u,i);Se.saveAs(g,Z("docx")),document.body.removeChild(t)}catch(t){console.error("Error generating the Word document:",t),alert("An error occurred while generating the Word document: "+t.message)}},Ie=async o=>{try{if(!o)throw new Error("No content provided for PDF download.");const t=document.createElement("div");t.style.position="absolute",t.style.opacity="1",t.style.width="100%",t.style.padding="20px",t.style.boxSizing="border-box",t.innerHTML=o,document.body.appendChild(t),setTimeout(async()=>{const r=await De(t,{scale:2}),u=new ke,i=r.toDataURL("image/png"),g=u.internal.pageSize.getWidth(),l=u.internal.pageSize.getHeight(),h=10,s=g-2*h,m=r.height*s/r.width;if(m>l-2*h){const w=l-2*h,k=r.width*w/r.height;u.addImage(i,"PNG",h,h,k,w)}else u.addImage(i,"PNG",h,h,s,m);u.save(Z("pdf")),document.body.removeChild(t)},100)}catch(t){console.error("Error downloading as PDF:",t),alert("An error occurred: "+t.message)}},Pe=({text:o,quillRef:t,handleRefresh:r,handleReset:u})=>{const{language:i}=se(),g={en:{downloadTxt:"Download .txt",downloadDocx:"Download .docx",downloadPdf:"Download .pdf",refresh:"Refresh",reset:"Reset",undo:"Undo",redo:"Redo",downloadSuccess:"Downloaded {type}!",downloadError:"Failed to download {type}",downloading:"Downloading...",resetConfirmation:"Are you sure you want to reset the editor? This cannot be undone.",emptyTextError:"Text is empty. Please add content before downloading."},kn:{downloadTxt:".txt ರೂಪದಲ್ಲಿ ಡೌನ್‌ಲೋಡ್ ಮಾಡಿ",downloadDocx:".docx ರೂಪದಲ್ಲಿ ಡೌನ್‌ಲೋಡ್ ಮಾಡಿ",downloadPdf:".pdf ರೂಪದಲ್ಲಿ ಡೌನ್‌ಲೋಡ್ ಮಾಡಿ",refresh:"ರಿಫ್ರೆಶ್",reset:"ಮರುಹೊಂದಿಸಿ",undo:"ಮರು ಕಾರ್ಯನಿರ್ವಹಣೆ",redo:"ಮರುಪಡೆಯಿರಿ",downloadSuccess:"{type} ಯಶಸ್ವಿಯಾಗಿ ಡೌನ್‌ಲೋಡ್!",downloadError:"{type} ಡೌನ್‌ಲೋಡ್ ವಿಫಲವಾಗಿದೆ",downloading:"ಡೌನ್‌ಲೋಡ್ ಆಗುತ್ತಿದೆ...",resetConfirmation:"ನೀವು ಸಂಪಾದಕವನ್ನು ಮರುಹೊಂದಿಸಲು ಖಚಿತವಾಗಿದ್ದೀರಾ? ಹಿಂತಿರುಗಿಸಲು ಸಾಧ್ಯವಿಲ್ಲ.",emptyTextError:"ಪಠ್ಯ ಖಾಲಿ. ಡೌನ್‌ಲೋಡ್ ಮಾಡಲು ವಿಷಯ ಸೇರಿಸಿ."}},l=g[i]||g.en,[h,s]=x.useState(!1),[m,w]=x.useState({open:!1,message:"",type:""}),[k,D]=x.useState([]),[S,A]=x.useState(-1),[z,W]=x.useState(!1),[L,I]=x.useState(!1),R=async(E,b)=>{if(!o||o.trim()===""||o==="<p><br></p>"){I(!0);return}s(!0);try{await b(),w({open:!0,message:l.downloadSuccess.replace("{type}",E),type:"success"})}catch{w({open:!0,message:l.downloadError.replace("{type}",E),type:"error"})}s(!1)},y=()=>w({...m,open:!1}),$=()=>{var b;const E=(b=t.current)==null?void 0:b.getEditor();E&&(E.history.undo(),S>0&&A(S-1))},P=()=>{var b;const E=(b=t.current)==null?void 0:b.getEditor();E&&(E.history.redo(),S<k.length-1&&A(S+1))},M=E=>{const b=k.slice(0,S+1);b.push(E),D(b),A(b.length-1)};x.useEffect(()=>{o&&M(o)},[o]);const O=()=>{var b;const E=(b=t.current)==null?void 0:b.getEditor();E&&(E.setText(""),D([]),A(-1)),W(!1)},U=()=>{W(!0)},B=()=>{O()},q=()=>{I(!1)};return e.jsxs("div",{className:"flex justify-end space-x-2 mb-3",children:[h&&e.jsx(pe,{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"}),e.jsxs(v,{variant:"contained",title:l.downloadTxt,onClick:()=>R(".txt",()=>ze(o)),className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(ge,{fontSize:"small"}),e.jsx("span",{children:l.downloadTxt})]}),e.jsxs(v,{variant:"contained",title:l.downloadDocx,onClick:()=>R(".docx",()=>Le(o)),className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(xe,{fontSize:"small"}),e.jsx("span",{children:l.downloadDocx})]}),e.jsxs(v,{variant:"contained",title:l.downloadPdf,onClick:()=>R(".pdf",()=>Ie(o)),className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(me,{fontSize:"small"}),e.jsx("span",{children:l.downloadPdf})]}),e.jsxs(v,{variant:"contained",title:l.refresh,onClick:r,className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(he,{fontSize:"small"}),e.jsx("span",{children:l.refresh})]}),e.jsxs(v,{variant:"contained",title:l.reset,onClick:U,className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(fe,{fontSize:"small"}),e.jsx("span",{children:l.reset})]}),e.jsxs(v,{variant:"contained",title:l.undo,onClick:$,className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(ye,{fontSize:"small"}),e.jsx("span",{children:l.undo})]}),e.jsxs(v,{variant:"contained",title:l.redo,onClick:P,className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(we,{fontSize:"small"}),e.jsx("span",{children:l.redo})]}),e.jsx(be,{open:m.open,autoHideDuration:3e3,onClose:y,message:m.message,action:e.jsx(je,{size:"small","aria-label":"close",color:"inherit",onClick:y,children:e.jsx(Ee,{fontSize:"small"})}),severity:m.type}),e.jsxs(X,{open:z,onClose:()=>W(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(ee,{id:"alert-dialog-title",children:l.reset}),e.jsx(Ce,{children:e.jsx(Te,{id:"alert-dialog-description",children:l.resetConfirmation})}),e.jsxs(te,{children:[e.jsx(v,{onClick:()=>W(!1),color:"primary",children:"Cancel"}),e.jsx(v,{onClick:B,color:"secondary",autoFocus:!0,children:l.reset})]})]}),e.jsxs(X,{open:L,onClose:q,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(ee,{id:"alert-dialog-title",children:l.emptyTextError}),e.jsx(te,{children:e.jsx(v,{onClick:q,color:"primary",autoFocus:!0,children:"OK"})})]})]})},Q={correctness:{},suggestions:{}},Fe=(o,t,r=[])=>{Q.correctness[o]=t,Q.suggestions[o]=r},qe=o=>Q.suggestions[o]||[],re=["8px","9px","10px","11px","12px","14px","16px","18px","20px","22px","24px","26px","28px","36px","48px"],le=G.import("attributors/style/size");le.whitelist=re;G.register(le,!0);const He={toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],["link","image","video","formula"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"},{list:"check"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:re}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]]},ne=[".",",","!","?",";",":"],$e=(o,t)=>{let r=t,u=t;for(;r>0&&!/\s/.test(o[r-1])&&!ne.includes(o[r-1]);)r--;for(;u<o.length&&!/\s/.test(o[u])&&!ne.includes(o[u]);)u++;return o.substring(r,u)},F=(o,t)=>{const r=o.getText(),u=new RegExp(t,"g");let i;const g=t.length;for(;(i=u.exec(r))!==null;){const h=i.index,s=i[0].length,m=h+s,w=r[m];s===g&&(w===" "||w===void 0)&&o.formatText(h,s,{underline:!0})}document.querySelectorAll(".ql-editor u").forEach(h=>{h.innerText.includes(t)&&h.classList.add("red-underline")})},ae=document.createElement("style");ae.innerHTML=`
  .red-underline {
    text-decoration: underline;
    text-decoration-color: red;  /* Only the underline will be red */
    text-decoration-thickness: 3px;  /* Adjust underline thickness if needed */
  }
`;document.head.appendChild(ae);const H=o=>{const t=/[^\w\u0C80-\u0CFF]+/g;return o.replace(t,"")},Me=({clickedWord:o,suggestions:t,tooltipPosition:r,setClickedWord:u,replaceWord:i,addDictionary:g,replaceAll:l,ignoreAll:h})=>{var k;const{language:s}=se(),m={en:{addToDictionary:"Add to Dictionary",replaceAll:"Replace All",ignoreAll:"Ignore All",noSuggestions:"No suggestions available."},kn:{addToDictionary:"Add to Dictionary",replaceAll:"Replace All",ignoreAll:"Ignore All",noSuggestions:"ಯಾವುದೇ ಸಲಹೆಗಳಿಲ್ಲ"}},w=m[s]||m.en;return e.jsxs("div",{className:"absolute bg-white border border-green-900 p-2 mt-16 rounded shadow-lg z-40",style:{top:r.top+100,left:r.left,minWidth:"150px"},children:[e.jsx("strong",{className:"text-black",children:o}),e.jsx("span",{className:"absolute top-0 right-2 cursor-pointer text-red-600 hover:bg-gray-600 text-3xl",onClick:()=>u(null),"aria-label":"Close",children:"×"}),e.jsxs("div",{className:"mt-3 space-y-0.5",children:[" ",((k=t[o])==null?void 0:k.length)>0?t[o].map((D,S)=>e.jsxs("div",{children:[e.jsx("div",{className:"cursor-pointer text-green-700 hover:bg-gray-200 text-sm hover:font-bold",onClick:()=>i(D),children:D}),S<t[o].length-1&&e.jsx("hr",{className:"my-0 border-t border-gray-300"})]},D)):e.jsx("div",{className:"text-gray-500 text-sm",children:w.noSuggestions}),e.jsx("hr",{className:"my-1 border-t border-gray-300"}),e.jsx("div",{className:"cursor-pointer text-black hover:bg-gray-200 text-sm hover:font-bold",onClick:g,children:w.addToDictionary}),e.jsx("hr",{className:"my-1 border-t border-gray-300"}),e.jsx("div",{className:"cursor-pointer text-black hover:bg-gray-200 text-sm hover:font-bold",onClick:l,children:w.replaceAll}),e.jsx("hr",{className:"my-1 border-t border-gray-300"}),e.jsx("div",{className:"cursor-pointer text-black hover:bg-gray-200 text-sm hover:font-bold",onClick:h,children:w.ignoreAll})]})]})},jt=()=>{var J;const t=((J=Re().state)==null?void 0:J.uploadedContent)||"",[r,u]=x.useState(""),[i,g]=x.useState([]),[l,h]=x.useState({}),[s,m]=x.useState(null),[w,k]=x.useState({}),[D,S]=x.useState(""),[A,z]=x.useState(!1),[W,L]=x.useState(!1),[I,R]=x.useState(!1),y=x.useRef(null),$=`!@#$%^&*()_+[]{}|;:',.<>/?~-=\\"`,{wrongWords:P,setWrongWords:M}=de();x.useEffect(()=>{y.current&&y.current.getEditor().root.setAttribute("spellcheck","false")},[]),x.useEffect(()=>{var n;if(P.length>0){const a=P.filter(c=>!i.includes(c)),p=(n=y.current)==null?void 0:n.getEditor();a.forEach(c=>F(p,c)),g(c=>[...c,...a])}L(!1)},[P]),x.useEffect(()=>{var C;const n=(C=y.current)==null?void 0:C.getEditor(),a=()=>{R(!0)},p=()=>{R(!1)},c=async(f,d)=>{if(I&&f&&f.length===0){const T=n.getText(),j=H($e(T,f.index));if(j)if(i.includes(j)){let N=qe(j);if(N.length===0)try{N=await Ne(j),Fe(j,!1,N)}catch(K){console.error("Error fetching suggestions:",K)}m(j),h(K=>({...K,[j]:N}));const V=n.getBounds(f.index);k({top:V.bottom+90,left:V.left})}else m(null)}};return document.addEventListener("mousedown",a),document.addEventListener("mouseup",p),n.on("selection-change",c),()=>{document.removeEventListener("mousedown",a),document.removeEventListener("mouseup",p),n.off("selection-change",c)}},[i,I]),x.useEffect(()=>{var n;if(t){u(t),g([]);const a=(n=y.current)==null?void 0:n.getEditor();(async()=>{const C=a.getText().trim().split(/\s+/),f=[];for(let d of C)d=H(d),d&&!/^[a-zA-Z0-9]+$/.test(d)&&((await oe(d)).status||f.push(d));g(f),f.forEach(d=>F(a,d))})()}},[t]);const O=n=>{u(n)},U=async n=>{n.key===" "&&(clearTimeout(window.debounceTimer),window.debounceTimer=setTimeout(async()=>{var c;const a=y.current.getEditor(),p=a.getSelection();if(p){const f=a.getText(0,p.index).trim().split(/\s+/);let d=f[f.length-1].split("").filter(T=>!$.includes(T)).join("");if(i.includes(H(d)))F(a,d);else if(d&&!/^[a-zA-Z0-9]+$/.test(d)&&!(await oe(d)).status){g(N=>[...N,d]);const j=(c=y.current)==null?void 0:c.getEditor();F(j,d)}}},300))},B=n=>{const a=y.current.getEditor(),p=a.getText(),c=s.length,C=new RegExp(`(\\W|^)(${s})(\\W|$)`,"g");let f;const d=[];for(;(f=C.exec(p))!==null;){const T=f.index+f[1].length,j=c;d.push({startIndex:T,length:j})}for(let T=d.length-1;T>=0;T--){const{startIndex:j,length:N}=d[T];a.deleteText(j,N),a.insertText(j,n)}g(i.filter(T=>T!==s)),m(null)},q=async()=>{if(s)try{const n=await Ae(H(s));if(n){const a=y.current.getEditor(),p=a.getText();let c=p.indexOf(s);if(c!==-1)for(;c!==-1;)a.formatText(c,s.length,{underline:!1,color:""}),c=p.indexOf(s,c+s.length);g(i.filter(C=>C!==s)),m(null),console.log(n)}else console.error("Failed to add the word to the dictionary.")}catch(n){console.error("Error adding word to dictionary:",n)}},E=()=>{s&&z(!0)},b=()=>{const n=y.current.getEditor(),a=n.getText(),p=s.length,c=new RegExp(`(\\W|^)(${s})(\\W|$)`,"g");let C;const f=[];for(;(C=c.exec(a))!==null;){const d=C.index+C[1].length;f.push({startIndex:d,word:D,clickedWordLength:p})}f.reverse().forEach(({startIndex:d,word:T,clickedWordLength:j})=>{n.deleteText(d,j),n.insertText(d,T)}),z(!1),m(null),S("")},_=()=>{var c;const n=(c=y.current)==null?void 0:c.getEditor(),a=n.getText();let p=a.indexOf(s);if(p!==-1)for(;p!==-1;)n.formatText(p,s.length,{underline:!1,color:""}),p=a.indexOf(s,p+s.length);m(null),g(i.filter(C=>C!==s))},Y=async()=>{var p;L(!0);const n=(p=y.current)==null?void 0:p.getEditor();g([]);const a=await We(n);a&&(M(a),a.forEach(c=>F(n,c)),g(a)),L(!1)},ie=n=>{n.target.focus()};return e.jsxs("div",{className:"flex justify-center min-h-screen bg-gray-500 p-3",children:[e.jsxs("div",{className:"w-full max-w-full bg-white rounded-lg shadow-md p-4",children:[" ",e.jsx(Pe,{text:r,quillRef:y,handleRefresh:Y}),e.jsx(ce,{ref:y,value:r,onChange:O,onKeyDown:U,modules:He,className:"",style:{height:"500px",minHeight:"400px",width:"100%"}}),A&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white border border-gray-300 p-4 rounded shadow-lg w-11/12 max-w-sm mx-auto",children:[" ",e.jsxs("h5",{className:"mb-2",children:["Replace ",s," with:"]}),e.jsx("input",{type:"text",autoFocus:!0,value:D,onChange:n=>S(n.target.value),onClick:ie,className:"border border-gray-300 p-2 rounded w-full",placeholder:"Replacement word"}),e.jsxs("div",{className:"mt-4 flex justify-end",children:[e.jsx("button",{onClick:b,className:"bg-blue-500 text-white px-4 py-2 rounded mr-2",children:"Replace All"}),e.jsx("button",{onClick:()=>z(!1),className:"bg-gray-300 px-4 py-2 rounded",children:"Cancel"})]})]})}),s&&l[s]&&e.jsx(Me,{clickedWord:s,suggestions:l,tooltipPosition:w,setClickedWord:m,replaceWord:B,addDictionary:q,replaceAll:E,ignoreAll:_})]}),W&&e.jsx(ue,{})]})};export{jt as default};
