import{r as m,j as e}from"./react-87inLI7G.js";import{R as oe}from"./react-quill-new-P7oPFw6w.js";import{u as J,a as ne,L as se}from"./index-pHtZKyHr.js";import{g as re,a as C,F as le,h as ie,P as ae,R as de,i as ce,U as ue,j as pe,k as ge,I as me,b as xe,l as Q,m as G,n as he,o as fe,p as _}from"./@mui-BzP58hmc.js";import{F as ye}from"./file-saver-i-lmDZDm.js";import{m as be}from"./quill-to-word-CqsuKUwa.js";import{Q as B}from"./quill-CZy4Qc3w.js";import{E as we}from"./jspdf-cGIlQrZ8.js";import je from"./html2canvas-CBrSDip1.js";import{g as Se,c as Te,a as Ce,r as Ee}from"./spellcheckApiService-zU0XTl1Z.js";import{b as ve}from"./react-router-ri5stJUf.js";import"./@xmldom-DBEIMRBk.js";import"./lodash-BOf1oiLx.js";import"./react-dom-CosTHhxT.js";import"./scheduler-CzFDRTuY.js";import"./react-router-dom-Bk36vaWp.js";import"./@remix-run-CGjFHglr.js";import"./axios-CCb-kr4I.js";import"./@babel-CRFnVEoO.js";import"./fflate-EnPhvkmS.js";import"./react-is-DUDD-a5e.js";import"./clsx-B-dksMZM.js";import"./@emotion-Ca6BSwXP.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./stylis-YPZU7XtI.js";import"./react-transition-group-DGTJP9RM.js";import"./parchment-Crftfyop.js";import"./quill-delta-D6FENnLs.js";import"./fast-diff-Az_-rVRq.js";import"./lodash.clonedeep-Dbfj2Hht.js";import"./lodash.isequal-KULglXUe.js";import"./eventemitter3-DJ6nYskT.js";import"./lodash-es-BKPNmaDy.js";const K=o=>{const t=new Date,s=String(t.getDate()).padStart(2,"0"),u=String(t.getMonth()+1).padStart(2,"0"),a=t.getFullYear(),p=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0");return`spellcheck-${s}${u}${a}-${p}${i}.${o}`},De=o=>{const t=document.createElement("div");t.innerHTML=o;const s=t.innerText||t.textContent,u=new Blob([s],{type:"text/plain;charset=utf-8"}),a=document.createElement("a");a.href=URL.createObjectURL(u),a.download=K("txt"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},Ne=async o=>{if(!o){console.error("No content provided for Word download.");return}try{const t=document.createElement("div");t.style.display="none",document.body.appendChild(t);const s=new B(t,{theme:"snow"});s.clipboard.dangerouslyPasteHTML(o);const u=s.getContents(),a={exportAs:"blob"},p=await be.generateWord(u,a);ye.saveAs(p,K("docx")),document.body.removeChild(t)}catch(t){console.error("Error generating the Word document:",t),alert("An error occurred while generating the Word document: "+t.message)}},ke=async o=>{try{if(!o)throw new Error("No content provided for PDF download.");const t=document.createElement("div");t.style.position="absolute",t.style.opacity="1",t.style.width="100%",t.style.padding="20px",t.style.boxSizing="border-box",t.innerHTML=o,document.body.appendChild(t),setTimeout(async()=>{const s=await je(t,{scale:2}),u=new we,a=s.toDataURL("image/png"),p=u.internal.pageSize.getWidth(),i=u.internal.pageSize.getHeight(),y=10,r=p-2*y,g=s.height*r/s.width;if(g>i-2*y){const b=i-2*y,E=s.width*b/s.height;u.addImage(a,"PNG",y,y,E,b)}else u.addImage(a,"PNG",y,y,r,g);u.save(K("pdf")),document.body.removeChild(t)},100)}catch(t){console.error("Error downloading as PDF:",t),alert("An error occurred: "+t.message)}},Ae=({text:o,quillRef:t,handleRefresh:s,handleReset:u})=>{const{language:a}=J(),p={en:{downloadTxt:"Download .txt",downloadDocx:"Download .docx",downloadPdf:"Download .pdf",refresh:"Refresh",reset:"Reset",undo:"Undo",redo:"Redo",downloadSuccess:"Downloaded {type}!",downloadError:"Failed to download {type}",downloading:"Downloading...",resetConfirmation:"Are you sure you want to reset the editor? This cannot be undone.",emptyTextError:"Text is empty. Please add content before downloading."},kn:{downloadTxt:".txt ರೂಪದಲ್ಲಿ ಡೌನ್‌ಲೋಡ್ ಮಾಡಿ",downloadDocx:".docx ರೂಪದಲ್ಲಿ ಡೌನ್‌ಲೋಡ್ ಮಾಡಿ",downloadPdf:".pdf ರೂಪದಲ್ಲಿ ಡೌನ್‌ಲೋಡ್ ಮಾಡಿ",refresh:"ರಿಫ್ರೆಶ್",reset:"ಮರುಹೊಂದಿಸಿ",undo:"ಮರು ಕಾರ್ಯನಿರ್ವಹಣೆ",redo:"ಮರುಪಡೆಯಿರಿ",downloadSuccess:"{type} ಯಶಸ್ವಿಯಾಗಿ ಡೌನ್‌ಲೋಡ್!",downloadError:"{type} ಡೌನ್‌ಲೋಡ್ ವಿಫಲವಾಗಿದೆ",downloading:"ಡೌನ್‌ಲೋಡ್ ಆಗುತ್ತಿದೆ...",resetConfirmation:"ನೀವು ಸಂಪಾದಕವನ್ನು ಮರುಹೊಂದಿಸಲು ಖಚಿತವಾಗಿದ್ದೀರಾ? ಹಿಂತಿರುಗಿಸಲು ಸಾಧ್ಯವಿಲ್ಲ.",emptyTextError:"ಪಠ್ಯ ಖಾಲಿ. ಡೌನ್‌ಲೋಡ್ ಮಾಡಲು ವಿಷಯ ಸೇರಿಸಿ."}},i=p[a]||p.en,[y,r]=m.useState(!1),[g,b]=m.useState({open:!1,message:"",type:""}),[E,j]=m.useState([]),[S,v]=m.useState(-1),[z,D]=m.useState(!1),[I,f]=m.useState(!1),W=async(h,x)=>{if(!o||o.trim()===""||o==="<p><br></p>"){f(!0);return}r(!0);try{await x(),b({open:!0,message:i.downloadSuccess.replace("{type}",h),type:"success"})}catch{b({open:!0,message:i.downloadError.replace("{type}",h),type:"error"})}r(!1)},N=()=>b({...g,open:!1}),P=()=>{var x;const h=(x=t.current)==null?void 0:x.getEditor();h&&(h.history.undo(),S>0&&v(S-1))},F=()=>{var x;const h=(x=t.current)==null?void 0:x.getEditor();h&&(h.history.redo(),S<E.length-1&&v(S+1))},O=h=>{const x=E.slice(0,S+1);x.push(h),j(x),v(x.length-1)};m.useEffect(()=>{o&&O(o)},[o]);const H=()=>{var x;const h=(x=t.current)==null?void 0:x.getEditor();h&&(h.setText(""),j([]),v(-1)),D(!1)},q=()=>{D(!0)},M=()=>{H()},L=()=>{f(!1)};return e.jsxs("div",{className:"flex justify-end space-x-2 mb-3",children:[y&&e.jsx(re,{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"}),e.jsxs(C,{variant:"contained",title:i.downloadTxt,onClick:()=>W(".txt",()=>De(o)),className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(le,{fontSize:"small"}),e.jsx("span",{children:i.downloadTxt})]}),e.jsxs(C,{variant:"contained",title:i.downloadDocx,onClick:()=>W(".docx",()=>Ne(o)),className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(ie,{fontSize:"small"}),e.jsx("span",{children:i.downloadDocx})]}),e.jsxs(C,{variant:"contained",title:i.downloadPdf,onClick:()=>W(".pdf",()=>ke(o)),className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(ae,{fontSize:"small"}),e.jsx("span",{children:i.downloadPdf})]}),e.jsxs(C,{variant:"contained",title:i.refresh,onClick:s,className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(de,{fontSize:"small"}),e.jsx("span",{children:i.refresh})]}),e.jsxs(C,{variant:"contained",title:i.reset,onClick:q,className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(ce,{fontSize:"small"}),e.jsx("span",{children:i.reset})]}),e.jsxs(C,{variant:"contained",title:i.undo,onClick:P,className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(ue,{fontSize:"small"}),e.jsx("span",{children:i.undo})]}),e.jsxs(C,{variant:"contained",title:i.redo,onClick:F,className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(pe,{fontSize:"small"}),e.jsx("span",{children:i.redo})]}),e.jsx(ge,{open:g.open,autoHideDuration:3e3,onClose:N,message:g.message,action:e.jsx(me,{size:"small","aria-label":"close",color:"inherit",onClick:N,children:e.jsx(xe,{fontSize:"small"})}),severity:g.type}),e.jsxs(Q,{open:z,onClose:()=>D(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(G,{id:"alert-dialog-title",children:i.reset}),e.jsx(he,{children:e.jsx(fe,{id:"alert-dialog-description",children:i.resetConfirmation})}),e.jsxs(_,{children:[e.jsx(C,{onClick:()=>D(!1),color:"primary",children:"Cancel"}),e.jsx(C,{onClick:M,color:"secondary",autoFocus:!0,children:i.reset})]})]}),e.jsxs(Q,{open:I,onClose:L,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(G,{id:"alert-dialog-title",children:i.emptyTextError}),e.jsx(_,{children:e.jsx(C,{onClick:L,color:"primary",autoFocus:!0,children:"OK"})})]})]})},U={correctness:{},suggestions:{}},ze=(o,t,s=[])=>{U.correctness[o]=t,U.suggestions[o]=s},We=o=>U.suggestions[o]||[],V=["8px","9px","10px","11px","12px","14px","16px","18px","20px","22px","24px","26px","28px","36px","48px"],X=B.import("attributors/style/size");X.whitelist=V;B.register(X,!0);const Re={toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],["link","image","video","formula"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"},{list:"check"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:V}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]]},Y=[".",",","!","?",";",":"],Ie=(o,t)=>{let s=t,u=t;for(;s>0&&!/\s/.test(o[s-1])&&!Y.includes(o[s-1]);)s--;for(;u<o.length&&!/\s/.test(o[u])&&!Y.includes(o[u]);)u++;return o.substring(s,u)},Z=(o,t)=>{const s=o.getText().indexOf(t);s!==-1&&(o.formatText(s,t.length,{underline:!0}),o.getFormat(s,t.length).underline&&document.querySelectorAll(".ql-editor u").forEach(p=>{p.innerText.includes(t)&&p.classList.add("red-underline")}))},ee=document.createElement("style");ee.innerHTML=`
  .red-underline {
    text-decoration: underline;
    text-decoration-color: red;  /* Only the underline will be red */
    text-decoration-thickness: 3px;  /* Adjust underline thickness if needed */
  }
`;document.head.appendChild(ee);const Le=({clickedWord:o,suggestions:t,tooltipPosition:s,setClickedWord:u,replaceWord:a,addDictionary:p,replaceAll:i,ignoreAll:y})=>{var E;const{language:r}=J(),g={en:{addToDictionary:"Add to Dictionary",replaceAll:"Replace All",ignoreAll:"Ignore All",noSuggestions:"No suggestions available."},kn:{addToDictionary:"ಪದಕೋಶಕ್ಕೆ ಸೇರಿಸಿ",replaceAll:"ಎಲ್ಲವನ್ನೂ ಬದಲಿಸಿ",ignoreAll:"ಎಲ್ಲವನ್ನೂ ನಿರ್ಲಕ್ಷಿಸಿ",noSuggestions:"ಯಾವುದೇ ಸಲಹೆಗಳಿಲ್ಲ."}},b=g[r]||g.en;return e.jsxs("div",{className:"absolute bg-white border border-green-900 p-3 mt-20 rounded shadow-lg z-40",style:{top:s.top+100,left:s.left,minWidth:"150px"},children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("strong",{className:"text-green-700",children:o}),e.jsx("span",{className:"cursor-pointer text-red-600 hover:bg-gray-600 text-3xl",onClick:()=>u(null),"aria-label":"Close",children:"×"})]}),e.jsxs("div",{className:"mt-2 space-y-2",children:[((E=t[o])==null?void 0:E.length)>0?t[o].map((j,S)=>e.jsxs("div",{children:[e.jsx("div",{className:"cursor-pointer text-blue-600 hover:bg-gray-200",onClick:()=>a(j),children:j}),S<t[o].length-1&&e.jsx("hr",{className:"my-2 border-t border-gray-300"})]},j)):e.jsx("div",{className:"text-gray-500",children:b.noSuggestions}),e.jsx("hr",{className:"my-2 border-t border-gray-300"}),e.jsx("div",{className:"cursor-pointer text-blue-600 hover:bg-gray-200",onClick:p,children:b.addToDictionary}),e.jsx("hr",{className:"my-2 border-t border-gray-300"}),e.jsx("div",{className:"cursor-pointer text-blue-600 hover:bg-gray-200",onClick:i,children:b.replaceAll}),e.jsx("hr",{className:"my-2 border-t border-gray-300"}),e.jsx("div",{className:"cursor-pointer text-blue-600 hover:bg-gray-200",onClick:y,children:b.ignoreAll})]})]})},xt=()=>{var $;const t=(($=ve().state)==null?void 0:$.uploadedContent)||"",[s,u]=m.useState(t),[a,p]=m.useState([]),[i,y]=m.useState({}),[r,g]=m.useState(null),[b,E]=m.useState({}),[j,S]=m.useState(""),[v,z]=m.useState(!1),[D,I]=m.useState(!1),f=m.useRef(null),W=`!@#$%^&*()_+[]{}|;:',.<>/?~-=\\"`,{wrongWords:N,setWrongWords:P}=ne();m.useEffect(()=>{var n;if(N.length>0){const d=N.filter(c=>!a.includes(c)),l=(n=f.current)==null?void 0:n.getEditor();d.forEach(c=>Z(l,c)),p(c=>[...c,...d])}I(!1)},[N]),m.useEffect(()=>{var d;const n=(d=f.current)==null?void 0:d.getEditor();if(n.format("size","16px"),n){const l=async c=>{if(c&&c.length===0){const k=n.getText(),T=Ie(k,c.index);if(T)if(a.includes(T)){let w=We(T);if(w.length===0)try{w=await Se(T),ze(T,!1,w)}catch(R){console.error("Error fetching suggestions:",R)}g(T),y(R=>({...R,[T]:w}));const A=n.getBounds(c.index);E({top:A.top+A.height+10,left:A.left})}else g(null)}};return n.on("selection-change",l),()=>{n.off("selection-change",l)}}},[a]);const F=n=>{u(n)},O=async n=>{n.key===" "&&(clearTimeout(window.debounceTimer),window.debounceTimer=setTimeout(async()=>{var c;const d=f.current.getEditor(),l=d.getSelection();if(l){const T=d.getText(0,l.index).trim().split(/\s+/);let w=T[T.length-1].split("").filter(A=>!W.includes(A)).join("");if(w&&!/^[a-zA-Z]+$/.test(w)&&!a.includes(w)&&!(await Te(w)).status){p(te=>[...te,w]);const R=(c=f.current)==null?void 0:c.getEditor();Z(R,w)}}},300))},H=n=>{const d=f.current.getEditor(),l=d.getText().indexOf(r);l!==-1&&(d.formatText(l,r.length,{underline:!1,color:""}),d.deleteText(l,r.length),d.insertText(l,n),d.setSelection(l+n.length,0),p(a.filter(c=>c!==r)),g(null))},q=async()=>{if(r)try{const n=await Ce(r);if(n){const d=f.current.getEditor(),l=d.getText();let c=l.indexOf(r);if(c!==-1)for(;c!==-1;)d.formatText(c,r.length,{underline:!1,color:""}),c=l.indexOf(r,c+r.length);p(a.filter(k=>k!==r)),g(null),console.log(n)}else console.error("Failed to add the word to the dictionary.")}catch(n){console.error("Error adding word to dictionary:",n)}},M=()=>{r&&z(!0)},L=()=>{const n=f.current.getEditor(),d=n.getText();let l=0;for(;(l=d.indexOf(r,l))!==-1;)n.deleteText(l,r.length),n.insertText(l,j),l+=j.length;z(!1),g(null),S("")},h=()=>{var c;const n=(c=f.current)==null?void 0:c.getEditor(),d=n.getText();let l=d.indexOf(r);if(l!==-1)for(;l!==-1;)n.formatText(l,r.length,{underline:!1,color:""}),l=d.indexOf(r,l+r.length);g(null),p(a.filter(k=>k!==r))},x=async()=>{var l;I(!0);const n=(l=f.current)==null?void 0:l.getEditor(),d=await Ee(n);d&&P(d)};return e.jsxs("div",{className:"flex justify-center min-h-screen bg-gray-500 p-3",children:[e.jsxs("div",{className:"w-full max-w-full bg-white rounded-lg shadow-md p-4",children:[" ",e.jsx(Ae,{text:s,quillRef:f,handleRefresh:x}),e.jsx(oe,{ref:f,value:s,onChange:F,onKeyDown:O,modules:Re,className:"",style:{height:"500px",minHeight:"400px",width:"100%"}}),v&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white border border-gray-300 p-4 rounded shadow-lg w-11/12 max-w-sm mx-auto",children:[" ",e.jsxs("h5",{className:"mb-2",children:["Replace ",r," with:"]}),e.jsx("input",{type:"text",value:j,onChange:n=>S(n.target.value),className:"border border-gray-300 p-2 rounded w-full",placeholder:"Replacement word"}),e.jsxs("div",{className:"mt-4 flex justify-end",children:[e.jsx("button",{onClick:L,className:"bg-blue-500 text-white px-4 py-2 rounded mr-2",children:"Replace All"}),e.jsx("button",{onClick:()=>z(!1),className:"bg-gray-300 px-4 py-2 rounded",children:"Cancel"})]})]})}),r&&i[r]&&e.jsx(Le,{clickedWord:r,suggestions:i,tooltipPosition:b,setClickedWord:g,replaceWord:H,addDictionary:q,replaceAll:M,ignoreAll:h})]}),D&&e.jsx(se,{})]})};export{xt as default};
