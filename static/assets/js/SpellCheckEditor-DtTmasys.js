import{r as u,j as e}from"./react-87inLI7G.js";import{R as te}from"./react-quill-new-P7oPFw6w.js";import{u as J,a as oe,L as ne}from"./index-DKSXpQ_6.js";import{g as se,a as C,F as re,h as le,P as ie,R as ae,i as de,U as ce,j as ue,k as pe,I as xe,b as me,l as Q,m as $,n as ge,o as he,p as _}from"./@mui-rDTjNwct.js";import{F as fe}from"./file-saver-i-lmDZDm.js";import{m as ye}from"./quill-to-word-CqsuKUwa.js";import{Q as K}from"./quill-CZy4Qc3w.js";import{g as be,c as we,a as je,r as Te}from"./spellcheckApiService-CSq4zrTQ.js";import{b as Ce}from"./react-router-ri5stJUf.js";import"./@xmldom-DBEIMRBk.js";import"./lodash-BOf1oiLx.js";import"./react-dom-CosTHhxT.js";import"./scheduler-CzFDRTuY.js";import"./react-router-dom-Bk36vaWp.js";import"./@remix-run-CGjFHglr.js";import"./axios-CCb-kr4I.js";import"./react-is-DUDD-a5e.js";import"./clsx-B-dksMZM.js";import"./@emotion-CqTsbBQu.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./@babel-DuB8yAtz.js";import"./stylis-YPZU7XtI.js";import"./react-transition-group-CJLDkAA4.js";import"./parchment-Crftfyop.js";import"./quill-delta-D6FENnLs.js";import"./fast-diff-Az_-rVRq.js";import"./lodash.clonedeep-Dbfj2Hht.js";import"./lodash.isequal-KULglXUe.js";import"./eventemitter3-DJ6nYskT.js";import"./lodash-es-BKPNmaDy.js";const Ee=o=>{const t=document.createElement("div");t.innerHTML=o;const r=t.innerText||t.textContent,x=new Blob([r],{type:"text/plain;charset=utf-8"}),c=document.createElement("a");c.href=URL.createObjectURL(x),c.download="document.txt",document.body.appendChild(c),c.click(),document.body.removeChild(c)},Se=async o=>{if(!o){console.error("No content provided for Word download.");return}try{const t=document.createElement("div");t.style.display="none",document.body.appendChild(t);const r=new K(t,{theme:"snow"});r.clipboard.dangerouslyPasteHTML(o);const x=r.getContents(),c={exportAs:"blob"},m=await ye.generateWord(x,c);fe.saveAs(m,"word-export.docx"),document.body.removeChild(t)}catch(t){console.error("Error generating the Word document:",t),alert("An error occurred while generating the Word document: "+t.message)}},ve=async o=>{try{if(!o)throw new Error("No content provided for PDF download.");const t=document.createElement("iframe");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="0",t.style.height="0",t.style.border="none",document.body.appendChild(t);const r=t.contentWindow.document;r.open(),r.write(`
      <html>
        <head>
          <title>Document PDF</title>
          <style>
            /* Add any styles you need here */
            body {
              font-family: Arial, sans-serif;
              padding: 20px;
            }
          </style>
        </head>
        <body>${o}</body>
      </html>
    `),r.close(),t.onload=()=>{t.contentWindow.focus(),t.contentWindow.print()},t.addEventListener("afterprint",()=>{document.body.removeChild(t)})}catch(t){console.error("Error downloading as PDF:",t),alert("An error occurred: "+t.message)}},De=({text:o,quillRef:t,handleRefresh:r,handleReset:x})=>{const{language:c}=J(),m={en:{downloadTxt:"Download .txt",downloadDocx:"Download .docx",downloadPdf:"Download .pdf",refresh:"Refresh",reset:"Reset",undo:"Undo",redo:"Redo",downloadSuccess:"Downloaded {type}!",downloadError:"Failed to download {type}",downloading:"Downloading...",resetConfirmation:"Are you sure you want to reset the editor? This cannot be undone.",emptyTextError:"Text is empty. Please add content before downloading."},kn:{downloadTxt:".txt ರೂಪದಲ್ಲಿ ಡೌನ್‌ಲೋಡ್ ಮಾಡಿ",downloadDocx:".docx ರೂಪದಲ್ಲಿ ಡೌನ್‌ಲೋಡ್ ಮಾಡಿ",downloadPdf:".pdf ರೂಪದಲ್ಲಿ ಡೌನ್‌ಲೋಡ್ ಮಾಡಿ",refresh:"ರಿಫ್ರೆಶ್",reset:"ಮರುಹೊಂದಿಸಿ",undo:"ಮರು ಕಾರ್ಯನಿರ್ವಹಣೆ",redo:"ಮರುಪಡೆಯಿರಿ",downloadSuccess:"{type} ಯಶಸ್ವಿಯಾಗಿ ಡೌನ್‌ಲೋಡ್!",downloadError:"{type} ಡೌನ್‌ಲೋಡ್ ವಿಫಲವಾಗಿದೆ",downloading:"ಡೌನ್‌ಲೋಡ್ ಆಗುತ್ತಿದೆ...",resetConfirmation:"ನೀವು ಸಂಪಾದಕವನ್ನು ಮರುಹೊಂದಿಸಲು ಖಚಿತವಾಗಿದ್ದೀರಾ? ಹಿಂತಿರುಗಿಸಲು ಸಾಧ್ಯವಿಲ್ಲ.",emptyTextError:"ಪಠ್ಯ ಖಾಲಿ. ಡೌನ್‌ಲೋಡ್ ಮಾಡಲು ವಿಷಯ ಸೇರಿಸಿ."}},i=m[c]||m.en,[A,l]=u.useState(!1),[g,b]=u.useState({open:!1,message:"",type:""}),[E,w]=u.useState([]),[j,S]=u.useState(-1),[z,v]=u.useState(!1),[I,f]=u.useState(!1),W=async(h,p)=>{if(!o||o.trim()===""||o==="<p><br></p>"){f(!0);return}l(!0);try{await p(),b({open:!0,message:i.downloadSuccess.replace("{type}",h),type:"success"})}catch{b({open:!0,message:i.downloadError.replace("{type}",h),type:"error"})}l(!1)},D=()=>b({...g,open:!1}),P=()=>{var p;const h=(p=t.current)==null?void 0:p.getEditor();h&&(h.history.undo(),j>0&&S(j-1))},F=()=>{var p;const h=(p=t.current)==null?void 0:p.getEditor();h&&(h.history.redo(),j<E.length-1&&S(j+1))},O=h=>{const p=E.slice(0,j+1);p.push(h),w(p),S(p.length-1)};u.useEffect(()=>{o&&O(o)},[o]);const q=()=>{var p;const h=(p=t.current)==null?void 0:p.getEditor();h&&(h.setText(""),w([]),S(-1)),v(!1)},H=()=>{v(!0)},B=()=>{q()},L=()=>{f(!1)};return e.jsxs("div",{className:"flex justify-end space-x-2 mb-3",children:[A&&e.jsx(se,{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"}),e.jsxs(C,{variant:"contained",title:i.downloadTxt,onClick:()=>W(".txt",()=>Ee(o)),className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(re,{fontSize:"small"}),e.jsx("span",{children:i.downloadTxt})]}),e.jsxs(C,{variant:"contained",title:i.downloadDocx,onClick:()=>W(".docx",()=>Se(o)),className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(le,{fontSize:"small"}),e.jsx("span",{children:i.downloadDocx})]}),e.jsxs(C,{variant:"contained",title:i.downloadPdf,onClick:()=>W(".pdf",()=>ve(o)),className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(ie,{fontSize:"small"}),e.jsx("span",{children:i.downloadPdf})]}),e.jsxs(C,{variant:"contained",title:i.refresh,onClick:r,className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(ae,{fontSize:"small"}),e.jsx("span",{children:i.refresh})]}),e.jsxs(C,{variant:"contained",title:i.reset,onClick:H,className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(de,{fontSize:"small"}),e.jsx("span",{children:i.reset})]}),e.jsxs(C,{variant:"contained",title:i.undo,onClick:P,className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(ce,{fontSize:"small"}),e.jsx("span",{children:i.undo})]}),e.jsxs(C,{variant:"contained",title:i.redo,onClick:F,className:"flex items-center space-x-1",sx:{padding:"6px",fontSize:"0.8rem"},children:[e.jsx(ue,{fontSize:"small"}),e.jsx("span",{children:i.redo})]}),e.jsx(pe,{open:g.open,autoHideDuration:3e3,onClose:D,message:g.message,action:e.jsx(xe,{size:"small","aria-label":"close",color:"inherit",onClick:D,children:e.jsx(me,{fontSize:"small"})}),severity:g.type}),e.jsxs(Q,{open:z,onClose:()=>v(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx($,{id:"alert-dialog-title",children:i.reset}),e.jsx(ge,{children:e.jsx(he,{id:"alert-dialog-description",children:i.resetConfirmation})}),e.jsxs(_,{children:[e.jsx(C,{onClick:()=>v(!1),color:"primary",children:"Cancel"}),e.jsx(C,{onClick:B,color:"secondary",autoFocus:!0,children:i.reset})]})]}),e.jsxs(Q,{open:I,onClose:L,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx($,{id:"alert-dialog-title",children:i.emptyTextError}),e.jsx(_,{children:e.jsx(C,{onClick:L,color:"primary",autoFocus:!0,children:"OK"})})]})]})},U={correctness:{},suggestions:{}},ke=(o,t,r=[])=>{U.correctness[o]=t,U.suggestions[o]=r},Ne=o=>U.suggestions[o]||[],V=["8px","9px","10px","11px","12px","14px","16px","18px","20px","22px","24px","26px","28px","36px","48px"],X=K.import("attributors/style/size");X.whitelist=V;K.register(X,!0);const Ae={toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],["link","image","video","formula"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"},{list:"check"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:V}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]]},Z=[".",",","!","?",";",":"],ze=(o,t)=>{let r=t,x=t;for(;r>0&&!/\s/.test(o[r-1])&&!Z.includes(o[r-1]);)r--;for(;x<o.length&&!/\s/.test(o[x])&&!Z.includes(o[x]);)x++;return o.substring(r,x)},G=(o,t)=>{const r=o.getText().indexOf(t);r!==-1&&(o.formatText(r,t.length,{underline:!0}),o.getFormat(r,t.length).underline&&document.querySelectorAll(".ql-editor u").forEach(m=>{m.innerText.includes(t)&&m.classList.add("red-underline")}))},Y=document.createElement("style");Y.innerHTML=`
  .red-underline {
    text-decoration: underline;
    text-decoration-color: red;  /* Only the underline will be red */
    text-decoration-thickness: 3px;  /* Adjust underline thickness if needed */
  }
`;document.head.appendChild(Y);const We=({clickedWord:o,suggestions:t,tooltipPosition:r,setClickedWord:x,replaceWord:c,addDictionary:m,replaceAll:i,ignoreAll:A})=>{var E;const{language:l}=J(),g={en:{addToDictionary:"Add to Dictionary",replaceAll:"Replace All",ignoreAll:"Ignore All",noSuggestions:"No suggestions available."},kn:{addToDictionary:"ಪದಕೋಶಕ್ಕೆ ಸೇರಿಸಿ",replaceAll:"ಎಲ್ಲವನ್ನೂ ಬದಲಿಸಿ",ignoreAll:"ಎಲ್ಲವನ್ನೂ ನಿರ್ಲಕ್ಷಿಸಿ",noSuggestions:"ಯಾವುದೇ ಸಲಹೆಗಳಿಲ್ಲ."}},b=g[l]||g.en;return e.jsxs("div",{className:"absolute bg-white border border-green-900 p-3 mt-20 rounded shadow-lg z-40",style:{top:r.top+100,left:r.left,minWidth:"150px"},children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("strong",{className:"text-green-700",children:o}),e.jsx("span",{className:"cursor-pointer text-red-600 hover:bg-gray-600 text-3xl",onClick:()=>x(null),"aria-label":"Close",children:"×"})]}),e.jsxs("div",{className:"mt-2 space-y-2",children:[((E=t[o])==null?void 0:E.length)>0?t[o].map((w,j)=>e.jsxs("div",{children:[e.jsx("div",{className:"cursor-pointer text-blue-600 hover:bg-gray-200",onClick:()=>c(w),children:w}),j<t[o].length-1&&e.jsx("hr",{className:"my-2 border-t border-gray-300"})]},w)):e.jsx("div",{className:"text-gray-500",children:b.noSuggestions}),e.jsx("hr",{className:"my-2 border-t border-gray-300"}),e.jsx("div",{className:"cursor-pointer text-blue-600 hover:bg-gray-200",onClick:m,children:b.addToDictionary}),e.jsx("hr",{className:"my-2 border-t border-gray-300"}),e.jsx("div",{className:"cursor-pointer text-blue-600 hover:bg-gray-200",onClick:i,children:b.replaceAll}),e.jsx("hr",{className:"my-2 border-t border-gray-300"}),e.jsx("div",{className:"cursor-pointer text-blue-600 hover:bg-gray-200",onClick:A,children:b.ignoreAll})]})]})},dt=()=>{var M;const t=((M=Ce().state)==null?void 0:M.uploadedContent)||"",[r,x]=u.useState(t),[c,m]=u.useState([]),[i,A]=u.useState({}),[l,g]=u.useState(null),[b,E]=u.useState({}),[w,j]=u.useState(""),[S,z]=u.useState(!1),[v,I]=u.useState(!1),f=u.useRef(null),W=`!@#$%^&*()_+[]{}|;:',.<>/?~-=\\"`,{wrongWords:D,setWrongWords:P}=oe();u.useEffect(()=>{var n;if(D.length>0){const a=D.filter(d=>!c.includes(d)),s=(n=f.current)==null?void 0:n.getEditor();a.forEach(d=>G(s,d)),m(d=>[...d,...a])}I(!1)},[D]),u.useEffect(()=>{var a;const n=(a=f.current)==null?void 0:a.getEditor();if(n.format("size","16px"),n){const s=async d=>{if(d&&d.length===0){const k=n.getText(),T=ze(k,d.index);if(T)if(c.includes(T)){let y=Ne(T);if(y.length===0)try{y=await be(T),ke(T,!1,y)}catch(R){console.error("Error fetching suggestions:",R)}g(T),A(R=>({...R,[T]:y}));const N=n.getBounds(d.index);E({top:N.top+N.height+10,left:N.left})}else g(null)}};return n.on("selection-change",s),()=>{n.off("selection-change",s)}}},[c]);const F=n=>{x(n)},O=async n=>{n.key===" "&&(clearTimeout(window.debounceTimer),window.debounceTimer=setTimeout(async()=>{var d;const a=f.current.getEditor(),s=a.getSelection();if(s){const T=a.getText(0,s.index).trim().split(/\s+/);let y=T[T.length-1].split("").filter(N=>!W.includes(N)).join("");if(y&&!/^[a-zA-Z]+$/.test(y)&&!c.includes(y)&&!(await we(y)).status){m(ee=>[...ee,y]);const R=(d=f.current)==null?void 0:d.getEditor();G(R,y)}}},300))},q=n=>{const a=f.current.getEditor(),s=a.getText().indexOf(l);s!==-1&&(a.formatText(s,l.length,{underline:!1,color:""}),a.deleteText(s,l.length),a.insertText(s,n),a.setSelection(s+n.length,0),m(c.filter(d=>d!==l)),g(null))},H=async()=>{if(l)try{const n=await je(l);if(n){const a=f.current.getEditor(),s=a.getText();let d=s.indexOf(l);if(d!==-1)for(;d!==-1;)a.formatText(d,l.length,{underline:!1,color:""}),d=s.indexOf(l,d+l.length);m(c.filter(k=>k!==l)),g(null),console.log(n)}else console.error("Failed to add the word to the dictionary.")}catch(n){console.error("Error adding word to dictionary:",n)}},B=()=>{l&&z(!0)},L=()=>{const n=f.current.getEditor(),a=n.getText();let s=0;for(;(s=a.indexOf(l,s))!==-1;)n.deleteText(s,l.length),n.insertText(s,w),s+=w.length;z(!1),g(null),j("")},h=()=>{var d;const n=(d=f.current)==null?void 0:d.getEditor(),a=n.getText();let s=a.indexOf(l);if(s!==-1)for(;s!==-1;)n.formatText(s,l.length,{underline:!1,color:""}),s=a.indexOf(l,s+l.length);g(null),m(c.filter(k=>k!==l))},p=async()=>{var s;I(!0);const n=(s=f.current)==null?void 0:s.getEditor(),a=await Te(n);a&&P(a)};return e.jsxs("div",{className:"flex justify-center min-h-screen bg-gray-500 p-3",children:[e.jsxs("div",{className:"w-full max-w-full bg-white rounded-lg shadow-md p-4",children:[" ",e.jsx(De,{text:r,quillRef:f,handleRefresh:p}),e.jsx(te,{ref:f,value:r,onChange:F,onKeyDown:O,modules:Ae,className:"",style:{height:"500px",minHeight:"400px",width:"100%"}}),S&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white border border-gray-300 p-4 rounded shadow-lg w-11/12 max-w-sm mx-auto",children:[" ",e.jsxs("h5",{className:"mb-2",children:["Replace ",l," with:"]}),e.jsx("input",{type:"text",value:w,onChange:n=>j(n.target.value),className:"border border-gray-300 p-2 rounded w-full",placeholder:"Replacement word"}),e.jsxs("div",{className:"mt-4 flex justify-end",children:[e.jsx("button",{onClick:L,className:"bg-blue-500 text-white px-4 py-2 rounded mr-2",children:"Replace All"}),e.jsx("button",{onClick:()=>z(!1),className:"bg-gray-300 px-4 py-2 rounded",children:"Cancel"})]})]})}),l&&i[l]&&e.jsx(We,{clickedWord:l,suggestions:i,tooltipPosition:b,setClickedWord:g,replaceWord:q,addDictionary:H,replaceAll:B,ignoreAll:h})]}),v&&e.jsx(ne,{})]})};export{dt as default};
