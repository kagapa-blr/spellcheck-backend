import{r as p,j as e}from"./react-87inLI7G.js";import{R as se}from"./react-quill-new-BmZa2bVb.js";import{u as V,a as re,L as le}from"./index-C9dsG2Cu.js";import{g as ie,a as E,h as ae,i as ce,P as de,j as ue,R as pe,U as xe,k as ge,l as he,I as me,b as fe,m as _,n as K,o as Q,p as $,q as X}from"./@mui-XpaLtuFH.js";import{F as ye,P as be,a as we,A as je,T as Z}from"./docx-3zAYwSwR.js";import{F as Ce}from"./file-saver-i-lmDZDm.js";import{g as Te,c as Ee,a as ke,r as ve}from"./spellcheckApiService-hm7mHLH1.js";import{Q as Y}from"./quill-D-ZqWAlK.js";import{b as Se}from"./react-router-zBP4Nj_3.js";import"./@xmldom-DBEIMRBk.js";import"./lodash-BOf1oiLx.js";import"./react-dom-CosTHhxT.js";import"./scheduler-CzFDRTuY.js";import"./react-router-dom-DkNWbL0q.js";import"./@remix-run-kM2C-PwP.js";import"./axios-CCb-kr4I.js";import"./react-is-DUDD-a5e.js";import"./clsx-B-dksMZM.js";import"./@emotion-CqTsbBQu.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./@babel-DuB8yAtz.js";import"./stylis-YPZU7XtI.js";import"./react-transition-group-CJLDkAA4.js";import"./quill-delta-D6FENnLs.js";import"./fast-diff-Az_-rVRq.js";import"./lodash.clonedeep-Dbfj2Hht.js";import"./lodash.isequal-KULglXUe.js";import"./eventemitter3-DJ6nYskT.js";import"./lodash-es-BKPNmaDy.js";const De=o=>{const t=document.createElement("div");t.innerHTML=o;const l=t.innerText||t.textContent,m=new Blob([l],{type:"text/plain;charset=utf-8"}),d=document.createElement("a");d.href=URL.createObjectURL(m),d.download="document.txt",document.body.appendChild(d),d.click(),document.body.removeChild(d)},Ne=async o=>{const t=new ye({sections:[]}),l=x=>{const u=[],k=document.createElement("div");k.innerHTML=x;const s=c=>{if(c.nodeType===Node.TEXT_NODE)u.push(new Z({text:c.textContent}));else if(c.nodeType===Node.ELEMENT_NODE){let g={};switch(c.tagName.toLowerCase()){case"strong":g.bold=!0;break;case"em":g.italics=!0;break;case"u":g.underline=!0;break;case"span":const w=c.style.backgroundColor;w&&(g.highlight=w);break}u.push(new Z({text:c.textContent,...g}))}Array.from(c.childNodes).forEach(s)};return Array.from(k.childNodes).forEach(s),new we({children:u,alignment:je.LEFT})},m=o.split("<br>").map(x=>l(x));t.addSection({children:m});const d=await be.toBlob(t);Ce.saveAs(d,"document.docx"),console.log("Document created successfully")},Ae=async o=>{try{if(!o)throw new Error("No content provided for PDF download.");const t=document.createElement("iframe");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="0",t.style.height="0",t.style.border="none",document.body.appendChild(t);const l=t.contentWindow.document;l.open(),l.write(`
      <html>
        <head>
          <title>Document PDF</title>
          <style>
            /* Add any styles you need here */
            body {
              font-family: Arial, sans-serif;
              padding: 20px;
            }
          </style>
        </head>
        <body>${o}</body>
      </html>
    `),l.close(),t.onload=()=>{t.contentWindow.focus(),t.contentWindow.print()},t.addEventListener("afterprint",()=>{document.body.removeChild(t)})}catch(t){console.error("Error downloading as PDF:",t),alert("An error occurred: "+t.message)}},We=({text:o,quillRef:t,handleRefresh:l,handleReset:m})=>{const{language:d}=V(),x={en:{downloadTxt:"Download as .txt",downloadDocx:"Download as .docx",downloadPdf:"Download as .pdf",refresh:"Refresh",reset:"Reset",undo:"Undo",redo:"Redo",downloadSuccess:"Downloaded as {type} successfully!",downloadError:"Failed to download as {type}",downloading:"Downloading...",resetConfirmation:"Are you sure you want to reset the editor? This action cannot be undone.",emptyTextError:"Text is empty. Please add some content before downloading."},kn:{downloadTxt:".txt ರೂಪದಲ್ಲಿ ಡೌನ್‌ಲೋಡ್ ಮಾಡಿ",downloadDocx:".docx ರೂಪದಲ್ಲಿ ಡೌನ್‌ಲೋಡ್ ಮಾಡಿ",downloadPdf:".pdf ರೂಪದಲ್ಲಿ ಡೌನ್‌ಲೋಡ್ ಮಾಡಿ",refresh:"ರಿಫ್ರೆಶ್ ಮಾಡಿ",reset:"ಮರುಹೊಂದಿಸಿ",undo:"ಮರು ಕಾರ್ಯನಿರ್ವಹಣೆ",redo:"ಮರುಪಡೆಯಿರಿ",downloadSuccess:"{type} ರೂಪದಲ್ಲಿ ಯಶಸ್ವಿಯಾಗಿ ಡೌನ್‌ಲೋಡ್ ಮಾಡಲಾಗಿದೆ!",downloadError:"{type} ರೂಪದಲ್ಲಿ ವಿಫಲವಾಗಿದೆ",downloading:"ಡೌನ್‌ಲೋಡ್ ಆಗುತ್ತಿದೆ...",resetConfirmation:"ನೀವು ಸಂಪಾದಕವನ್ನು ಮರುಹೊಂದಿಸಲು ಖಚಿತವಾಗಿದ್ದೀರಾ? ಈ ಕ್ರಿಯೆವನ್ನು ಹಿಂತಿರುಗಿಸಲು ಸಾಧ್ಯವಾಗುವುದಿಲ್ಲ.",emptyTextError:"ಪಠ್ಯ ಖಾಲಿಯಾಗಿದ್ದು ಡೌನ್‌ಲೋಡ್ ಮಾಡಲು ದಯವಿಟ್ಟು ವಿಷಯವನ್ನು ಸೇರಿಸಿ."}},u=x[d]||x.en,[k,s]=p.useState(!1),[c,g]=p.useState({open:!1,message:"",type:""}),[w,j]=p.useState([]),[C,v]=p.useState(-1),[W,S]=p.useState(!1),[P,y]=p.useState(!1),R=async(f,h)=>{if(!o||o.trim()===""||o==="<p><br></p>"){y(!0);return}s(!0);try{await h(),g({open:!0,message:u.downloadSuccess.replace("{type}",f),type:"success"})}catch{g({open:!0,message:u.downloadError.replace("{type}",f),type:"error"})}s(!1)},D=()=>g({...c,open:!1}),I=()=>{var h;const f=(h=t.current)==null?void 0:h.getEditor();f&&(f.history.undo(),C>0&&v(C-1))},F=()=>{var h;const f=(h=t.current)==null?void 0:h.getEditor();f&&(f.history.redo(),C<w.length-1&&v(C+1))},q=f=>{const h=w.slice(0,C+1);h.push(f),j(h),v(h.length-1)};p.useEffect(()=>{o&&q(o)},[o]);const z=()=>{var h;const f=(h=t.current)==null?void 0:h.getEditor();f&&(f.setText(""),j([]),v(-1)),S(!1)},H=()=>{S(!0)},M=()=>{z()},O=()=>{y(!1)};return e.jsxs("div",{className:"flex justify-end space-x-4 mb-4",children:[k&&e.jsx(ie,{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"}),e.jsx(E,{variant:"contained",title:u.downloadTxt,onClick:()=>{o&&R(".txt",()=>De(o))},sx:{minWidth:0,padding:"8px",transition:"background-color 0.3s ease","&:hover":{backgroundColor:"#3b82f6"}},children:e.jsx(ae,{})}),e.jsx(E,{variant:"contained",title:u.downloadDocx,onClick:()=>R(".docx",()=>Ne(o)),sx:{minWidth:0,padding:"8px",transition:"background-color 0.3s ease","&:hover":{backgroundColor:"#10b981"}},children:e.jsx(ce,{})}),e.jsx(E,{variant:"contained",title:u.downloadPdf,onClick:()=>R(".pdf",()=>Ae(o)),sx:{minWidth:0,padding:"8px",transition:"background-color 0.3s ease","&:hover":{backgroundColor:"#ef4444"}},children:e.jsx(de,{})}),e.jsx(E,{variant:"contained",title:u.refresh,onClick:l,sx:{minWidth:0,padding:"8px",transition:"background-color 0.3s ease","&:hover":{backgroundColor:"#fbbf24"}},children:e.jsx(ue,{})}),e.jsx(E,{variant:"contained",title:u.reset,onClick:H,sx:{minWidth:0,padding:"8px",transition:"background-color 0.3s ease","&:hover":{backgroundColor:"#ef4444"}},children:e.jsx(pe,{})}),e.jsx(E,{variant:"contained",title:u.undo,onClick:I,sx:{minWidth:0,padding:"8px",transition:"background-color 0.3s ease","&:hover":{backgroundColor:"#3b82f6"}},children:e.jsx(xe,{})}),e.jsx(E,{variant:"contained",title:u.redo,onClick:F,sx:{minWidth:0,padding:"8px",transition:"background-color 0.3s ease","&:hover":{backgroundColor:"#3b82f6"}},children:e.jsx(ge,{})}),e.jsx(he,{open:c.open,autoHideDuration:3e3,onClose:D,message:c.message,action:e.jsx(me,{size:"small","aria-label":"close",color:"inherit",onClick:D,children:e.jsx(fe,{fontSize:"small"})}),severity:c.type}),e.jsxs(_,{open:W,onClose:()=>S(!1),"aria-labelledby":"reset-dialog-title",children:[e.jsx(K,{id:"reset-dialog-title",children:"Reset Confirmation"}),e.jsx(Q,{children:e.jsx($,{children:u.resetConfirmation})}),e.jsxs(X,{children:[e.jsx(E,{onClick:()=>S(!1),color:"primary",children:"Cancel"}),e.jsx(E,{onClick:M,color:"primary",children:"Confirm"})]})]}),e.jsxs(_,{open:P,onClose:O,"aria-labelledby":"empty-text-dialog-title",children:[e.jsx(K,{id:"empty-text-dialog-title",children:"Error"}),e.jsx(Q,{children:e.jsx($,{children:u.emptyTextError})}),e.jsx(X,{children:e.jsx(E,{onClick:O,color:"primary",children:"OK"})})]})]})},U={correctness:{},suggestions:{}},Re=(o,t,l=[])=>{U.correctness[o]=t,U.suggestions[o]=l},Le=o=>U.suggestions[o]||[],ee=["8px","9px","10px","11px","12px","14px","16px","18px","20px","22px","24px","26px","28px","36px","48px"],te=Y.import("attributors/style/size");te.whitelist=ee;Y.register(te,!0);const Pe={toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],["link","image","video","formula"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"},{list:"check"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:ee}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]]},G=[".",",","!","?",";",":"],Oe=(o,t)=>{let l=t,m=t;for(;l>0&&!/\s/.test(o[l-1])&&!G.includes(o[l-1]);)l--;for(;m<o.length&&!/\s/.test(o[m])&&!G.includes(o[m]);)m++;return o.substring(l,m)},J=(o,t)=>{const l=o.getText().indexOf(t);l!==-1&&(o.formatText(l,t.length,{underline:!0}),o.getFormat(l,t.length).underline&&document.querySelectorAll(".ql-editor u").forEach(x=>{x.innerText.includes(t)&&x.classList.add("red-underline")}))},oe=document.createElement("style");oe.innerHTML=`
  .red-underline {
    text-decoration: underline;
    text-decoration-color: red;  /* Only the underline will be red */
    text-decoration-thickness: 3px;  /* Adjust underline thickness if needed */
  }
`;document.head.appendChild(oe);const Ie=({clickedWord:o,suggestions:t,tooltipPosition:l,setClickedWord:m,replaceWord:d,addDictionary:x,replaceAll:u,ignoreAll:k})=>{var w;const{language:s}=V(),c={en:{addToDictionary:"Add to Dictionary",replaceAll:"Replace All",ignoreAll:"Ignore All",noSuggestions:"No suggestions available."},kn:{addToDictionary:"ಪದಕೋಶಕ್ಕೆ ಸೇರಿಸಿ",replaceAll:"ಎಲ್ಲವನ್ನೂ ಬದಲಿಸಿ",ignoreAll:"ಎಲ್ಲವನ್ನೂ ನಿರ್ಲಕ್ಷಿಸಿ",noSuggestions:"ಯಾವುದೇ ಸಲಹೆಗಳಿಲ್ಲ."}},g=c[s]||c.en;return e.jsxs("div",{className:"absolute bg-white border border-green-900 p-3 mt-20 rounded shadow-lg z-40",style:{top:l.top+100,left:l.left,minWidth:"150px"},children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("strong",{className:"text-green-700",children:o}),e.jsx("span",{className:"cursor-pointer text-red-600 hover:bg-gray-600 text-3xl",onClick:()=>m(null),"aria-label":"Close",children:"×"})]}),e.jsxs("div",{className:"mt-2 space-y-2",children:[((w=t[o])==null?void 0:w.length)>0?t[o].map((j,C)=>e.jsxs("div",{children:[e.jsx("div",{className:"cursor-pointer text-blue-600 hover:bg-gray-200",onClick:()=>d(j),children:j}),C<t[o].length-1&&e.jsx("hr",{className:"my-2 border-t border-gray-300"})]},j)):e.jsx("div",{className:"text-gray-500",children:g.noSuggestions}),e.jsx("hr",{className:"my-2 border-t border-gray-300"}),e.jsx("div",{className:"cursor-pointer text-blue-600 hover:bg-gray-200",onClick:x,children:g.addToDictionary}),e.jsx("hr",{className:"my-2 border-t border-gray-300"}),e.jsx("div",{className:"cursor-pointer text-blue-600 hover:bg-gray-200",onClick:u,children:g.replaceAll}),e.jsx("hr",{className:"my-2 border-t border-gray-300"}),e.jsx("div",{className:"cursor-pointer text-blue-600 hover:bg-gray-200",onClick:k,children:g.ignoreAll})]})]})},pt=()=>{var B;const t=((B=Se().state)==null?void 0:B.uploadedContent)||"",[l,m]=p.useState(t),[d,x]=p.useState([]),[u,k]=p.useState({}),[s,c]=p.useState(null),[g,w]=p.useState({}),[j,C]=p.useState(""),[v,W]=p.useState(!1),[S,P]=p.useState(!1),y=p.useRef(null),R=`!@#$%^&*()_+[]{}|;:',.<>/?~-=\\"`,{wrongWords:D,setWrongWords:I}=re();p.useEffect(()=>{var n;if(D.length>0){const i=D.filter(a=>!d.includes(a)),r=(n=y.current)==null?void 0:n.getEditor();i.forEach(a=>J(r,a)),x(a=>[...a,...i])}P(!1)},[D]),p.useEffect(()=>{var i;const n=(i=y.current)==null?void 0:i.getEditor();if(n.format("size","16px"),n){const r=async a=>{if(a&&a.length===0){const N=n.getText(),T=Oe(N,a.index);if(T)if(d.includes(T)){let b=Le(T);if(b.length===0)try{b=await Te(T),Re(T,!1,b)}catch(L){console.error("Error fetching suggestions:",L)}c(T),k(L=>({...L,[T]:b}));const A=n.getBounds(a.index);w({top:A.top+A.height+10,left:A.left})}else c(null)}};return n.on("selection-change",r),()=>{n.off("selection-change",r)}}},[d]);const F=n=>{m(n)},q=async n=>{n.key===" "&&(clearTimeout(window.debounceTimer),window.debounceTimer=setTimeout(async()=>{var a;const i=y.current.getEditor(),r=i.getSelection();if(r){const T=i.getText(0,r.index).trim().split(/\s+/);let b=T[T.length-1].split("").filter(A=>!R.includes(A)).join("");if(b&&!/^[a-zA-Z]+$/.test(b)&&!d.includes(b)&&!(await Ee(b)).status){x(ne=>[...ne,b]);const L=(a=y.current)==null?void 0:a.getEditor();J(L,b)}}},300))},z=n=>{const i=y.current.getEditor(),r=i.getText().indexOf(s);r!==-1&&(i.formatText(r,s.length,{underline:!1,color:""}),i.deleteText(r,s.length),i.insertText(r,n),i.setSelection(r+n.length,0),x(d.filter(a=>a!==s)),c(null))},H=async()=>{if(s)try{const n=await ke(s);if(n){const i=y.current.getEditor(),r=i.getText();let a=r.indexOf(s);if(a!==-1)for(;a!==-1;)i.formatText(a,s.length,{underline:!1,color:""}),a=r.indexOf(s,a+s.length);x(d.filter(N=>N!==s)),c(null),console.log(n)}else console.error("Failed to add the word to the dictionary.")}catch(n){console.error("Error adding word to dictionary:",n)}},M=()=>{s&&W(!0)},O=()=>{const n=y.current.getEditor(),i=n.getText();let r=0;for(;(r=i.indexOf(s,r))!==-1;)n.deleteText(r,s.length),n.insertText(r,j),r+=j.length;W(!1),c(null),C("")},f=()=>{var a;const n=(a=y.current)==null?void 0:a.getEditor(),i=n.getText();let r=i.indexOf(s);if(r!==-1)for(;r!==-1;)n.formatText(r,s.length,{underline:!1,color:""}),r=i.indexOf(s,r+s.length);c(null),x(d.filter(N=>N!==s))},h=async()=>{var r;P(!0);const n=(r=y.current)==null?void 0:r.getEditor(),i=await ve(n);i&&I(i)};return e.jsxs("div",{className:"flex justify-center min-h-screen bg-gray-500 p-3",children:[e.jsxs("div",{className:"w-full max-w-full bg-white rounded-lg shadow-md p-4",children:[" ",e.jsx(We,{text:l,quillRef:y,handleRefresh:h}),e.jsx(se,{ref:y,value:l,onChange:F,onKeyDown:q,modules:Pe,className:"",style:{height:"500px",minHeight:"400px",width:"100%"}}),v&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white border border-gray-300 p-4 rounded shadow-lg w-11/12 max-w-sm mx-auto",children:[" ",e.jsxs("h5",{className:"mb-2",children:["Replace ",s," with:"]}),e.jsx("input",{type:"text",value:j,onChange:n=>C(n.target.value),className:"border border-gray-300 p-2 rounded w-full",placeholder:"Replacement word"}),e.jsxs("div",{className:"mt-4 flex justify-end",children:[e.jsx("button",{onClick:O,className:"bg-blue-500 text-white px-4 py-2 rounded mr-2",children:"Replace All"}),e.jsx("button",{onClick:()=>W(!1),className:"bg-gray-300 px-4 py-2 rounded",children:"Cancel"})]})]})}),s&&u[s]&&e.jsx(Ie,{clickedWord:s,suggestions:u,tooltipPosition:g,setClickedWord:c,replaceWord:z,addDictionary:H,replaceAll:M,ignoreAll:f})]}),S&&e.jsx(le,{})]})};export{pt as default};
