import{I as yt}from"./iobuffer-BmLRrqXH.js";function F(i){let t=i.length;for(;--t>=0;)i[t]=0}const mt=3,At=258,qe=29,Ot=256,Ut=Ot+1+qe,Je=30,vt=512,Rt=new Array((Ut+2)*2);F(Rt);const Tt=new Array(Je*2);F(Tt);const Ct=new Array(vt);F(Ct);const Nt=new Array(At-mt+1);F(Nt);const Dt=new Array(qe);F(Dt);const St=new Array(Je);F(St);const It=(i,t,e,a)=>{let o=i&65535|0,n=i>>>16&65535|0,l=0;for(;e!==0;){l=e>2e3?2e3:e,e-=l;do o=o+t[a++]|0,n=n+o|0;while(--l);o%=65521,n%=65521}return o|n<<16|0};var le=It;const Mt=()=>{let i,t=[];for(var e=0;e<256;e++){i=e;for(var a=0;a<8;a++)i=i&1?3988292384^i>>>1:i>>>1;t[e]=i}return t},$t=new Uint32Array(Mt()),Zt=(i,t,e,a)=>{const o=$t,n=a+e;i^=-1;for(let l=a;l<n;l++)i=i>>>8^o[(i^t[l])&255];return i^-1};var N=Zt,ce={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Qe={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Ft=(i,t)=>Object.prototype.hasOwnProperty.call(i,t);var Lt=function(i){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const e=t.shift();if(e){if(typeof e!="object")throw new TypeError(e+"must be non-object");for(const a in e)Ft(e,a)&&(i[a]=e[a])}}return i},Ht=i=>{let t=0;for(let a=0,o=i.length;a<o;a++)t+=i[a].length;const e=new Uint8Array(t);for(let a=0,o=0,n=i.length;a<n;a++){let l=i[a];e.set(l,o),o+=l.length}return e},et={assign:Lt,flattenChunks:Ht};let tt=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{tt=!1}const H=new Uint8Array(256);for(let i=0;i<256;i++)H[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;H[254]=H[254]=1;var Bt=i=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(i);let t,e,a,o,n,l=i.length,f=0;for(o=0;o<l;o++)e=i.charCodeAt(o),(e&64512)===55296&&o+1<l&&(a=i.charCodeAt(o+1),(a&64512)===56320&&(e=65536+(e-55296<<10)+(a-56320),o++)),f+=e<128?1:e<2048?2:e<65536?3:4;for(t=new Uint8Array(f),n=0,o=0;n<f;o++)e=i.charCodeAt(o),(e&64512)===55296&&o+1<l&&(a=i.charCodeAt(o+1),(a&64512)===56320&&(e=65536+(e-55296<<10)+(a-56320),o++)),e<128?t[n++]=e:e<2048?(t[n++]=192|e>>>6,t[n++]=128|e&63):e<65536?(t[n++]=224|e>>>12,t[n++]=128|e>>>6&63,t[n++]=128|e&63):(t[n++]=240|e>>>18,t[n++]=128|e>>>12&63,t[n++]=128|e>>>6&63,t[n++]=128|e&63);return t};const Pt=(i,t)=>{if(t<65534&&i.subarray&&tt)return String.fromCharCode.apply(null,i.length===t?i:i.subarray(0,t));let e="";for(let a=0;a<t;a++)e+=String.fromCharCode(i[a]);return e};var Kt=(i,t)=>{const e=t||i.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(i.subarray(0,t));let a,o;const n=new Array(e*2);for(o=0,a=0;a<e;){let l=i[a++];if(l<128){n[o++]=l;continue}let f=H[l];if(f>4){n[o++]=65533,a+=f-1;continue}for(l&=f===2?31:f===3?15:7;f>1&&a<e;)l=l<<6|i[a++]&63,f--;if(f>1){n[o++]=65533;continue}l<65536?n[o++]=l:(l-=65536,n[o++]=55296|l>>10&1023,n[o++]=56320|l&1023)}return Pt(n,o)},zt=(i,t)=>{t=t||i.length,t>i.length&&(t=i.length);let e=t-1;for(;e>=0&&(i[e]&192)===128;)e--;return e<0||e===0?t:e+H[i[e]]>t?e:t},de={string2buf:Bt,buf2string:Kt,utf8border:zt};function Gt(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Yt=Gt;const G=16209,Wt=16191;var Xt=function(t,e){let a,o,n,l,f,p,s,r,w,d,h,_,v,k,x,A,b,c,y,R,u,O,m,g;const E=t.state;a=t.next_in,m=t.input,o=a+(t.avail_in-5),n=t.next_out,g=t.output,l=n-(e-t.avail_out),f=n+(t.avail_out-257),p=E.dmax,s=E.wsize,r=E.whave,w=E.wnext,d=E.window,h=E.hold,_=E.bits,v=E.lencode,k=E.distcode,x=(1<<E.lenbits)-1,A=(1<<E.distbits)-1;e:do{_<15&&(h+=m[a++]<<_,_+=8,h+=m[a++]<<_,_+=8),b=v[h&x];t:for(;;){if(c=b>>>24,h>>>=c,_-=c,c=b>>>16&255,c===0)g[n++]=b&65535;else if(c&16){y=b&65535,c&=15,c&&(_<c&&(h+=m[a++]<<_,_+=8),y+=h&(1<<c)-1,h>>>=c,_-=c),_<15&&(h+=m[a++]<<_,_+=8,h+=m[a++]<<_,_+=8),b=k[h&A];i:for(;;){if(c=b>>>24,h>>>=c,_-=c,c=b>>>16&255,c&16){if(R=b&65535,c&=15,_<c&&(h+=m[a++]<<_,_+=8,_<c&&(h+=m[a++]<<_,_+=8)),R+=h&(1<<c)-1,R>p){t.msg="invalid distance too far back",E.mode=G;break e}if(h>>>=c,_-=c,c=n-l,R>c){if(c=R-c,c>r&&E.sane){t.msg="invalid distance too far back",E.mode=G;break e}if(u=0,O=d,w===0){if(u+=s-c,c<y){y-=c;do g[n++]=d[u++];while(--c);u=n-R,O=g}}else if(w<c){if(u+=s+w-c,c-=w,c<y){y-=c;do g[n++]=d[u++];while(--c);if(u=0,w<y){c=w,y-=c;do g[n++]=d[u++];while(--c);u=n-R,O=g}}}else if(u+=w-c,c<y){y-=c;do g[n++]=d[u++];while(--c);u=n-R,O=g}for(;y>2;)g[n++]=O[u++],g[n++]=O[u++],g[n++]=O[u++],y-=3;y&&(g[n++]=O[u++],y>1&&(g[n++]=O[u++]))}else{u=n-R;do g[n++]=g[u++],g[n++]=g[u++],g[n++]=g[u++],y-=3;while(y>2);y&&(g[n++]=g[u++],y>1&&(g[n++]=g[u++]))}}else if((c&64)===0){b=k[(b&65535)+(h&(1<<c)-1)];continue i}else{t.msg="invalid distance code",E.mode=G;break e}break}}else if((c&64)===0){b=v[(b&65535)+(h&(1<<c)-1)];continue t}else if(c&32){E.mode=Wt;break e}else{t.msg="invalid literal/length code",E.mode=G;break e}break}}while(a<o&&n<f);y=_>>3,a-=y,_-=y<<3,h&=(1<<_)-1,t.next_in=a,t.next_out=n,t.avail_in=a<o?5+(o-a):5-(a-o),t.avail_out=n<f?257+(f-n):257-(n-f),E.hold=h,E.bits=_};const Z=15,_e=852,we=592,pe=0,Q=1,ge=2,Vt=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),jt=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),qt=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Jt=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Qt=(i,t,e,a,o,n,l,f)=>{const p=f.bits;let s=0,r=0,w=0,d=0,h=0,_=0,v=0,k=0,x=0,A=0,b,c,y,R,u,O=null,m;const g=new Uint16Array(Z+1),E=new Uint16Array(Z+1);let I=null,ue,K,z;for(s=0;s<=Z;s++)g[s]=0;for(r=0;r<a;r++)g[t[e+r]]++;for(h=p,d=Z;d>=1&&g[d]===0;d--);if(h>d&&(h=d),d===0)return o[n++]=1<<24|64<<16|0,o[n++]=1<<24|64<<16|0,f.bits=1,0;for(w=1;w<d&&g[w]===0;w++);for(h<w&&(h=w),k=1,s=1;s<=Z;s++)if(k<<=1,k-=g[s],k<0)return-1;if(k>0&&(i===pe||d!==1))return-1;for(E[1]=0,s=1;s<Z;s++)E[s+1]=E[s]+g[s];for(r=0;r<a;r++)t[e+r]!==0&&(l[E[t[e+r]]++]=r);if(i===pe?(O=I=l,m=20):i===Q?(O=Vt,I=jt,m=257):(O=qt,I=Jt,m=0),A=0,r=0,s=w,u=n,_=h,v=0,y=-1,x=1<<h,R=x-1,i===Q&&x>_e||i===ge&&x>we)return 1;for(;;){ue=s-v,l[r]+1<m?(K=0,z=l[r]):l[r]>=m?(K=I[l[r]-m],z=O[l[r]-m]):(K=96,z=0),b=1<<s-v,c=1<<_,w=c;do c-=b,o[u+(A>>v)+c]=ue<<24|K<<16|z|0;while(c!==0);for(b=1<<s-1;A&b;)b>>=1;if(b!==0?(A&=b-1,A+=b):A=0,r++,--g[s]===0){if(s===d)break;s=t[e+l[r]]}if(s>h&&(A&R)!==y){for(v===0&&(v=h),u+=w,_=s-v,k=1<<_;_+v<d&&(k-=g[_+v],!(k<=0));)_++,k<<=1;if(x+=1<<_,i===Q&&x>_e||i===ge&&x>we)return 1;y=A&R,o[y]=h<<24|_<<16|u-n|0}}return A!==0&&(o[u+A]=s-v<<24|64<<16|0),f.bits=h,0};var L=Qt;const ei=0,it=1,nt=2,{Z_FINISH:xe,Z_BLOCK:ti,Z_TREES:Y,Z_OK:M,Z_STREAM_END:ii,Z_NEED_DICT:ni,Z_STREAM_ERROR:C,Z_DATA_ERROR:at,Z_MEM_ERROR:st,Z_BUF_ERROR:ai,Z_DEFLATED:be}=Qe,J=16180,ke=16181,Ee=16182,ye=16183,me=16184,Ae=16185,Oe=16186,Ue=16187,ve=16188,Re=16189,q=16190,D=16191,ee=16192,Te=16193,te=16194,Ce=16195,Ne=16196,De=16197,Se=16198,W=16199,X=16200,Ie=16201,Me=16202,$e=16203,Ze=16204,Fe=16205,ie=16206,Le=16207,He=16208,U=16209,rt=16210,ot=16211,si=852,ri=592,oi=15,fi=oi,Be=i=>(i>>>24&255)+(i>>>8&65280)+((i&65280)<<8)+((i&255)<<24);function hi(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const $=i=>{if(!i)return 1;const t=i.state;return!t||t.strm!==i||t.mode<J||t.mode>ot?1:0},ft=i=>{if($(i))return C;const t=i.state;return i.total_in=i.total_out=t.total=0,i.msg="",t.wrap&&(i.adler=t.wrap&1),t.mode=J,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(si),t.distcode=t.distdyn=new Int32Array(ri),t.sane=1,t.back=-1,M},ht=i=>{if($(i))return C;const t=i.state;return t.wsize=0,t.whave=0,t.wnext=0,ft(i)},lt=(i,t)=>{let e;if($(i))return C;const a=i.state;return t<0?(e=0,t=-t):(e=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?C:(a.window!==null&&a.wbits!==t&&(a.window=null),a.wrap=e,a.wbits=t,ht(i))},ct=(i,t)=>{if(!i)return C;const e=new hi;i.state=e,e.strm=i,e.window=null,e.mode=J;const a=lt(i,t);return a!==M&&(i.state=null),a},li=i=>ct(i,fi);let Pe=!0,ne,ae;const ci=i=>{if(Pe){ne=new Int32Array(512),ae=new Int32Array(32);let t=0;for(;t<144;)i.lens[t++]=8;for(;t<256;)i.lens[t++]=9;for(;t<280;)i.lens[t++]=7;for(;t<288;)i.lens[t++]=8;for(L(it,i.lens,0,288,ne,0,i.work,{bits:9}),t=0;t<32;)i.lens[t++]=5;L(nt,i.lens,0,32,ae,0,i.work,{bits:5}),Pe=!1}i.lencode=ne,i.lenbits=9,i.distcode=ae,i.distbits=5},dt=(i,t,e,a)=>{let o;const n=i.state;return n.window===null&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new Uint8Array(n.wsize)),a>=n.wsize?(n.window.set(t.subarray(e-n.wsize,e),0),n.wnext=0,n.whave=n.wsize):(o=n.wsize-n.wnext,o>a&&(o=a),n.window.set(t.subarray(e-a,e-a+o),n.wnext),a-=o,a?(n.window.set(t.subarray(e-a,e),0),n.wnext=a,n.whave=n.wsize):(n.wnext+=o,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=o))),0},di=(i,t)=>{let e,a,o,n,l,f,p,s,r,w,d,h,_,v,k=0,x,A,b,c,y,R,u,O;const m=new Uint8Array(4);let g,E;const I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if($(i)||!i.output||!i.input&&i.avail_in!==0)return C;e=i.state,e.mode===D&&(e.mode=ee),l=i.next_out,o=i.output,p=i.avail_out,n=i.next_in,a=i.input,f=i.avail_in,s=e.hold,r=e.bits,w=f,d=p,O=M;e:for(;;)switch(e.mode){case J:if(e.wrap===0){e.mode=ee;break}for(;r<16;){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}if(e.wrap&2&&s===35615){e.wbits===0&&(e.wbits=15),e.check=0,m[0]=s&255,m[1]=s>>>8&255,e.check=N(e.check,m,2,0),s=0,r=0,e.mode=ke;break}if(e.head&&(e.head.done=!1),!(e.wrap&1)||(((s&255)<<8)+(s>>8))%31){i.msg="incorrect header check",e.mode=U;break}if((s&15)!==be){i.msg="unknown compression method",e.mode=U;break}if(s>>>=4,r-=4,u=(s&15)+8,e.wbits===0&&(e.wbits=u),u>15||u>e.wbits){i.msg="invalid window size",e.mode=U;break}e.dmax=1<<e.wbits,e.flags=0,i.adler=e.check=1,e.mode=s&512?Re:D,s=0,r=0;break;case ke:for(;r<16;){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}if(e.flags=s,(e.flags&255)!==be){i.msg="unknown compression method",e.mode=U;break}if(e.flags&57344){i.msg="unknown header flags set",e.mode=U;break}e.head&&(e.head.text=s>>8&1),e.flags&512&&e.wrap&4&&(m[0]=s&255,m[1]=s>>>8&255,e.check=N(e.check,m,2,0)),s=0,r=0,e.mode=Ee;case Ee:for(;r<32;){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}e.head&&(e.head.time=s),e.flags&512&&e.wrap&4&&(m[0]=s&255,m[1]=s>>>8&255,m[2]=s>>>16&255,m[3]=s>>>24&255,e.check=N(e.check,m,4,0)),s=0,r=0,e.mode=ye;case ye:for(;r<16;){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}e.head&&(e.head.xflags=s&255,e.head.os=s>>8),e.flags&512&&e.wrap&4&&(m[0]=s&255,m[1]=s>>>8&255,e.check=N(e.check,m,2,0)),s=0,r=0,e.mode=me;case me:if(e.flags&1024){for(;r<16;){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}e.length=s,e.head&&(e.head.extra_len=s),e.flags&512&&e.wrap&4&&(m[0]=s&255,m[1]=s>>>8&255,e.check=N(e.check,m,2,0)),s=0,r=0}else e.head&&(e.head.extra=null);e.mode=Ae;case Ae:if(e.flags&1024&&(h=e.length,h>f&&(h=f),h&&(e.head&&(u=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(a.subarray(n,n+h),u)),e.flags&512&&e.wrap&4&&(e.check=N(e.check,a,h,n)),f-=h,n+=h,e.length-=h),e.length))break e;e.length=0,e.mode=Oe;case Oe:if(e.flags&2048){if(f===0)break e;h=0;do u=a[n+h++],e.head&&u&&e.length<65536&&(e.head.name+=String.fromCharCode(u));while(u&&h<f);if(e.flags&512&&e.wrap&4&&(e.check=N(e.check,a,h,n)),f-=h,n+=h,u)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=Ue;case Ue:if(e.flags&4096){if(f===0)break e;h=0;do u=a[n+h++],e.head&&u&&e.length<65536&&(e.head.comment+=String.fromCharCode(u));while(u&&h<f);if(e.flags&512&&e.wrap&4&&(e.check=N(e.check,a,h,n)),f-=h,n+=h,u)break e}else e.head&&(e.head.comment=null);e.mode=ve;case ve:if(e.flags&512){for(;r<16;){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}if(e.wrap&4&&s!==(e.check&65535)){i.msg="header crc mismatch",e.mode=U;break}s=0,r=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),i.adler=e.check=0,e.mode=D;break;case Re:for(;r<32;){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}i.adler=e.check=Be(s),s=0,r=0,e.mode=q;case q:if(e.havedict===0)return i.next_out=l,i.avail_out=p,i.next_in=n,i.avail_in=f,e.hold=s,e.bits=r,ni;i.adler=e.check=1,e.mode=D;case D:if(t===ti||t===Y)break e;case ee:if(e.last){s>>>=r&7,r-=r&7,e.mode=ie;break}for(;r<3;){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}switch(e.last=s&1,s>>>=1,r-=1,s&3){case 0:e.mode=Te;break;case 1:if(ci(e),e.mode=W,t===Y){s>>>=2,r-=2;break e}break;case 2:e.mode=Ne;break;case 3:i.msg="invalid block type",e.mode=U}s>>>=2,r-=2;break;case Te:for(s>>>=r&7,r-=r&7;r<32;){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}if((s&65535)!==(s>>>16^65535)){i.msg="invalid stored block lengths",e.mode=U;break}if(e.length=s&65535,s=0,r=0,e.mode=te,t===Y)break e;case te:e.mode=Ce;case Ce:if(h=e.length,h){if(h>f&&(h=f),h>p&&(h=p),h===0)break e;o.set(a.subarray(n,n+h),l),f-=h,n+=h,p-=h,l+=h,e.length-=h;break}e.mode=D;break;case Ne:for(;r<14;){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}if(e.nlen=(s&31)+257,s>>>=5,r-=5,e.ndist=(s&31)+1,s>>>=5,r-=5,e.ncode=(s&15)+4,s>>>=4,r-=4,e.nlen>286||e.ndist>30){i.msg="too many length or distance symbols",e.mode=U;break}e.have=0,e.mode=De;case De:for(;e.have<e.ncode;){for(;r<3;){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}e.lens[I[e.have++]]=s&7,s>>>=3,r-=3}for(;e.have<19;)e.lens[I[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,g={bits:e.lenbits},O=L(ei,e.lens,0,19,e.lencode,0,e.work,g),e.lenbits=g.bits,O){i.msg="invalid code lengths set",e.mode=U;break}e.have=0,e.mode=Se;case Se:for(;e.have<e.nlen+e.ndist;){for(;k=e.lencode[s&(1<<e.lenbits)-1],x=k>>>24,A=k>>>16&255,b=k&65535,!(x<=r);){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}if(b<16)s>>>=x,r-=x,e.lens[e.have++]=b;else{if(b===16){for(E=x+2;r<E;){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}if(s>>>=x,r-=x,e.have===0){i.msg="invalid bit length repeat",e.mode=U;break}u=e.lens[e.have-1],h=3+(s&3),s>>>=2,r-=2}else if(b===17){for(E=x+3;r<E;){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}s>>>=x,r-=x,u=0,h=3+(s&7),s>>>=3,r-=3}else{for(E=x+7;r<E;){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}s>>>=x,r-=x,u=0,h=11+(s&127),s>>>=7,r-=7}if(e.have+h>e.nlen+e.ndist){i.msg="invalid bit length repeat",e.mode=U;break}for(;h--;)e.lens[e.have++]=u}}if(e.mode===U)break;if(e.lens[256]===0){i.msg="invalid code -- missing end-of-block",e.mode=U;break}if(e.lenbits=9,g={bits:e.lenbits},O=L(it,e.lens,0,e.nlen,e.lencode,0,e.work,g),e.lenbits=g.bits,O){i.msg="invalid literal/lengths set",e.mode=U;break}if(e.distbits=6,e.distcode=e.distdyn,g={bits:e.distbits},O=L(nt,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,g),e.distbits=g.bits,O){i.msg="invalid distances set",e.mode=U;break}if(e.mode=W,t===Y)break e;case W:e.mode=X;case X:if(f>=6&&p>=258){i.next_out=l,i.avail_out=p,i.next_in=n,i.avail_in=f,e.hold=s,e.bits=r,Xt(i,d),l=i.next_out,o=i.output,p=i.avail_out,n=i.next_in,a=i.input,f=i.avail_in,s=e.hold,r=e.bits,e.mode===D&&(e.back=-1);break}for(e.back=0;k=e.lencode[s&(1<<e.lenbits)-1],x=k>>>24,A=k>>>16&255,b=k&65535,!(x<=r);){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}if(A&&(A&240)===0){for(c=x,y=A,R=b;k=e.lencode[R+((s&(1<<c+y)-1)>>c)],x=k>>>24,A=k>>>16&255,b=k&65535,!(c+x<=r);){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}s>>>=c,r-=c,e.back+=c}if(s>>>=x,r-=x,e.back+=x,e.length=b,A===0){e.mode=Fe;break}if(A&32){e.back=-1,e.mode=D;break}if(A&64){i.msg="invalid literal/length code",e.mode=U;break}e.extra=A&15,e.mode=Ie;case Ie:if(e.extra){for(E=e.extra;r<E;){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}e.length+=s&(1<<e.extra)-1,s>>>=e.extra,r-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=Me;case Me:for(;k=e.distcode[s&(1<<e.distbits)-1],x=k>>>24,A=k>>>16&255,b=k&65535,!(x<=r);){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}if((A&240)===0){for(c=x,y=A,R=b;k=e.distcode[R+((s&(1<<c+y)-1)>>c)],x=k>>>24,A=k>>>16&255,b=k&65535,!(c+x<=r);){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}s>>>=c,r-=c,e.back+=c}if(s>>>=x,r-=x,e.back+=x,A&64){i.msg="invalid distance code",e.mode=U;break}e.offset=b,e.extra=A&15,e.mode=$e;case $e:if(e.extra){for(E=e.extra;r<E;){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}e.offset+=s&(1<<e.extra)-1,s>>>=e.extra,r-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){i.msg="invalid distance too far back",e.mode=U;break}e.mode=Ze;case Ze:if(p===0)break e;if(h=d-p,e.offset>h){if(h=e.offset-h,h>e.whave&&e.sane){i.msg="invalid distance too far back",e.mode=U;break}h>e.wnext?(h-=e.wnext,_=e.wsize-h):_=e.wnext-h,h>e.length&&(h=e.length),v=e.window}else v=o,_=l-e.offset,h=e.length;h>p&&(h=p),p-=h,e.length-=h;do o[l++]=v[_++];while(--h);e.length===0&&(e.mode=X);break;case Fe:if(p===0)break e;o[l++]=e.length,p--,e.mode=X;break;case ie:if(e.wrap){for(;r<32;){if(f===0)break e;f--,s|=a[n++]<<r,r+=8}if(d-=p,i.total_out+=d,e.total+=d,e.wrap&4&&d&&(i.adler=e.check=e.flags?N(e.check,o,d,l-d):le(e.check,o,d,l-d)),d=p,e.wrap&4&&(e.flags?s:Be(s))!==e.check){i.msg="incorrect data check",e.mode=U;break}s=0,r=0}e.mode=Le;case Le:if(e.wrap&&e.flags){for(;r<32;){if(f===0)break e;f--,s+=a[n++]<<r,r+=8}if(e.wrap&4&&s!==(e.total&4294967295)){i.msg="incorrect length check",e.mode=U;break}s=0,r=0}e.mode=He;case He:O=ii;break e;case U:O=at;break e;case rt:return st;case ot:default:return C}return i.next_out=l,i.avail_out=p,i.next_in=n,i.avail_in=f,e.hold=s,e.bits=r,(e.wsize||d!==i.avail_out&&e.mode<U&&(e.mode<ie||t!==xe))&&dt(i,i.output,i.next_out,d-i.avail_out),w-=i.avail_in,d-=i.avail_out,i.total_in+=w,i.total_out+=d,e.total+=d,e.wrap&4&&d&&(i.adler=e.check=e.flags?N(e.check,o,d,i.next_out-d):le(e.check,o,d,i.next_out-d)),i.data_type=e.bits+(e.last?64:0)+(e.mode===D?128:0)+(e.mode===W||e.mode===te?256:0),(w===0&&d===0||t===xe)&&O===M&&(O=ai),O},ui=i=>{if($(i))return C;let t=i.state;return t.window&&(t.window=null),i.state=null,M},_i=(i,t)=>{if($(i))return C;const e=i.state;return(e.wrap&2)===0?C:(e.head=t,t.done=!1,M)},wi=(i,t)=>{const e=t.length;let a,o,n;return $(i)||(a=i.state,a.wrap!==0&&a.mode!==q)?C:a.mode===q&&(o=1,o=le(o,t,e,0),o!==a.check)?at:(n=dt(i,t,e,e),n?(a.mode=rt,st):(a.havedict=1,M))};var pi=ht,gi=lt,xi=ft,bi=li,ki=ct,Ei=di,yi=ui,mi=_i,Ai=wi,Oi="pako inflate (from Nodeca project)",S={inflateReset:pi,inflateReset2:gi,inflateResetKeep:xi,inflateInit:bi,inflateInit2:ki,inflate:Ei,inflateEnd:yi,inflateGetHeader:mi,inflateSetDictionary:Ai,inflateInfo:Oi};function Ui(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var vi=Ui;const ut=Object.prototype.toString,{Z_NO_FLUSH:Ri,Z_FINISH:Ti,Z_OK:B,Z_STREAM_END:se,Z_NEED_DICT:re,Z_STREAM_ERROR:Ci,Z_DATA_ERROR:Ke,Z_MEM_ERROR:Ni}=Qe;function P(i){this.options=et.assign({chunkSize:1024*64,windowBits:15,to:""},i||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(i&&i.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Yt,this.strm.avail_out=0;let e=S.inflateInit2(this.strm,t.windowBits);if(e!==B)throw new Error(ce[e]);if(this.header=new vi,S.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=de.string2buf(t.dictionary):ut.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(e=S.inflateSetDictionary(this.strm,t.dictionary),e!==B)))throw new Error(ce[e])}P.prototype.push=function(i,t){const e=this.strm,a=this.options.chunkSize,o=this.options.dictionary;let n,l,f;if(this.ended)return!1;for(t===~~t?l=t:l=t===!0?Ti:Ri,ut.call(i)==="[object ArrayBuffer]"?e.input=new Uint8Array(i):e.input=i,e.next_in=0,e.avail_in=e.input.length;;){for(e.avail_out===0&&(e.output=new Uint8Array(a),e.next_out=0,e.avail_out=a),n=S.inflate(e,l),n===re&&o&&(n=S.inflateSetDictionary(e,o),n===B?n=S.inflate(e,l):n===Ke&&(n=re));e.avail_in>0&&n===se&&e.state.wrap>0&&i[e.next_in]!==0;)S.inflateReset(e),n=S.inflate(e,l);switch(n){case Ci:case Ke:case re:case Ni:return this.onEnd(n),this.ended=!0,!1}if(f=e.avail_out,e.next_out&&(e.avail_out===0||n===se))if(this.options.to==="string"){let p=de.utf8border(e.output,e.next_out),s=e.next_out-p,r=de.buf2string(e.output,p);e.next_out=s,e.avail_out=a-s,s&&e.output.set(e.output.subarray(p,p+s),0),this.onData(r)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(!(n===B&&f===0)){if(n===se)return n=S.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,!0;if(e.avail_in===0)break}}return!0};P.prototype.onData=function(i){this.chunks.push(i)};P.prototype.onEnd=function(i){i===B&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=et.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};function Di(i,t){const e=new P(t);if(e.push(i),e.err)throw e.msg||ce[e.err];return e.result}var Si=P,Ii=Di,Mi={Inflate:Si,inflate:Ii};const{Inflate:$i,inflate:Zi}=Mi;var ze=$i,Fi=Zi;const _t=[];for(let i=0;i<256;i++){let t=i;for(let e=0;e<8;e++)t&1?t=3988292384^t>>>1:t=t>>>1;_t[i]=t}const Ge=4294967295;function Li(i,t,e){let a=i;for(let o=0;o<e;o++)a=_t[(a^t[o])&255]^a>>>8;return a}function Hi(i,t){return(Li(Ge,i,t)^Ge)>>>0}function Ye(i,t,e){const a=i.readUint32(),o=Hi(new Uint8Array(i.buffer,i.byteOffset+i.offset-t-4,t),t);if(o!==a)throw new Error(`CRC mismatch for chunk ${e}. Expected ${a}, found ${o}`)}function wt(i,t,e){for(let a=0;a<e;a++)t[a]=i[a]}function pt(i,t,e,a){let o=0;for(;o<a;o++)t[o]=i[o];for(;o<e;o++)t[o]=i[o]+t[o-a]&255}function gt(i,t,e,a){let o=0;if(e.length===0)for(;o<a;o++)t[o]=i[o];else for(;o<a;o++)t[o]=i[o]+e[o]&255}function xt(i,t,e,a,o){let n=0;if(e.length===0){for(;n<o;n++)t[n]=i[n];for(;n<a;n++)t[n]=i[n]+(t[n-o]>>1)&255}else{for(;n<o;n++)t[n]=i[n]+(e[n]>>1)&255;for(;n<a;n++)t[n]=i[n]+(t[n-o]+e[n]>>1)&255}}function bt(i,t,e,a,o){let n=0;if(e.length===0){for(;n<o;n++)t[n]=i[n];for(;n<a;n++)t[n]=i[n]+t[n-o]&255}else{for(;n<o;n++)t[n]=i[n]+e[n]&255;for(;n<a;n++)t[n]=i[n]+Bi(t[n-o],e[n],e[n-o])&255}}function Bi(i,t,e){const a=i+t-e,o=Math.abs(a-i),n=Math.abs(a-t),l=Math.abs(a-e);return o<=n&&o<=l?i:n<=l?t:e}function Pi(i,t,e,a,o,n){switch(i){case 0:wt(t,e,o);break;case 1:pt(t,e,o,n);break;case 2:gt(t,e,a,o);break;case 3:xt(t,e,a,o,n);break;case 4:bt(t,e,a,o,n);break;default:throw new Error(`Unsupported filter: ${i}`)}}const Ki=new Uint16Array([255]),zi=new Uint8Array(Ki.buffer),Gi=zi[0]===255;function Yi(i){const{data:t,width:e,height:a,channels:o,depth:n}=i,l=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],f=Math.ceil(n/8)*o,p=new Uint8Array(a*e*f);let s=0;for(let r=0;r<7;r++){const w=l[r],d=Math.ceil((e-w.x)/w.xStep),h=Math.ceil((a-w.y)/w.yStep);if(d<=0||h<=0)continue;const _=d*f,v=new Uint8Array(_);for(let k=0;k<h;k++){const x=t[s++],A=t.subarray(s,s+_);s+=_;const b=new Uint8Array(_);Pi(x,A,b,v,_,f),v.set(b);for(let c=0;c<d;c++){const y=w.x+c*w.xStep,R=w.y+k*w.yStep;if(!(y>=e||R>=a))for(let u=0;u<f;u++)p[(R*e+y)*f+u]=b[c*f+u]}}}if(n===16){const r=new Uint16Array(p.buffer);if(Gi)for(let w=0;w<r.length;w++)r[w]=Wi(r[w]);return r}else return p}function Wi(i){return(i&255)<<8|i>>8&255}const Xi=new Uint16Array([255]),Vi=new Uint8Array(Xi.buffer),ji=Vi[0]===255,qi=new Uint8Array(0);function We(i){const{data:t,width:e,height:a,channels:o,depth:n}=i,l=Math.ceil(n/8)*o,f=Math.ceil(n/8*o*e),p=new Uint8Array(a*f);let s=qi,r=0,w,d;for(let h=0;h<a;h++){switch(w=t.subarray(r+1,r+1+f),d=p.subarray(h*f,(h+1)*f),t[r]){case 0:wt(w,d,f);break;case 1:pt(w,d,f,l);break;case 2:gt(w,d,s,f);break;case 3:xt(w,d,s,f,l);break;case 4:bt(w,d,s,f,l);break;default:throw new Error(`Unsupported filter: ${t[r]}`)}s=d,r+=f+1}if(n===16){const h=new Uint16Array(p.buffer);if(ji)for(let _=0;_<h.length;_++)h[_]=Ji(h[_]);return h}else return p}function Ji(i){return(i&255)<<8|i>>8&255}const j=Uint8Array.of(137,80,78,71,13,10,26,10);function Xe(i){if(!Qi(i.readBytes(j.length)))throw new Error("wrong PNG signature")}function Qi(i){if(i.length<j.length)return!1;for(let t=0;t<j.length;t++)if(i[t]!==j[t])return!1;return!0}const en="tEXt",tn=0,kt=new TextDecoder("latin1");function nn(i){if(sn(i),i.length===0||i.length>79)throw new Error("keyword length must be between 1 and 79")}const an=/^[\u0000-\u00FF]*$/;function sn(i){if(!an.test(i))throw new Error("invalid latin1 text")}function rn(i,t,e){const a=Et(t);i[a]=on(t,e-a.length-1)}function Et(i){for(i.mark();i.readByte()!==tn;);const t=i.offset;i.reset();const e=kt.decode(i.readBytes(t-i.offset-1));return i.skip(1),nn(e),e}function on(i,t){return kt.decode(i.readBytes(t))}const T={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},oe={UNKNOWN:-1,DEFLATE:0},Ve={UNKNOWN:-1,ADAPTIVE:0},fe={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},V={NONE:0,BACKGROUND:1,PREVIOUS:2},he={SOURCE:0,OVER:1};class fn extends yt{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(t,e={}){super(t);const{checkCrc:a=!1}=e;this._checkCrc=a,this._inflator=new ze,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=oe.UNKNOWN,this._filterMethod=Ve.UNKNOWN,this._interlaceMethod=fe.UNKNOWN,this._colorType=T.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Xe(this);!this._end;){const t=this.readUint32(),e=this.readChars(4);this.decodeChunk(t,e)}return this.decodeImage(),this._png}decodeApng(){for(Xe(this);!this._end;){const t=this.readUint32(),e=this.readChars(4);this.decodeApngChunk(t,e)}return this.decodeApngImage(),this._apng}decodeChunk(t,e){const a=this.offset;switch(e){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case en:rn(this._png.text,this,t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t);break}if(this.offset-a!==t)throw new Error(`Length mismatch while decoding chunk ${e}`);this._checkCrc?Ye(this,t+4,e):this.skip(4)}decodeApngChunk(t,e){const a=this.offset;switch(e!=="fdAT"&&e!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),e){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(t);break;default:this.decodeChunk(t,e),this.offset=a+t;break}if(this.offset-a!==t)throw new Error(`Length mismatch while decoding chunk ${e}`);this._checkCrc?Ye(this,t+4,e):this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=hn(this.readUint8());const e=this.readUint8();this._colorType=e;let a;switch(e){case T.GREYSCALE:a=1;break;case T.TRUECOLOUR:a=3;break;case T.INDEXED_COLOUR:a=1;break;case T.GREYSCALE_ALPHA:a=2;break;case T.TRUECOLOUR_ALPHA:a=4;break;case T.UNKNOWN:default:throw new Error(`Unknown color type: ${e}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==oe.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const t={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(t)}decodePLTE(t){if(t%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const e=t/3;this._hasPalette=!0;const a=[];this._palette=a;for(let o=0;o<e;o++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._writingDataChunks=!0;const e=t,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,e)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodeFDAT(t){this._writingDataChunks=!0;let e=t,a=this.offset+this.byteOffset;if(a+=4,e-=4,this._inflator.push(new Uint8Array(this.buffer,a,e)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodetRNS(t){switch(this._colorType){case T.GREYSCALE:case T.TRUECOLOUR:{if(t%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let e=0;e<t/2;e++)this._transparency[e]=this.readUint16();break}case T.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let e=0;for(;e<t;e++){const a=this.readByte();this._palette[e].push(a)}for(;e<this._palette.length;e++)this._palette[e].push(255);break}case T.UNKNOWN:case T.GREYSCALE_ALPHA:case T.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){const e=Et(this),a=this.readUint8();if(a!==oe.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const o=this.readBytes(t-e.length-2);this._png.iccEmbeddedProfile={name:e,profile:Fi(o)}}decodepHYs(){const t=this.readUint32(),e=this.readUint32(),a=this.readByte();this._png.resolution={x:t,y:e,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let t=0;t<this._numberOfFrames;t++){const e={sequenceNumber:this._frames[t].sequenceNumber,delayNumber:this._frames[t].delayNumber,delayDenominator:this._frames[t].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(t);if(a){if(a.data=We({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),t===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)e.data=a.data;else{const o=this._apng.frames.at(t-1);this.disposeFrame(a,o,e),this.addFrameDataToCanvas(e,a)}this._apng.frames.push(e)}}return this._apng}disposeFrame(t,e,a){switch(t.disposeOp){case V.NONE:break;case V.BACKGROUND:for(let o=0;o<this._png.height;o++)for(let n=0;n<this._png.width;n++){const l=(o*t.width+n)*this._png.channels;for(let f=0;f<this._png.channels;f++)a.data[l+f]=0}break;case V.PREVIOUS:a.data.set(e.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(t,e){const a=1<<this._png.depth,o=(n,l)=>{const f=((n+e.yOffset)*this._png.width+e.xOffset+l)*this._png.channels,p=(n*e.width+l)*this._png.channels;return{index:f,frameIndex:p}};switch(e.blendOp){case he.SOURCE:for(let n=0;n<e.height;n++)for(let l=0;l<e.width;l++){const{index:f,frameIndex:p}=o(n,l);for(let s=0;s<this._png.channels;s++)t.data[f+s]=e.data[p+s]}break;case he.OVER:for(let n=0;n<e.height;n++)for(let l=0;l<e.width;l++){const{index:f,frameIndex:p}=o(n,l);for(let s=0;s<this._png.channels;s++){const r=e.data[p+this._png.channels-1]/a,w=s%(this._png.channels-1)===0?1:e.data[p+s],d=Math.floor(r*w+(1-r)*t.data[f+s]);t.data[f+s]+=d}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==Ve.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===fe.NO_INTERLACE)this._png.data=We({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===fe.ADAM7)this._png.data=Yi({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const t=this._inflator.result,e=this._frames.at(-1);e?e.data=t:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:V.NONE,blendOp:he.SOURCE,data:t}),this._inflator=new ze,this._writingDataChunks=!1}}function hn(i){if(i!==1&&i!==2&&i!==4&&i!==8&&i!==16)throw new Error(`invalid bit depth: ${i}`);return i}var je;(function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.METRE=1]="METRE"})(je||(je={}));function cn(i,t){return new fn(i,t).decode()}export{cn as d};
